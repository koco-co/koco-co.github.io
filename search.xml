<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>FastAPI文档(二) 进阶</title>
      <link href="/posts/7a1d94f5/"/>
      <url>/posts/7a1d94f5/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>FastAPI 进阶教程将带你深入理解中间件、依赖注入和 ORM 数据库操作等核心特性. 这些高级特性能够帮助你构建更加健壮、可维护的企业级应用.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/">FastAPI Advanced User Guide</a></p><h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><h3 id="什么是中间件"><a href="#什么是中间件" class="headerlink" title="什么是中间件"></a>什么是中间件</h3><p>中间件 (Middleware) 是一个在每次请求进入 FastAPI 应用时都会被执行的函数. 它在请求到达实际的路径操作 (路由处理函数) 之前运行, 并且在响应返回给客户端之前再运行一次.</p><div class="note info flat"><p>中间件执行流程:</p><ol><li>请求进入应用</li><li>中间件 A 处理请求</li><li>中间件 B 处理请求</li><li>路由处理函数执行</li><li>返回响应经过中间件 B</li><li>返回响应经过中间件 A</li><li>响应返回给客户端</li></ol></div><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart LR    A[客户端] --&gt; B[中间件 A]    B --&gt; C[中间件 B]    C --&gt; D[路由处理函数]    D --&gt; C    C --&gt; B    B --&gt; A  </pre></div><h3 id="中间件应用场景"><a href="#中间件应用场景" class="headerlink" title="中间件应用场景"></a>中间件应用场景</h3><ul><li><strong>性能监控</strong>: 记录每个请求的处理时间</li><li><strong>日志记录</strong>: 统一记录请求和响应信息</li><li><strong>身份认证</strong>: 验证用户身份和权限</li><li><strong>响应头处理</strong>: 添加 CORS、安全头等</li><li><strong>跨域处理</strong>: 配置跨域资源共享</li></ul><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/middleware/">FastAPI Middleware</a></p><h3 id="定义中间件"><a href="#定义中间件" class="headerlink" title="定义中间件"></a>定义中间件</h3><p>使用装饰器 <code>@app.middleware(&quot;http&quot;)</code> 定义中间件:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.middleware(<span class="params"><span class="string">&quot;http&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">middleware1</span>(<span class="params">request, call_next</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;中间件1 start&quot;</span>)</span><br><span class="line">    <span class="comment"># 传递请求给路径处理函数</span></span><br><span class="line">    response = <span class="keyword">await</span> call_next(request)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;中间件1 end&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.middleware(<span class="params"><span class="string">&quot;http&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">middleware2</span>(<span class="params">request, call_next</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;中间件2 start&quot;</span>)</span><br><span class="line">    response = <span class="keyword">await</span> call_next(request)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;中间件2 end&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hello World&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 以上代码定义了两个中间件, 当访问 <code>/</code> 路径时, 输出顺序为:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">中间件2 start</span><br><span class="line">中间件1 start</span><br><span class="line">中间件1 end</span><br><span class="line">中间件2 end</span><br></pre></td></tr></table></figure></p><div class="note warning flat"><p><strong>P.S.</strong> 中间件执行顺序: 自下而上. 后定义的中间件先执行.</p></div><p>Ref. <a href="https://fastapi.tiangolo.com/advanced/middleware/">Advanced Middleware</a></p><h3 id="实战示例-性能监控中间件"><a href="#实战示例-性能监控中间件" class="headerlink" title="实战示例: 性能监控中间件"></a>实战示例: 性能监控中间件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.middleware(<span class="params"><span class="string">&quot;http&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">process_time_middleware</span>(<span class="params">request: Request, call_next</span>):</span><br><span class="line">    start_time = time.time()</span><br><span class="line">    response = <span class="keyword">await</span> call_next(request)</span><br><span class="line">    process_time = time.time() - start_time</span><br><span class="line">    <span class="comment"># 自定义响应头</span></span><br><span class="line">    response.headers[<span class="string">&quot;X-Process-Time&quot;</span>] = <span class="built_in">str</span>(process_time)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hello World&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 这个中间件会在每个响应头中添加 <code>X-Process-Time</code> 字段, 显示请求处理时间.</p><h2 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h2><h3 id="什么是依赖注入"><a href="#什么是依赖注入" class="headerlink" title="什么是依赖注入"></a>什么是依赖注入</h3><p>依赖注入系统是 FastAPI 的核心特性之一, 它提供了一种优雅的方式来共享通用逻辑, 减少代码重复.</p><p><strong>核心概念</strong>:</p><ul><li><strong>依赖项</strong>: 可重用的组件 (函数/类), 负责提供某种功能或数据</li><li><strong>注入</strong>: FastAPI 自动帮你调用依赖项, 并将结果”注入”到路径操作函数中</li></ul><p><strong>优点</strong>:</p><ul><li><strong>代码复用</strong>: 一次编写, 多处使用</li><li><strong>解耦</strong>: 业务逻辑与基础设施代码分离</li><li><strong>易于测试</strong>: 轻松地用模拟依赖替换真实依赖进行测试</li></ul><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/dependencies/">FastAPI Dependencies</a></p><h3 id="依赖注入应用场景"><a href="#依赖注入应用场景" class="headerlink" title="依赖注入应用场景"></a>依赖注入应用场景</h3><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart LR    A[多个路由] --&gt; B[依赖注入系统]    B --&gt; C[依赖项]    C --&gt; D[复用逻辑]    D --&gt; E[数据库会话]    D --&gt; F[认证验证]    D --&gt; G[参数提取]  </pre></div><ol><li><strong>处理请求参数</strong>: 从请求中提取和验证参数</li><li><strong>共享数据库连接</strong>: 管理数据库会话的创建、使用、关闭</li><li><strong>共享业务逻辑</strong>: 抽取封装多个路由公用的逻辑代码</li><li><strong>安全和认证</strong>: 验证用户身份、检查权限和角色要求等</li></ol><h3 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h3><p><strong>步骤一: 创建依赖项</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Query</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分页参数逻辑共用: 新闻列表和用户列表</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">common_parameters</span>(<span class="params"></span></span><br><span class="line"><span class="params">    skip: <span class="built_in">int</span> = Query(<span class="params"><span class="number">0</span>, ge=<span class="number">0</span>, description=<span class="string">&quot;跳过的记录数&quot;</span></span>),</span></span><br><span class="line"><span class="params">    limit: <span class="built_in">int</span> = Query(<span class="params"><span class="number">10</span>, le=<span class="number">60</span>, description=<span class="string">&quot;返回的记录数&quot;</span></span>)</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;skip&quot;</span>: skip, <span class="string">&quot;limit&quot;</span>: limit&#125;</span><br></pre></td></tr></table></figure><p><strong>步骤二: 导入 Depends 并声明依赖项</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> Depends</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 声明依赖项 → 依赖注入</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/news/news_list&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_news_list</span>(<span class="params">commons = Depends(<span class="params">common_parameters</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> commons</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/user/user_list&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_user_list</span>(<span class="params">commons = Depends(<span class="params">common_parameters</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> commons</span><br></pre></td></tr></table></figure><p>e.g. 以上代码中, <code>common_parameters</code> 依赖项被多个路由共享, 避免了代码重复.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/dependencies/">Dependencies - First Steps</a></p><h3 id="依赖项作为类"><a href="#依赖项作为类" class="headerlink" title="依赖项作为类"></a>依赖项作为类</h3><p>依赖项也可以是一个类, FastAPI 会自动实例化该类:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Depends</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Annotated</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CommonParams</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self,</span></span><br><span class="line"><span class="params">        skip: <span class="built_in">int</span> = <span class="number">0</span>,</span></span><br><span class="line"><span class="params">        limit: <span class="built_in">int</span> = <span class="number">100</span></span></span><br><span class="line"><span class="params">    </span>):</span><br><span class="line">        <span class="variable language_">self</span>.skip = skip</span><br><span class="line">        <span class="variable language_">self</span>.limit = limit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_items</span>(<span class="params">commons: Annotated[CommonParams, Depends(<span class="params">CommonParams</span>)]</span>):</span><br><span class="line">    response = &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> commons.skip:</span><br><span class="line">        response.update(&#123;<span class="string">&quot;skip&quot;</span>: commons.skip&#125;)</span><br><span class="line">    <span class="keyword">if</span> commons.limit:</span><br><span class="line">        response.update(&#123;<span class="string">&quot;limit&quot;</span>: commons.limit&#125;)</span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/dependencies/classes-as-dependencies/">Dependencies as Classes</a></p><h3 id="嵌套依赖"><a href="#嵌套依赖" class="headerlink" title="嵌套依赖"></a>嵌套依赖</h3><p>FastAPI 支持依赖项的嵌套, 一个依赖项可以依赖于其他依赖项:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Depends</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query_extractor</span>(<span class="params">q: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query_or_cookie_extractor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    q: Annotated[<span class="built_in">str</span>, Depends(<span class="params">query_extractor</span>)],</span></span><br><span class="line"><span class="params">    last_query: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span></span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> q:</span><br><span class="line">        <span class="keyword">return</span> last_query</span><br><span class="line">    <span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_query</span>(<span class="params"></span></span><br><span class="line"><span class="params">    query_ref: Annotated[<span class="built_in">str</span>, Depends(<span class="params">query_or_cookie_extractor</span>)]</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;query_ref&quot;</span>: query_ref&#125;</span><br></pre></td></tr></table></figure><p>e.g. <code>query_or_cookie_extractor</code> 依赖于 <code>query_extractor</code>, FastAPI 会自动解析依赖关系.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/dependencies/sub-dependencies/">Sub-dependencies</a></p><h2 id="ORM-数据库操作"><a href="#ORM-数据库操作" class="headerlink" title="ORM 数据库操作"></a>ORM 数据库操作</h2><h3 id="ORM-简介"><a href="#ORM-简介" class="headerlink" title="ORM 简介"></a>ORM 简介</h3><p>ORM (Object-Relational Mapping, 对象关系映射) 是一种编程技术, 用于在面向对象编程语言和关系型数据库之间建立映射. 它允许开发者通过操作对象的方式与数据库进行交互, 而无需直接编写复杂的 SQL 语句.</p><p><strong>优势</strong>:</p><ul><li>减少重复的 SQL 代码</li><li>代码更简洁易读</li><li>自动处理数据库连接和事务</li><li>自动防止 SQL 注入攻击</li></ul><h3 id="Python-ORM-工具对比"><a href="#Python-ORM-工具对比" class="headerlink" title="Python ORM 工具对比"></a>Python ORM 工具对比</h3><div class="table-container"><table><thead><tr><th>排名</th><th>ORM 工具</th><th>特点</th><th>适用场景</th></tr></thead><tbody><tr><td>1</td><td>SQLAlchemy ORM</td><td>功能最强、最灵活、企业级</td><td>各类 API、微服务、数据应用</td></tr><tr><td>2</td><td>Django ORM</td><td>封装好、上手快</td><td>Django 项目、管理后台</td></tr><tr><td>3</td><td>Tortoise ORM</td><td>全异步</td><td>异步 Web 服务、高并发 API</td></tr></tbody></table></div><p>本文主要介绍 <strong>SQLAlchemy ORM</strong>, 它是 Python 中最流行的 ORM 工具.</p><p>Ref. <a href="https://docs.sqlalchemy.org/">SQLAlchemy Documentation</a></p><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 SQLAlchemy (支持异步)</span></span><br><span class="line">pip install <span class="string">&quot;sqlalchemy[asyncio]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 MySQL 异步驱动</span></span><br><span class="line">pip install aiomysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或安装 PostgreSQL 异步驱动</span></span><br><span class="line">pip install asyncpg</span><br></pre></td></tr></table></figure><h3 id="ORM-使用流程"><a href="#ORM-使用流程" class="headerlink" title="ORM 使用流程"></a>ORM 使用流程</h3><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart LR    A[1. 安装依赖] --&gt; B[2. 建库建表]    B --&gt; C[3. 操作数据]    C --&gt; D[查询 select]    C --&gt; E[新增 add]    C --&gt; F[更新 update]    C --&gt; G[删除 delete]  </pre></div><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/extensions/asyncio.html">SQLAlchemy Async</a></p><h3 id="创建数据库引擎"><a href="#创建数据库引擎" class="headerlink" title="创建数据库引擎"></a>创建数据库引擎</h3><p>使用 <code>create_async_engine</code> 创建异步引擎:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy.ext.asyncio <span class="keyword">import</span> create_async_engine</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建异步引擎</span></span><br><span class="line">ASYNC_DATABASE_URL = <span class="string">&quot;mysql+aiomysql://root:123456@localhost:3306/fastapi_test?charset=utf8&quot;</span></span><br><span class="line"></span><br><span class="line">async_engine = create_async_engine(</span><br><span class="line">    ASYNC_DATABASE_URL,</span><br><span class="line">    echo=<span class="literal">True</span>,       <span class="comment"># 可选: 输出 SQL 日志</span></span><br><span class="line">    pool_size=<span class="number">10</span>,    <span class="comment"># 设置连接池中保持的持久连接数</span></span><br><span class="line">    max_overflow=<span class="number">20</span>  <span class="comment"># 设置连接池允许创建的额外连接数</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>参数说明</strong>:</p><ul><li><code>echo=True</code>: 输出所有执行的 SQL 语句, 开发调试时很有用</li><li><code>pool_size</code>: 连接池活跃的连接数</li><li><code>max_overflow</code>: 允许额外的连接数 (超出 pool_size)</li></ul><div class="note success flat"><p><strong>异步驱动连接字符串格式</strong>:</p><ul><li>MySQL: <code>mysql+aiomysql://用户名:密码@主机:端口/数据库</code></li><li>PostgreSQL: <code>postgresql+asyncpg://用户名:密码@主机:端口/数据库</code></li></ul></div><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/core/engines.html">Engine Configuration</a></p><h3 id="定义模型类"><a href="#定义模型类" class="headerlink" title="定义模型类"></a>定义模型类</h3><p><strong>步骤一: 定义基类</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> DateTime, func</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> DeclarativeBase, Mapped, mapped_column</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 基类: 包含通用属性和字段的映射</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span>(<span class="title class_ inherited__">DeclarativeBase</span>):</span><br><span class="line">    create_time: Mapped[datetime] = mapped_column(</span><br><span class="line">        DateTime,</span><br><span class="line">        insert_default=func.now(),</span><br><span class="line">        default=func.now,</span><br><span class="line">        comment=<span class="string">&quot;创建时间&quot;</span></span><br><span class="line">    )</span><br><span class="line">    update_time: Mapped[datetime] = mapped_column(</span><br><span class="line">        DateTime,</span><br><span class="line">        insert_default=func.now(),</span><br><span class="line">        default=func.now,</span><br><span class="line">        onupdate=func.now(),</span><br><span class="line">        comment=<span class="string">&quot;修改时间&quot;</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p><strong>步骤二: 定义表模型类</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> String, Float</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    __tablename__ = <span class="string">&quot;book&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">id</span>: Mapped[<span class="built_in">int</span>] = mapped_column(primary_key=<span class="literal">True</span>, comment=<span class="string">&quot;书籍id&quot;</span>)</span><br><span class="line">    bookname: Mapped[<span class="built_in">str</span>] = mapped_column(String(<span class="number">255</span>), comment=<span class="string">&quot;书名&quot;</span>)</span><br><span class="line">    author: Mapped[<span class="built_in">str</span>] = mapped_column(String(<span class="number">255</span>), comment=<span class="string">&quot;作者&quot;</span>)</span><br><span class="line">    price: Mapped[<span class="built_in">float</span>] = mapped_column(Float, comment=<span class="string">&quot;价格&quot;</span>)</span><br><span class="line">    publisher: Mapped[<span class="built_in">str</span>] = mapped_column(String(<span class="number">255</span>), comment=<span class="string">&quot;出版社&quot;</span>)</span><br></pre></td></tr></table></figure><p>e.g. 以上代码定义了一个 <code>Book</code> 模型类, 对应数据库中的 <code>book</code> 表.</p><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/mapping_api.html">SQLAlchemy ORM Models</a></p><h3 id="创建数据库表"><a href="#创建数据库表" class="headerlink" title="创建数据库表"></a>创建数据库表</h3><p>定义函数建表, 在 FastAPI 启动时调用:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 建表: 定义函数建表 → FastAPI 启动的时候调用建表的函数</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">create_tables</span>():</span><br><span class="line">    <span class="comment"># 获取异步引擎, 创建事务 - 建表</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> async_engine.begin() <span class="keyword">as</span> conn:</span><br><span class="line">        <span class="keyword">await</span> conn.run_sync(Base.metadata.create_all)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.on_event(<span class="params"><span class="string">&quot;startup&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">startup_event</span>():</span><br><span class="line">    <span class="keyword">await</span> create_tables()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hello World&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 当 FastAPI 应用启动时, 会自动创建所有定义的表.</p><div class="note warning flat"><p><strong>P.S.</strong> <code>@app.on_event(&quot;startup&quot;)</code> 在最新版本中已不推荐使用, 推荐使用 <code>lifespan</code> 事件处理器.</p></div><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/core/metadata.html">SQLAlchemy Metadata</a></p><h3 id="在路由中使用-ORM"><a href="#在路由中使用-ORM" class="headerlink" title="在路由中使用 ORM"></a>在路由中使用 ORM</h3><p><strong>核心思路</strong>: 创建依赖项, 使用 <code>Depends</code> 注入数据库会话到处理函数.</p><p><strong>步骤一: 创建数据库会话依赖项</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy.ext.asyncio <span class="keyword">import</span> async_sessionmaker, AsyncSession</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建异步会话工厂</span></span><br><span class="line">AsyncSessionLocal = async_sessionmaker(</span><br><span class="line">    bind=async_engine,       <span class="comment"># 绑定数据库引擎</span></span><br><span class="line">    class_=AsyncSession,     <span class="comment"># 指定会话类</span></span><br><span class="line">    expire_on_commit=<span class="literal">False</span>   <span class="comment"># 提交后会话不过期, 不会重新查询数据库</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 依赖项, 用于获取数据库会话</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_database</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> AsyncSessionLocal() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">yield</span> session  <span class="comment"># 返回数据库会话给路由处理函数</span></span><br><span class="line">            <span class="keyword">await</span> session.commit()  <span class="comment"># 无异常, 提交事务</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">await</span> session.rollback()  <span class="comment"># 有异常则回滚</span></span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            <span class="keyword">await</span> session.close()  <span class="comment"># 关闭会话</span></span><br></pre></td></tr></table></figure><p><strong>步骤二: 在路由中注入依赖</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> Depends</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/books&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book_list</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    <span class="comment"># 查询所有书籍</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(Book))</span><br><span class="line">    books = result.scalars().<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> books</span><br></pre></td></tr></table></figure><p>e.g. 使用 <code>Depends(get_database)</code> 注入数据库会话, 无需手动管理会话的创建和关闭.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/dependencies/dependencies-with-yield/">FastAPI Database Sessions</a></p><h2 id="数据库操作-查询"><a href="#数据库操作-查询" class="headerlink" title="数据库操作 - 查询"></a>数据库操作 - 查询</h2><h3 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h3><p><strong>查询所有数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/get_books&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book_list</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(Book))</span><br><span class="line">    books = result.scalars().<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> books</span><br></pre></td></tr></table></figure><p><strong>查询单条数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/get_book&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    <span class="comment"># 方式一: 使用 first()</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(Book))</span><br><span class="line">    book = result.scalars().first()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 方式二: 使用 get() (根据主键查询)</span></span><br><span class="line">    book = <span class="keyword">await</span> db.get(Book, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> book</span><br></pre></td></tr></table></figure><h3 id="从-ORM-对象获取数据的方式"><a href="#从-ORM-对象获取数据的方式" class="headerlink" title="从 ORM 对象获取数据的方式"></a>从 ORM 对象获取数据的方式</h3><div class="table-container"><table><thead><tr><th>方法</th><th>说明</th><th>返回值</th></tr></thead><tbody><tr><td><code>scalars().all()</code></td><td>获取所有数据</td><td>列表</td></tr><tr><td><code>scalars().first()</code></td><td>提取第一个数据</td><td>单个对象或 None</td></tr><tr><td><code>scalar_one_or_none()</code></td><td>提取一个或 None</td><td>单个对象或 None</td></tr><tr><td><code>scalar()</code></td><td>提取标量值 (配合聚合查询)</td><td>单个值</td></tr><tr><td><code>get(模型类, 主键值)</code></td><td>根据主键查询</td><td>单个对象或 None</td></tr></tbody></table></div><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/queryguide.html">SQLAlchemy Queries</a></p><h3 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h3><p>使用 <code>where()</code> 子句添加查询条件:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/&#123;book_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book</span>(<span class="params">book_id: <span class="built_in">int</span>, db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    result = <span class="keyword">await</span> db.execute(</span><br><span class="line">        select(Book).where(Book.<span class="built_in">id</span> == book_id)</span><br><span class="line">    )</span><br><span class="line">    book = result.scalar_one_or_none()</span><br><span class="line">    <span class="keyword">return</span> book</span><br></pre></td></tr></table></figure><p>e.g. 查询 ID 等于 <code>book_id</code> 的书籍.</p><h4 id="比较判断"><a href="#比较判断" class="headerlink" title="比较判断"></a>比较判断</h4><p>支持 <code>==</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> 等比较运算符:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询价格大于 100 的书籍</span></span><br><span class="line">result = <span class="keyword">await</span> db.execute(</span><br><span class="line">    select(Book).where(Book.price &gt; <span class="number">100</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h4><p>使用 <code>like()</code> 进行模糊查询:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/get_books&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book_list</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    <span class="comment"># %: 零个、一个或多个字符</span></span><br><span class="line">    <span class="comment"># _: 一个单个字符</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(</span><br><span class="line">        select(Book).where(Book.author.like(<span class="string">&quot;曹%&quot;</span>))</span><br><span class="line">    )</span><br><span class="line">    books = result.scalars().<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> books</span><br></pre></td></tr></table></figure><p>e.g. 查询作者姓”曹”的书籍.</p><h4 id="与非查询"><a href="#与非查询" class="headerlink" title="与非查询"></a>与非查询</h4><p>使用 <code>&amp;</code> (与)、<code>|</code> (或)、<code>~</code> (非) 进行逻辑运算:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/get_books&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book_list</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    result = <span class="keyword">await</span> db.execute(</span><br><span class="line">        select(Book).where(</span><br><span class="line">            (Book.author == <span class="string">&quot;曹雪芹&quot;</span>) &amp; (Book.price == <span class="number">200</span>)</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    books = result.scalars().<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> books</span><br></pre></td></tr></table></figure><p>e.g. 查询作者为”曹雪芹” 且价格为 200 的书籍.</p><h4 id="包含查询"><a href="#包含查询" class="headerlink" title="包含查询"></a>包含查询</h4><p>使用 <code>in_()</code> 进行包含查询:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/get_books&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book_list</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    id_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    result = <span class="keyword">await</span> db.execute(</span><br><span class="line">        select(Book).where(Book.<span class="built_in">id</span>.in_(id_list))</span><br><span class="line">    )</span><br><span class="line">    books = result.scalars().<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> books</span><br></pre></td></tr></table></figure><p>e.g. 查询 ID 在列表中的书籍.</p><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/queryguide/query.html#where-clause">SQLAlchemy WHERE Clause</a></p><h3 id="聚合查询"><a href="#聚合查询" class="headerlink" title="聚合查询"></a>聚合查询</h3><p>使用 <code>func</code> 进行聚合计算:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> func</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/count&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_count</span>(<span class="params">db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    <span class="comment"># 统计行数量</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(func.count(Book.<span class="built_in">id</span>)))</span><br><span class="line">    count = result.scalar()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求平均值</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(func.avg(Book.price)))</span><br><span class="line">    avg_price = result.scalar()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求最大值</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(func.<span class="built_in">max</span>(Book.price)))</span><br><span class="line">    max_price = result.scalar()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求最小值</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(func.<span class="built_in">min</span>(Book.price)))</span><br><span class="line">    min_price = result.scalar()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求和</span></span><br><span class="line">    result = <span class="keyword">await</span> db.execute(select(func.<span class="built_in">sum</span>(Book.price)))</span><br><span class="line">    total_price = result.scalar()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;count&quot;</span>: count,</span><br><span class="line">        <span class="string">&quot;avg_price&quot;</span>: avg_price,</span><br><span class="line">        <span class="string">&quot;max_price&quot;</span>: max_price,</span><br><span class="line">        <span class="string">&quot;min_price&quot;</span>: min_price,</span><br><span class="line">        <span class="string">&quot;total_price&quot;</span>: total_price</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>聚合函数说明</strong>:</p><ul><li><code>count()</code>: 统计行数量</li><li><code>avg()</code>: 求平均值</li><li><code>max()</code>: 求最大值</li><li><code>min()</code>: 求最小值</li><li><code>sum()</code>: 求和</li></ul><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/core/functions.html">SQLAlchemy Functions</a></p><h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><p>使用 <code>offset()</code> 和 <code>limit()</code> 实现分页:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/get_books&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book_list</span>(<span class="params"></span></span><br><span class="line"><span class="params">    page: <span class="built_in">int</span> = Query(<span class="params"><span class="number">1</span>, ge=<span class="number">1</span>, description=<span class="string">&quot;当前页码&quot;</span></span>),</span></span><br><span class="line"><span class="params">    page_size: <span class="built_in">int</span> = Query(<span class="params"><span class="number">10</span>, ge=<span class="number">1</span>, le=<span class="number">100</span>, description=<span class="string">&quot;每页数量&quot;</span></span>),</span></span><br><span class="line"><span class="params">    db: AsyncSession = Depends(<span class="params">get_database</span>)</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="comment"># 计算跳过的记录数</span></span><br><span class="line">    skip = (page - <span class="number">1</span>) * page_size</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 执行分页查询</span></span><br><span class="line">    stmt = select(Book).offset(skip).limit(page_size)</span><br><span class="line">    result = <span class="keyword">await</span> db.execute(stmt)</span><br><span class="line">    books = result.scalars().<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;page&quot;</span>: page,</span><br><span class="line">        <span class="string">&quot;page_size&quot;</span>: page_size,</span><br><span class="line">        <span class="string">&quot;books&quot;</span>: books</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>分页计算公式</strong>:</p><div class="table-container"><table><thead><tr><th>当前页码</th><th>每页数量 (limit)</th><th>跳过数量 (offset)</th></tr></thead><tbody><tr><td>1</td><td>10</td><td>0</td></tr><tr><td>2</td><td>10</td><td>10</td></tr><tr><td>3</td><td>10</td><td>20</td></tr><tr><td>4</td><td>10</td><td>30</td></tr></tbody></table></div><p><code>offset = (当前页码 - 1) * 每页数量</code></p><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/queryguide/select.html#slice-and-limits">SQLAlchemy LIMIT/OFFSET</a></p><h2 id="数据库操作-新增"><a href="#数据库操作-新增" class="headerlink" title="数据库操作 - 新增"></a>数据库操作 - 新增</h2><p><strong>核心步骤</strong>: 定义 ORM 对象 → 添加对象到事务 (<code>add()</code>) → <code>commit()</code> 提交到数据库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookBase</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    bookname: <span class="built_in">str</span></span><br><span class="line">    author: <span class="built_in">str</span></span><br><span class="line">    price: <span class="built_in">float</span></span><br><span class="line">    publisher: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/book/add_book&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">add_book</span>(<span class="params">book: BookBase, db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    <span class="comment"># 1. 创建 ORM 对象</span></span><br><span class="line">    book_obj = Book(**book.__dict__)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 添加到会话</span></span><br><span class="line">    db.add(book_obj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 提交到数据库</span></span><br><span class="line">    <span class="keyword">await</span> db.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;书籍添加成功&quot;</span>, <span class="string">&quot;book&quot;</span>: book&#125;</span><br></pre></td></tr></table></figure><p>e.g. 接收客户端传来的 JSON 数据, 创建 ORM 对象并保存到数据库.</p><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/queryguide/dml.html#orm-insert-bulk">SQLAlchemy INSERT</a></p><h2 id="数据库操作-更新"><a href="#数据库操作-更新" class="headerlink" title="数据库操作 - 更新"></a>数据库操作 - 更新</h2><p><strong>核心步骤</strong>: 查询 (<code>get</code>) → 属性重新赋值 → <code>commit()</code> 提交到数据库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> HTTPException</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookUpdate</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    bookname: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line">    author: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line">    price: <span class="built_in">float</span> | <span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line">    publisher: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.put(<span class="params"><span class="string">&quot;/book/update_book/&#123;book_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">update_book</span>(<span class="params"></span></span><br><span class="line"><span class="params">    book_id: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    data: BookUpdate,</span></span><br><span class="line"><span class="params">    db: AsyncSession = Depends(<span class="params">get_database</span>)</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="comment"># 1. 查询</span></span><br><span class="line">    book = <span class="keyword">await</span> db.get(Book, book_id)</span><br><span class="line">    <span class="keyword">if</span> book <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">404</span>, detail=<span class="string">&quot;书籍不存在&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 修改属性 (重新赋值)</span></span><br><span class="line">    <span class="keyword">if</span> data.bookname <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        book.bookname = data.bookname</span><br><span class="line">    <span class="keyword">if</span> data.author <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        book.author = data.author</span><br><span class="line">    <span class="keyword">if</span> data.price <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        book.price = data.price</span><br><span class="line">    <span class="keyword">if</span> data.publisher <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        book.publisher = data.publisher</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 提交</span></span><br><span class="line">    <span class="keyword">await</span> db.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;书籍更新成功&quot;</span>, <span class="string">&quot;book&quot;</span>: book&#125;</span><br></pre></td></tr></table></figure><p>e.g. 根据 <code>book_id</code> 查询书籍, 更新指定字段并提交.</p><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/queryguide/dml.html#orm-update-update-statements">SQLAlchemy UPDATE</a></p><h2 id="数据库操作-删除"><a href="#数据库操作-删除" class="headerlink" title="数据库操作 - 删除"></a>数据库操作 - 删除</h2><p><strong>核心步骤</strong>: 查询 (<code>get</code>) → <code>delete()</code> 删除 → <code>commit()</code> 提交到数据库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.delete(<span class="params"><span class="string">&quot;/book/delete_book/&#123;book_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">delete_book</span>(<span class="params">book_id: <span class="built_in">int</span>, db: AsyncSession = Depends(<span class="params">get_database</span>)</span>):</span><br><span class="line">    <span class="comment"># 1. 查询</span></span><br><span class="line">    db_book = <span class="keyword">await</span> db.get(Book, book_id)</span><br><span class="line">    <span class="keyword">if</span> db_book <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">404</span>, detail=<span class="string">&quot;书籍不存在&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 删除</span></span><br><span class="line">    <span class="keyword">await</span> db.delete(db_book)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 提交</span></span><br><span class="line">    <span class="keyword">await</span> db.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;书籍删除成功&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 根据 <code>book_id</code> 查询书籍并删除.</p><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/queryguide/dml.html#orm-delete-delete-statements">SQLAlchemy DELETE</a></p><h2 id="ORM-操作总结"><a href="#ORM-操作总结" class="headerlink" title="ORM 操作总结"></a>ORM 操作总结</h2><h3 id="查询总结"><a href="#查询总结" class="headerlink" title="查询总结"></a>查询总结</h3><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart LR    A[&quot;select 查询&quot;] --&gt; B[&quot;基础查询&quot;]    A --&gt; C[&quot;条件查询 where&quot;]    A --&gt; D[&quot;聚合查询 func&quot;]    A --&gt; E[&quot;分页查询 offset&#x2F;limit&quot;]    C --&gt; C1[&quot;比较判断 &#x3D;&#x3D; &gt; &lt;&quot;]    C --&gt; C2[&quot;模糊查询 like&quot;]    C --&gt; C3[&quot;与非查询 &amp; | ~&quot;]    C --&gt; C4[&quot;包含查询 in_&quot;]    D --&gt; D1[&quot;count 统计&quot;]    D --&gt; D2[&quot;avg 平均值&quot;]    D --&gt; D3[&quot;max 最大值&quot;]    D --&gt; D4[&quot;min 最小值&quot;]    D --&gt; D5[&quot;sum 求和&quot;]  </pre></div><h3 id="CRUD-操作对照表"><a href="#CRUD-操作对照表" class="headerlink" title="CRUD 操作对照表"></a>CRUD 操作对照表</h3><div class="table-container"><table><thead><tr><th>操作</th><th>关键字</th><th>核心步骤</th></tr></thead><tbody><tr><td>查询</td><td><code>select()</code></td><td><code>execute()</code> → 获取结果</td></tr><tr><td>新增</td><td><code>add()</code></td><td>创建对象 → <code>add()</code> → <code>commit()</code></td></tr><tr><td>更新</td><td>重新赋值</td><td><code>get()</code> → 赋值 → <code>commit()</code></td></tr><tr><td>删除</td><td><code>delete()</code></td><td><code>get()</code> → <code>delete()</code> → <code>commit()</code></td></tr></tbody></table></div><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="中间件最佳实践"><a href="#中间件最佳实践" class="headerlink" title="中间件最佳实践"></a>中间件最佳实践</h3><details class="folding-tag" green><summary> ✅ 中间件使用建议 </summary>              <div class='content'>              <ol><li><strong>顺序控制</strong>: 将最常用的中间件放在前面, 减少不必要的处理</li><li><strong>性能优化</strong>: 在中间件中避免执行耗时操作, 如数据库查询</li><li><strong>错误处理</strong>: 确保中间件正确处理异常, 避免影响其他中间件</li><li><strong>日志记录</strong>: 使用结构化日志, 方便后续分析</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request</span><br><span class="line"></span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.middleware(<span class="params"><span class="string">&quot;http&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">logging_middleware</span>(<span class="params">request: Request, call_next</span>):</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记录请求信息</span></span><br><span class="line">    logger.info(<span class="string">f&quot;Request: <span class="subst">&#123;request.method&#125;</span> <span class="subst">&#123;request.url&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    response = <span class="keyword">await</span> call_next(request)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记录响应信息</span></span><br><span class="line">    process_time = time.time() - start_time</span><br><span class="line">    logger.info(</span><br><span class="line">        <span class="string">f&quot;Response: status=<span class="subst">&#123;response.status_code&#125;</span> &quot;</span></span><br><span class="line">        <span class="string">f&quot;process_time=<span class="subst">&#123;process_time:<span class="number">.3</span>f&#125;</span>s&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="依赖注入最佳实践"><a href="#依赖注入最佳实践" class="headerlink" title="依赖注入最佳实践"></a>依赖注入最佳实践</h3><details class="folding-tag" blue><summary> 🔧 依赖注入建议 </summary>              <div class='content'>              <ol><li><strong>复用逻辑</strong>: 将重复的参数提取、验证逻辑抽取为依赖项</li><li><strong>类型注解</strong>: 使用类型注解提高代码可读性和 IDE 支持</li><li><strong>yield 依赖</strong>: 对于需要清理资源的依赖项, 使用 <code>yield</code> 关键字</li><li><strong>类依赖</strong>: 复杂逻辑使用类依赖, 提高代码组织性</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> AsyncGenerator</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.asyncio <span class="keyword">import</span> AsyncSession</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_db</span>() -&gt; AsyncGenerator[AsyncSession, <span class="literal">None</span>]:</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> AsyncSessionLocal() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">yield</span> session</span><br><span class="line">            <span class="keyword">await</span> session.commit()</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">await</span> session.rollback()</span><br><span class="line">            <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="ORM-最佳实践"><a href="#ORM-最佳实践" class="headerlink" title="ORM 最佳实践"></a>ORM 最佳实践</h3><details class="folding-tag" purple><summary> 🗄️ ORM 使用建议 </summary>              <div class='content'>              <ol><li><strong>连接池配置</strong>: 根据应用负载合理配置 <code>pool_size</code> 和 <code>max_overflow</code></li><li><strong>索引优化</strong>: 为经常查询的字段添加数据库索引</li><li><strong>批量操作</strong>: 使用 <code>add_all()</code> 和批量更新提高性能</li><li><strong>N+1 问题</strong>: 使用 <code>selectinload()</code> 和 <code>joinedload()</code> 预加载关联数据</li><li><strong>事务管理</strong>: 确保事务在 <code>try-except-finally</code> 中正确处理</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 批量插入</span></span><br><span class="line">books = [Book(**data) <span class="keyword">for</span> data <span class="keyword">in</span> book_list]</span><br><span class="line">db.add_all(books)</span><br><span class="line"><span class="keyword">await</span> db.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预加载关联数据</span></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> selectinload</span><br><span class="line"></span><br><span class="line">result = <span class="keyword">await</span> db.execute(</span><br><span class="line">    select(Book).options(selectinload(Book.author))</span><br><span class="line">)</span><br></pre></td></tr></table></figure>              </div>            </details><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/persistence_techniques.html">SQLAlchemy Performance</a></p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><details class="folding-tag" yellow><summary> ❓ 中间件相关问题 </summary>              <div class='content'>              <h3 id="Q1-中间件和依赖注入有什么区别"><a href="#Q1-中间件和依赖注入有什么区别" class="headerlink" title="Q1: 中间件和依赖注入有什么区别?"></a>Q1: 中间件和依赖注入有什么区别?</h3><p>中间件控制<strong>所有</strong>请求, 适合全局处理 (如日志、CORS). 依赖注入控制<strong>特定</strong>路由, 适合业务逻辑 (如权限验证、数据库会话).</p><p>Ref. <a href="https://fastapi.tiangolo.com/advanced/middleware/">Advanced Middleware</a></p>              </div>            </details><details class="folding-tag" orange><summary> 🤔 ORM 相关问题 </summary>              <div class='content'>              <h3 id="Q2-如何处理数据库连接池耗尽"><a href="#Q2-如何处理数据库连接池耗尽" class="headerlink" title="Q2: 如何处理数据库连接池耗尽?"></a>Q2: 如何处理数据库连接池耗尽?</h3><p>合理配置连接池参数:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">async_engine = create_async_engine(</span><br><span class="line">    ASYNC_DATABASE_URL,</span><br><span class="line">    pool_size=<span class="number">20</span>,      <span class="comment"># 增加连接池大小</span></span><br><span class="line">    max_overflow=<span class="number">40</span>,   <span class="comment"># 增加溢出连接数</span></span><br><span class="line">    pool_recycle=<span class="number">3600</span>, <span class="comment"># 连接回收时间 (秒)</span></span><br><span class="line">    pool_pre_ping=<span class="literal">True</span> <span class="comment"># 连接前检查可用性</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/core/pooling.html">Connection Pooling</a></p>              </div>            </details><details class="folding-tag" red><summary> ⚠️ 异步操作注意事项 </summary>              <div class='content'>              <h3 id="Q3-为什么数据库操作要使用异步"><a href="#Q3-为什么数据库操作要使用异步" class="headerlink" title="Q3: 为什么数据库操作要使用异步?"></a>Q3: 为什么数据库操作要使用异步?</h3><p>FastAPI 是异步框架, 使用同步数据库驱动会阻塞事件循环, 导致性能下降. 使用异步驱动 (如 <code>aiomysql</code>) 可以充分利用异步优势, 提高并发性能.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ❌ 错误: 使用同步引擎</span></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line">engine = create_engine(<span class="string">&quot;mysql+pymysql://...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ 正确: 使用异步引擎</span></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.asyncio <span class="keyword">import</span> create_async_engine</span><br><span class="line">engine = create_async_engine(<span class="string">&quot;mysql+aiomysql://...&quot;</span>)</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://docs.sqlalchemy.org/en/20/orm/extensions/asyncio.html">AsyncIO Strategy</a></p>              </div>            </details><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><a class="btn-beautify blue" href="https://fastapi.tiangolo.com/tutorial/dependencies/" title="FastAPI 依赖注入文档"><i class="fa-solid fa-book"></i><span>FastAPI 依赖注入文档</span></a><a class="btn-beautify purple" href="https://docs.sqlalchemy.org/en/20/orm/" title="SQLAlchemy ORM 文档"><i class="fa-solid fa-database"></i><span>SQLAlchemy ORM 文档</span></a><a class="btn-beautify green" href="https://fastapi.tiangolo.com/tutorial/middleware/" title="FastAPI 中间件文档"><i class="fa-solid fa-layer-group"></i><span>FastAPI 中间件文档</span></a><a class="btn-beautify orange" href="https://docs.sqlalchemy.org/en/20/core/pooling.html" title="连接池配置"><i class="fa-solid fa-plug"></i><span>连接池配置</span></a><a class="btn-beautify red" href="https://docs.sqlalchemy.org/en/20/orm/queryguide/" title="SQLAlchemy 查询指南"><i class="fa-solid fa-magnifying-glass"></i><span>SQLAlchemy 查询指南</span></a><div class="tag link"><a class="link-card" title="FastAPI 中文文档 - 依赖注入" href="https://fastapi.tiangolo.com/zh/tutorial/dependencies/"><div class="left"><img src="https://avatars.githubusercontent.com/u/156354296?s=48&v=4"/></div><div class="right"><p class="text">FastAPI 中文文档 - 依赖注入</p><p class="url">https://fastapi.tiangolo.com/zh/tutorial/dependencies/</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> FastAPI </tag>
            
            <tag> 中间件 </tag>
            
            <tag> ORM </tag>
            
            <tag> SQLAlchemy </tag>
            
            <tag> 依赖注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FastAPI文档(一) 入门</title>
      <link href="/posts/6b2c83c4/"/>
      <url>/posts/6b2c83c4/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>FastAPI 是一个基于 Python 的高性能 Web 框架, 专门用于快速构建 API 接口服务. 它基于 Starlette 和 Pydantic 构建, 支持 async/await 语法, 性能可媲美 NodeJS 和 Go.</p><div class="tag link"><a class="link-card" title="FastAPI 官方文档" href="https://fastapi.tiangolo.com/"><div class="left"><img src="https://avatars.githubusercontent.com/u/156354296?s=48&v=4"/></div><div class="right"><p class="text">FastAPI 官方文档</p><p class="url">https://fastapi.tiangolo.com/</p></div></a></div><h3 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h3><div class="note success flat"><p><strong>异步高性能</strong>: 基于 ASGI 标准, 支持异步编程, 性能接近 NodeJS 和 Go</p></div><div class="note primary flat"><p><strong>开发效率高</strong>: Pydantic 类型提示与验证, 减少手动校验代码</p></div><div class="note info flat"><p><strong>自动生成文档</strong>: Swagger UI 交互式文档和 ReDoc 文档, 浏览器中直接调用和测试 API</p></div><ul><li><strong>类型安全</strong>: 利用 Python 类型注解, 自动数据验证和序列化</li><li><strong>依赖注入</strong>: 强大的依赖注入系统, 简化代码复用</li></ul><p>Ref. <a href="https://fastapi.tiangolo.com/features/">FastAPI Features</a></p><h2 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h2><h3 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h3><div class="note warning flat"><ul><li>Python 3.8+</li><li>推荐使用虚拟环境隔离项目依赖</li></ul></div><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fab fa-linux"></i>Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 Homebrew 安装 Python (如果未安装)</span></span><br><span class="line">brew install python@3.11</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建项目目录</span></span><br><span class="line"><span class="built_in">mkdir</span> fastapi-project &amp;&amp; <span class="built_in">cd</span> fastapi-project</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line">python3 -m venv venv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 激活虚拟环境</span></span><br><span class="line"><span class="built_in">source</span> venv/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 FastAPI (标准版, 包含常用依赖)</span></span><br><span class="line">pip install <span class="string">&quot;fastapi[standard]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或安装精简版 (不包含 uvicorn 等依赖)</span></span><br><span class="line">pip install fastapi</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 winget 安装 Python (如果未安装)</span></span><br><span class="line">winget install Python.Python.<span class="number">3.11</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建项目目录</span></span><br><span class="line">mkdir fastapi<span class="literal">-project</span></span><br><span class="line"><span class="built_in">cd</span> fastapi<span class="literal">-project</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line">python <span class="literal">-m</span> venv venv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 激活虚拟环境</span></span><br><span class="line">.\venv\Scripts\activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 FastAPI (标准版, 包含常用依赖)</span></span><br><span class="line">pip install <span class="string">&quot;fastapi[standard]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或安装精简版 (不包含 uvicorn 等依赖)</span></span><br><span class="line">pip install fastapi</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian 安装 Python</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install python3.11 python3.11-venv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建项目目录</span></span><br><span class="line"><span class="built_in">mkdir</span> fastapi-project &amp;&amp; <span class="built_in">cd</span> fastapi-project</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line">python3 -m venv venv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 激活虚拟环境</span></span><br><span class="line"><span class="built_in">source</span> venv/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 FastAPI (标准版, 包含常用依赖)</span></span><br><span class="line">pip install <span class="string">&quot;fastapi[standard]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或安装精简版 (不包含 uvicorn 等依赖)</span></span><br><span class="line">pip install fastapi</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/first-steps/">FastAPI Installation</a></p><h3 id="依赖说明"><a href="#依赖说明" class="headerlink" title="依赖说明"></a>依赖说明</h3><p>FastAPI 提供多种安装选项:</p><div class="table-container"><table><thead><tr><th>安装方式</th><th>命令</th><th>包含依赖</th><th>适用场景</th></tr></thead><tbody><tr><td>标准版</td><td><code>pip install &quot;fastapi[standard]&quot;</code></td><td>uvicorn, fastapi-cli, fastapi-cloud-cli 等</td><td>生产环境推荐</td></tr><tr><td>标准版 (无云 CLI)</td><td><code>pip install &quot;fastapi[standard-no-fastapi-cloud-cli]&quot;</code></td><td>uvicorn, fastapi-cli 等</td><td>不需要云部署功能</td></tr><tr><td>精简版</td><td><code>pip install fastapi</code></td><td>仅核心框架</td><td>需要精确控制依赖</td></tr></tbody></table></div><div class="note danger flat"><p>P.S. 从 FastAPI 最新版本开始, 标准依赖不再默认包含, 需要显式指定 <code>[standard]</code> 才会安装 uvicorn 等常用依赖.</p></div><p>Ref. <a href="https://fastapi.tiangolo.com/#installation">FastAPI Dependencies</a></p><h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h3 id="第一个-FastAPI-程序"><a href="#第一个-FastAPI-程序" class="headerlink" title="第一个 FastAPI 程序"></a>第一个 FastAPI 程序</h3><p>创建 <code>main.py</code> 文件:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FastAPI 实例</span></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hello World&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/hello&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_hello</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;你好 FastAPI&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 以上代码定义了两个路由:</p><ul><li><code>GET /</code> - 返回欢迎消息</li><li><code>GET /hello</code> - 返回中文问候</li></ul><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/first-steps/">FastAPI First Steps</a></p><h3 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发环境运行 (带自动重载)</span></span><br><span class="line">uvicorn main:app --reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定主机和端口</span></span><br><span class="line">uvicorn main:app --host 0.0.0.0 --port 8000 --reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生产环境运行 (多 worker)</span></span><br><span class="line">uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4</span><br></pre></td></tr></table></figure><p>参数说明:</p><ul><li><code>main:app</code> - main.py 文件中的 app 对象</li><li><code>--reload</code> - 代码更改后自动重启服务器 (仅开发环境)</li><li><code>--host</code> - 绑定的主机地址, 0.0.0.0 表示所有网络接口</li><li><code>--port</code> - 监听端口号</li><li><code>--workers</code> - worker 进程数 (生产环境)</li></ul><div class="note warning flat"><p>P.S. <code>--reload</code> 选项在开发环境中很有用, 但会消耗更多资源且不够稳定, 生产环境切勿使用.</p></div><p>Ref. <a href="https://www.uvicorn.org/deployment/">Uvicorn Deployment</a></p><h3 id="访问项目"><a href="#访问项目" class="headerlink" title="访问项目"></a>访问项目</h3><ul><li><strong>API 服务</strong>: <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a></li><li><strong>交互式文档 (Swagger UI)</strong>: <a href="http://127.0.0.1:8000/docs">http://127.0.0.1:8000/docs</a></li><li><strong>文档 (ReDoc)</strong>: <a href="http://127.0.0.1:8000/redoc">http://127.0.0.1:8000/redoc</a></li></ul><p>e.g. 访问 <a href="http://127.0.0.1:8000/docs">http://127.0.0.1:8000/docs</a> 可以看到自动生成的交互式 API 文档, 可以直接在浏览器中测试接口.</p><h2 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h2><h3 id="同步与异步"><a href="#同步与异步" class="headerlink" title="同步与异步"></a>同步与异步</h3><p>FastAPI 支持同步和异步两种函数定义方式. 异步函数使用 <code>async def</code> 定义, 可以利用 <code>await</code> 关键字处理 I/O 操作, 提高并发性能.</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">同步函数</button><button type="button" class="tab">异步函数</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/sync&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func_sync</span>():</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;time&quot;</span>: <span class="string">f&#x27;<span class="subst">&#123;end-start:<span class="number">.2</span>f&#125;</span>s&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 同步函数会阻塞请求处理, 每个请求必须等待前一个请求完成.</p></div><div class="tab-item-content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/async&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func_async</span>():</span><br><span class="line">    start = time.time()</span><br><span class="line">    tasks = [asyncio.sleep(<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">    <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;time&quot;</span>: <span class="string">f&#x27;<span class="subst">&#123;end-start:<span class="number">.2</span>f&#125;</span>s&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 异步函数可以同时处理多个 I/O 操作, 显著提高并发性能.</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>Ref. <a href="https://fastapi.tiangolo.com/async/">Async Path Operations</a></p><h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><p>路由就是 URL 地址和处理函数之间的映射关系, 它决定了当用户访问某个特定网址时, 服务器应该执行哪段代码来返回结果.</p><h4 id="路由定义"><a href="#路由定义" class="headerlink" title="路由定义"></a>路由定义</h4><p>FastAPI 的路由定义基于 Python 的装饰器模式:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;hello world&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>装饰器说明:</p><ul><li><code>@app.get(&quot;/&quot;)</code> - 定义 GET 请求方法, 路径为 <code>/</code></li><li><code>async def root()</code> - 异步处理函数</li><li><code>return &#123;...&#125;</code> - 返回 JSON 响应</li></ul><h4 id="HTTP-方法"><a href="#HTTP-方法" class="headerlink" title="HTTP 方法"></a>HTTP 方法</h4><p>FastAPI 支持所有常见的 HTTP 方法:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)    </span><span class="comment"># GET 请求 - 查询资源</span></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/&quot;</span></span>)   </span><span class="comment"># POST 请求 - 创建资源</span></span><br><span class="line"><span class="meta">@app.put(<span class="params"><span class="string">&quot;/&quot;</span></span>)    </span><span class="comment"># PUT 请求 - 更新资源</span></span><br><span class="line"><span class="meta">@app.delete(<span class="params"><span class="string">&quot;/&quot;</span></span>) </span><span class="comment"># DELETE 请求 - 删除资源</span></span><br><span class="line"><span class="meta">@app.patch(<span class="params"><span class="string">&quot;/&quot;</span></span>)  </span><span class="comment"># PATCH 请求 - 部分更新资源</span></span><br><span class="line"><span class="meta">@app.options(<span class="params"><span class="string">&quot;/&quot;</span></span>) </span><span class="comment"># OPTIONS 请求 - 查询支持的方法</span></span><br><span class="line"><span class="meta">@app.head(<span class="params"><span class="string">&quot;/&quot;</span></span>)    </span><span class="comment"># HEAD 请求 - 获取响应头</span></span><br></pre></td></tr></table></figure><p>e.g. 使用对应的装饰器来定义不同 HTTP 方法的路由.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/path-operation-configuration/">Path Operation Decorators</a></p><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>参数就是客户端发送请求时附带的额外信息和指令. 参数的作用是让同一个接口能根据不同的输入, 返回不同的输出, 实现动态交互.</p><h4 id="参数分类"><a href="#参数分类" class="headerlink" title="参数分类"></a>参数分类</h4><div class="table-container"><table><thead><tr><th>参数类型</th><th>位置</th><th>作用</th><th>HTTP 方法</th></tr></thead><tbody><tr><td>路径参数</td><td>URL 路径的一部分 <code>/book/&#123;id&#125;</code></td><td>指向唯一的、特定的资源</td><td>GET</td></tr><tr><td>查询参数</td><td>URL? 之后 <code>k1=v1&amp;k2=v2</code></td><td>对资源集合进行过滤、排序、分页等操作</td><td>GET</td></tr><tr><td>请求体</td><td>HTTP 请求的消息体 (body) 中</td><td>创建、更新资源, 携带大量数据 (如 JSON)</td><td>POST、PUT 等</td></tr></tbody></table></div><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/body/">Request Body</a></p><h4 id="路径参数"><a href="#路径参数" class="headerlink" title="路径参数"></a>路径参数</h4><p>路径参数是 URL 路径的一部分, 用于指向唯一的、特定的资源.</p><p><strong>基础用法</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Path</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/&#123;id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book</span>(<span class="params"><span class="built_in">id</span>: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;id&quot;</span>: <span class="built_in">id</span>, <span class="string">&quot;title&quot;</span>: <span class="string">f&quot;这是第<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>本书&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>e.g. 访问 <code>/book/1</code> 会返回 <code>&#123;&quot;id&quot;: 1, &quot;title&quot;: &quot;这是第1本书&quot;&#125;</code></p><p><strong>类型注解 Path</strong></p><p>FastAPI 允许为参数声明额外的信息和校验:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/book/&#123;id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_book</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="built_in">id</span>: <span class="built_in">int</span> = Path(<span class="params">..., gt=<span class="number">0</span>, lt=<span class="number">101</span>, description=<span class="string">&quot;书籍id, 取值范围1-100&quot;</span></span>)</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;id&quot;</span>: <span class="built_in">id</span>, <span class="string">&quot;title&quot;</span>: <span class="string">f&quot;这是第<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>本书&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p><strong>Path 参数说明</strong></p><div class="table-container"><table><thead><tr><th>参数</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>...</code></td><td>必填</td><td><code>id: int = Path(...)</code></td></tr><tr><td><code>gt</code></td><td>大于</td><td><code>gt=0</code> 表示必须大于 0</td></tr><tr><td><code>ge</code></td><td>大于等于</td><td><code>ge=1</code> 表示必须大于等于 1</td></tr><tr><td><code>lt</code></td><td>小于</td><td><code>lt=101</code> 表示必须小于 101</td></tr><tr><td><code>le</code></td><td>小于等于</td><td><code>le=100</code> 表示必须小于等于 100</td></tr><tr><td><code>description</code></td><td>描述</td><td><code>description=&quot;用户ID&quot;</code></td></tr><tr><td><code>min_length</code></td><td>最小长度 (字符串)</td><td><code>min_length=2</code></td></tr><tr><td><code>max_length</code></td><td>最大长度 (字符串)</td><td><code>max_length=10</code></td></tr></tbody></table></div><p>e.g. 使用 Path 参数可以限制 ID 的取值范围为 1-100, 如果用户传入 0 或 101 会返回 422 验证错误.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/path-params/">Path Parameters</a></p><h4 id="查询参数"><a href="#查询参数" class="headerlink" title="查询参数"></a>查询参数</h4><p>查询参数位于 URL? 之后, 用于对资源集合进行过滤、排序、分页等操作.</p><p><strong>基础用法</strong></p><p>声明的参数不是路径参数时, 路径操作函数会把该参数自动解释为查询参数:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Query</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/news/news_list&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_news_list</span>(<span class="params">skip: <span class="built_in">int</span>, limit: <span class="built_in">int</span> = <span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;skip&quot;</span>: skip, <span class="string">&quot;limit&quot;</span>: limit&#125;</span><br></pre></td></tr></table></figure><p>e.g. 访问 <code>/news/news_list?skip=0&amp;limit=10</code> 会返回 <code>&#123;&quot;skip&quot;: 0, &quot;limit&quot;: 10&#125;</code></p><p><strong>类型注解 Query</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/news/news_list&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_news_list</span>(<span class="params"></span></span><br><span class="line"><span class="params">    skip: <span class="built_in">int</span> = Query(<span class="params"><span class="number">0</span>, description=<span class="string">&quot;跳过的记录数&quot;</span>, lt=<span class="number">100</span></span>),</span></span><br><span class="line"><span class="params">    limit: <span class="built_in">int</span> = Query(<span class="params"><span class="number">10</span>, description=<span class="string">&quot;返回的记录数&quot;</span></span>)</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;skip&quot;</span>: skip, <span class="string">&quot;limit&quot;</span>: limit&#125;</span><br></pre></td></tr></table></figure><p><strong>Query 参数说明</strong></p><div class="table-container"><table><thead><tr><th>参数</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>...</code></td><td>必填</td><td><code>q: str = Query(...)</code></td></tr><tr><td><code>gt</code></td><td>大于</td><td><code>gt=0</code></td></tr><tr><td><code>ge</code></td><td>大于等于</td><td><code>ge=1</code></td></tr><tr><td><code>lt</code></td><td>小于</td><td><code>lt=100</code></td></tr><tr><td><code>le</code></td><td>小于等于</td><td><code>le=50</code></td></tr><tr><td><code>default</code></td><td>默认值</td><td><code>default=10</code></td></tr><tr><td><code>description</code></td><td>描述</td><td><code>description=&quot;搜索关键词&quot;</code></td></tr><tr><td><code>min_length</code></td><td>最小长度</td><td><code>min_length=2</code></td></tr><tr><td><code>max_length</code></td><td>最大长度</td><td><code>max_length=50</code></td></tr></tbody></table></div><p>e.g. 使用 Query 参数可以限制 skip 必须小于 100, 如果用户传入 100 会返回 422 验证错误.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/query-params/">Query Parameters</a></p><h4 id="请求体参数"><a href="#请求体参数" class="headerlink" title="请求体参数"></a>请求体参数</h4><p>请求体参数位于 HTTP 请求的消息体 (body) 中, 用于创建、更新资源, 携带大量数据 (如 JSON).</p><p>在 HTTP 协议中, 一个完整的请求由三部分组成:</p><ol><li><strong>请求行</strong>: 包含方法、URL、协议版本</li><li><strong>请求头</strong>: 元数据信息 (Content-Type、Authorization 等)</li><li><strong>请求体</strong>: 实际要发送的数据内容</li></ol><p><strong>基础用法</strong></p><ol><li>定义类型 (继承 BaseModel)</li><li>类型注解</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义请求体模型</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    username: <span class="built_in">str</span></span><br><span class="line">    password: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/register&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">user: User</span>):</span><br><span class="line">    <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure><p>e.g. 发送 POST 请求到 <code>/register</code>, 请求体为 <code>&#123;&quot;username&quot;: &quot;test&quot;, &quot;password&quot;: &quot;123456&quot;&#125;</code></p><p><strong>类型注解 Field</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, Field</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    username: <span class="built_in">str</span> = Field(</span><br><span class="line">        default=<span class="string">&quot;张三&quot;</span>,</span><br><span class="line">        min_length=<span class="number">2</span>,</span><br><span class="line">        max_length=<span class="number">10</span>,</span><br><span class="line">        description=<span class="string">&quot;用户名, 长度要求2-10个字&quot;</span></span><br><span class="line">    )</span><br><span class="line">    password: <span class="built_in">str</span> = Field(min_length=<span class="number">3</span>, max_length=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/register&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">user: User</span>):</span><br><span class="line">    <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure><p><strong>Field 参数说明</strong></p><div class="table-container"><table><thead><tr><th>参数</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>...</code></td><td>必填</td><td><code>username: str = Field(...)</code></td></tr><tr><td><code>gt</code></td><td>大于</td><td><code>price: float = Field(gt=0)</code></td></tr><tr><td><code>ge</code></td><td>大于等于</td><td><code>age: int = Field(ge=18)</code></td></tr><tr><td><code>lt</code></td><td>小于</td><td><code>discount: float = Field(lt=1)</code></td></tr><tr><td><code>le</code></td><td>小于等于</td><td><code>quantity: int = Field(le=100)</code></td></tr><tr><td><code>default</code></td><td>默认值</td><td><code>status: str = Field(default=&quot;active&quot;)</code></td></tr><tr><td><code>description</code></td><td>描述</td><td><code>description=&quot;用户名&quot;</code></td></tr><tr><td><code>min_length</code></td><td>最小长度</td><td><code>min_length=2</code></td></tr><tr><td><code>max_length</code></td><td>最大长度</td><td><code>max_length=50</code></td></tr></tbody></table></div><p>e.g. 使用 Field 参数可以限制用户名长度为 2-10 个字符, 密码长度为 3-20 个字符.</p><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/body/">Request Body</a></p><h4 id="混合参数"><a href="#混合参数" class="headerlink" title="混合参数"></a>混合参数</h4><p>FastAPI 可以同时使用路径参数、查询参数和请求体参数:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Path, Query</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, Field</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    title: <span class="built_in">str</span> = Field(..., min_length=<span class="number">2</span>, max_length=<span class="number">100</span>)</span><br><span class="line">    author: <span class="built_in">str</span> = Field(..., min_length=<span class="number">2</span>, max_length=<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.put(<span class="params"><span class="string">&quot;/books/&#123;book_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">update_book</span>(<span class="params"></span></span><br><span class="line"><span class="params">    book_id: <span class="built_in">int</span> = Path(<span class="params">..., gt=<span class="number">0</span>, description=<span class="string">&quot;书籍ID&quot;</span></span>),</span></span><br><span class="line"><span class="params">    book: Book = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    q: <span class="built_in">str</span> = Query(<span class="params"><span class="literal">None</span>, description=<span class="string">&quot;搜索关键词&quot;</span></span>)</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;book_id&quot;</span>: book_id,</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: book.title <span class="keyword">if</span> book <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;author&quot;</span>: book.author <span class="keyword">if</span> book <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;query&quot;</span>: q</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>e.g. PUT 请求到 <code>/books/1?q=search</code>, 请求体为 <code>&#123;&quot;title&quot;: &quot;Python编程&quot;, &quot;author&quot;: &quot;张三&quot;&#125;</code></p><div class="note success flat"><p>FastAPI 会根据以下规则自动识别参数类型:</p><ol><li>如果参数在路径中声明, 则作为路径参数</li><li>如果参数是单数类型 (int, float, str, bool 等), 则作为查询参数</li><li>如果参数是 Pydantic 模型类型, 则作为请求体</li></ol></div><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/body-multiple-params/">Mix Path, Query and Body Parameters</a></p><h3 id="响应类型"><a href="#响应类型" class="headerlink" title="响应类型"></a>响应类型</h3><p>默认情况下, FastAPI 会自动将路径操作函数返回的 Python 对象 (字典、列表、Pydantic 模型等), 经由 jsonable_encoder 转换为 JSON 兼容格式, 并包装为 JSONResponse 返回.</p><p>如果需要返回非 JSON 数据 (如 HTML、文件流), FastAPI 提供了丰富的响应类型.</p><h4 id="内置响应类型"><a href="#内置响应类型" class="headerlink" title="内置响应类型"></a>内置响应类型</h4><div class="table-container"><table><thead><tr><th>响应类型</th><th>用途</th><th>示例</th></tr></thead><tbody><tr><td>JSONResponse</td><td>默认响应, 返回 JSON 数据</td><td><code>return &#123;&quot;key&quot;: &quot;value&quot;&#125;</code></td></tr><tr><td>HTMLResponse</td><td>返回 HTML 内容</td><td><code>return HTMLResponse(html_content)</code></td></tr><tr><td>PlainTextResponse</td><td>返回纯文本</td><td><code>return PlainTextResponse(&quot;text&quot;)</code></td></tr><tr><td>FileResponse</td><td>返回文件下载</td><td><code>return FileResponse(path)</code></td></tr><tr><td>StreamingResponse</td><td>流式响应</td><td>生成器函数返回数据</td></tr><tr><td>RedirectResponse</td><td>重定向</td><td><code>return RedirectResponse(url)</code></td></tr><tr><td>ORJSONResponse</td><td>使用 orjson 的更快 JSON 响应</td><td><code>return ORJSONResponse(content)</code></td></tr></tbody></table></div><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/response-model/">Response Models</a></p><h4 id="响应类型设置方式"><a href="#响应类型设置方式" class="headerlink" title="响应类型设置方式"></a>响应类型设置方式</h4><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">装饰器指定响应类</button><button type="button" class="tab">返回响应对象</button></div><div class="tab-contents"><div class="tab-item-content active"><p>场景: 固定返回类型 (HTML、纯文本等)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> HTMLResponse</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/html&quot;</span>, response_class=HTMLResponse</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_html</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;h1&gt;这是一级标题&lt;/h1&gt;&quot;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>场景: 文件下载、图片、流式响应</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> FileResponse</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/file&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_file</span>():</span><br><span class="line">    path = <span class="string">&quot;./files/1.jpeg&quot;</span></span><br><span class="line">    <span class="keyword">return</span> FileResponse(path)</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>e.g. 方式一适用于固定返回类型的场景, 方式二适用于需要动态返回不同类型的场景.</p><p>Ref. <a href="https://fastapi.tiangolo.com/advanced/custom-response/">Custom Response - HTML, Stream, File, others</a></p><h4 id="响应-HTML-格式"><a href="#响应-HTML-格式" class="headerlink" title="响应 HTML 格式"></a>响应 HTML 格式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> HTMLResponse</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/html&quot;</span>, response_class=HTMLResponse</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_html</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">    &lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;FastAPI HTML&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;这是一级标题&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;这是段落内容&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">    &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>e.g. 访问 <code>/html</code> 会返回完整的 HTML 页面.</p><h4 id="响应文件格式"><a href="#响应文件格式" class="headerlink" title="响应文件格式"></a>响应文件格式</h4><p>FileResponse 是 FastAPI 提供的专门用于高效返回文件内容 (如图片、PDF、Excel、音视频等) 的响应类. 它能够智能处理文件路径、媒体类型推断、范围请求和缓存头部, 是服务静态文件的推荐方式.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> FileResponse</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/file/&#123;filename&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_file</span>(<span class="params">filename: <span class="built_in">str</span></span>):</span><br><span class="line">    path = <span class="string">f&quot;./files/<span class="subst">&#123;filename&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> FileResponse(</span><br><span class="line">        path=path,</span><br><span class="line">        media_type=<span class="string">&#x27;application/octet-stream&#x27;</span>,</span><br><span class="line">        filename=filename</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p>e.g. 访问 <code>/file/document.pdf</code> 会下载 PDF 文件.</p><div class="note info flat"><p>P.S. FileResponse 会自动处理以下内容:</p><ul><li>根据文件扩展名推断 Content-Type</li><li>支持范围请求 (用于视频播放)</li><li>自动设置缓存头部</li></ul></div><p>Ref. <a href="https://fastapi.tiangolo.com/advanced/custom-response/#using-fileresponse">Using FileResponse</a></p><h4 id="自定义响应数据格式"><a href="#自定义响应数据格式" class="headerlink" title="自定义响应数据格式"></a>自定义响应数据格式</h4><p>response_model 是路径操作装饰器 (如 @app.get 或 @app.post) 的关键参数, 它通过一个 Pydantic 模型来严格定义和约束 API 端点的输出格式. 这一机制在提供自动数据验证和序列化的同时, 更是保障数据安全性的第一道防线.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">News</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    <span class="built_in">id</span>: <span class="built_in">int</span></span><br><span class="line">    title: <span class="built_in">str</span></span><br><span class="line">    content: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/news/&#123;id&#125;&quot;</span>, response_model=News</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_news</span>(<span class="params"><span class="built_in">id</span>: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="comment"># 内部可能包含更多数据</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="built_in">id</span>,</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: <span class="string">f&quot;这是第<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>本书&quot;</span>,</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: <span class="string">&quot;这是一本好书&quot;</span>,</span><br><span class="line">        <span class="string">&quot;internal_field&quot;</span>: <span class="string">&quot;这个字段不会返回给客户端&quot;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>e.g. 使用 response_model=News 后, 只有 News 模型中定义的字段会返回给客户端, internal_field 会被过滤掉.</p><div class="note success flat"><p>P.S. response_model 的作用:</p><ul><li>定义响应数据格式</li><li>自动数据验证和序列化</li><li>过滤敏感字段 (如密码、内部字段)</li><li>在自动文档中生成响应示例</li></ul></div><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/response-model/">Response Model</a></p><h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>使用 HTTPException 返回错误响应:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, HTTPException, status</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">items = &#123;<span class="string">&quot;foo&quot;</span>: <span class="string">&quot;The Foo Fighters&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&#123;item_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_item</span>(<span class="params">item_id: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">if</span> item_id <span class="keyword">not</span> <span class="keyword">in</span> items:</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(</span><br><span class="line">            status_code=<span class="number">404</span>,</span><br><span class="line">            detail=<span class="string">&quot;Item not found&quot;</span>,</span><br><span class="line">            headers=&#123;<span class="string">&quot;X-Error&quot;</span>: <span class="string">&quot;There goes my error&quot;</span>&#125;</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;item&quot;</span>: items[item_id]&#125;</span><br></pre></td></tr></table></figure><p>e.g. 当 item_id 不存在时, 返回 404 错误.</p><div class="note warning flat"><p>P.S. HTTPException 是 FastAPI 处理错误的推荐方式, 它会自动返回格式化的 JSON 错误响应.</p></div><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/handling-errors/">Exception Handling</a></p><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>推荐的项目结构:</p><details class="folding-tag" green><summary> ✅ 推荐的项目结构 </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">my_project/</span><br><span class="line">├── app/</span><br><span class="line">│   ├── __init__.py</span><br><span class="line">│   ├── main.py          # FastAPI 应用入口</span><br><span class="line">│   ├── api/             # API 路由</span><br><span class="line">│   │   ├── __init__.py</span><br><span class="line">│   │   └── v1/</span><br><span class="line">│   │       ├── __init__.py</span><br><span class="line">│   │       └── items.py</span><br><span class="line">│   ├── models/          # 数据模型</span><br><span class="line">│   │   ├── __init__.py</span><br><span class="line">│   │   └── item.py</span><br><span class="line">│   ├── schemas/         # Pydantic 模型</span><br><span class="line">│   │   ├── __init__.py</span><br><span class="line">│   │   └── item.py</span><br><span class="line">│   ├── services/        # 业务逻辑</span><br><span class="line">│   │   ├── __init__.py</span><br><span class="line">│   │   └── item_service.py</span><br><span class="line">│   └── utils/           # 工具函数</span><br><span class="line">│       ├── __init__.py</span><br><span class="line">│       └── helpers.py</span><br><span class="line">├── tests/               # 测试</span><br><span class="line">├── requirements.txt     # 依赖清单</span><br><span class="line">└── README.md</span><br></pre></td></tr></table></figure>              </div>            </details><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/bigger-applications/">Bigger Applications - Multiple Files</a></p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><details class="folding-tag" yellow><summary> ❓ FastAPI 和 Flask 的区别 </summary>              <div class='content'>              <h3 id="Q1-FastAPI-和-Flask-有什么区别"><a href="#Q1-FastAPI-和-Flask-有什么区别" class="headerlink" title="Q1: FastAPI 和 Flask 有什么区别?"></a>Q1: FastAPI 和 Flask 有什么区别?</h3><div class="table-container"><table><thead><tr><th>特性</th><th>FastAPI</th><th>Flask</th></tr></thead><tbody><tr><td>性能</td><td>异步高性能</td><td>同步性能较低</td></tr><tr><td>类型验证</td><td>自动 Pydantic 验证</td><td>需要手动验证</td></tr><tr><td>文档</td><td>自动生成交互式文档</td><td>需要手动编写</td></tr><tr><td>学习曲线</td><td>需要理解异步编程</td><td>相对简单</td></tr><tr><td>适用场景</td><td>现代 API 服务</td><td>传统 Web 应用</td></tr></tbody></table></div><p>Ref. <a href="https://fastapi.tiangolo.com/fastapi-alternatives/">Alternatives, Inspiration and Comparisons</a></p>              </div>            </details><details class="folding-tag" purple><summary> 🚀 如何部署 FastAPI </summary>              <div class='content'>              <h3 id="Q2-如何部署-FastAPI-应用"><a href="#Q2-如何部署-FastAPI-应用" class="headerlink" title="Q2: 如何部署 FastAPI 应用?"></a>Q2: 如何部署 FastAPI 应用?</h3><p>推荐使用 Docker 容器化部署:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;uvicorn&quot;</span>, <span class="string">&quot;main:app&quot;</span>, <span class="string">&quot;--host&quot;</span>, <span class="string">&quot;0.0.0.0&quot;</span>, <span class="string">&quot;--port&quot;</span>, <span class="string">&quot;8000&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>也可以使用 Gunicorn + Uvicorn:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install gunicorn</span><br><span class="line">gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://fastapi.tiangolo.com/deployment/docker/">Deployment - Docker</a></p>              </div>            </details><details class="folding-tag" cyan><summary> 📁 文件上传处理 </summary>              <div class='content'>              <h3 id="Q3-如何处理文件上传"><a href="#Q3-如何处理文件上传" class="headerlink" title="Q3: 如何处理文件上传?"></a>Q3: 如何处理文件上传?</h3><p>使用 <code>UploadFile</code> 处理文件上传:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, File, UploadFile</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/uploadfile&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">create_upload_file</span>(<span class="params">file: UploadFile = File(<span class="params">...</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;filename&quot;</span>: file.filename&#125;</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/request-files/">Request Files</a></p>              </div>            </details><details class="folding-tag" indigo><summary> 🔌 WebSocket 实现 </summary>              <div class='content'>              <h3 id="Q4-如何实现-WebSocket"><a href="#Q4-如何实现-WebSocket" class="headerlink" title="Q4: 如何实现 WebSocket?"></a>Q4: 如何实现 WebSocket?</h3><p>FastAPI 原生支持 WebSocket:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, WebSocket</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.websocket(<span class="params"><span class="string">&quot;/ws&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">websocket_endpoint</span>(<span class="params">websocket: WebSocket</span>):</span><br><span class="line">    <span class="keyword">await</span> websocket.accept()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = <span class="keyword">await</span> websocket.receive_text()</span><br><span class="line">        <span class="keyword">await</span> websocket.send_text(<span class="string">f&quot;Message text was: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://fastapi.tiangolo.com/advanced/websockets/">WebSockets</a></p>              </div>            </details><details class="folding-tag" orange><summary> 🧪 编写测试 </summary>              <div class='content'>              <h3 id="Q5-如何编写测试"><a href="#Q5-如何编写测试" class="headerlink" title="Q5: 如何编写测试?"></a>Q5: 如何编写测试?</h3><p>使用 pytest 和 httpx 测试 FastAPI 应用:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pytest httpx</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi.testclient <span class="keyword">import</span> TestClient</span><br><span class="line"><span class="keyword">from</span> main <span class="keyword">import</span> app</span><br><span class="line"></span><br><span class="line">client = TestClient(app)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_read_item</span>():</span><br><span class="line">    response = client.get(<span class="string">&quot;/items/foo&quot;</span>)</span><br><span class="line">    <span class="keyword">assert</span> response.status_code == <span class="number">200</span></span><br><span class="line">    <span class="keyword">assert</span> response.json() == &#123;<span class="string">&quot;item_id&quot;</span>: <span class="string">&quot;foo&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>Ref. <a href="https://fastapi.tiangolo.com/tutorial/testing/">Testing</a></p>              </div>            </details><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><a class="btn-beautify blue" href="https://fastapi.tiangolo.com/" title="FastAPI 官方文档"><i class="fa-solid fa-book"></i><span>FastAPI 官方文档</span></a><a class="btn-beautify purple" href="https://github.com/tiangolo/fastapi" title="FastAPI GitHub"><i class="fa-brands fa-github"></i><span>FastAPI GitHub</span></a><a class="btn-beautify green" href="https://docs.pydantic.dev/" title="Pydantic 文档"><i class="fa-solid fa-shield-halved"></i><span>Pydantic 文档</span></a><a class="btn-beautify orange" href="https://www.uvicorn.org/" title="Uvicorn 文档"><i class="fa-solid fa-server"></i><span>Uvicorn 文档</span></a><a class="btn-beautify red" href="https://www.starlette.io/" title="Starlette 文档"><i class="fa-solid fa-bolt"></i><span>Starlette 文档</span></a><div class="tag link"><a class="link-card" title="FastAPI 中文翻译" href="https://fastapi.tiangolo.com/zh/"><div class="left"><img src="https://avatars.githubusercontent.com/u/156354296?s=48&v=4"/></div><div class="right"><p class="text">FastAPI 中文翻译</p><p class="url">https://fastapi.tiangolo.com/zh/</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> FastAPI </tag>
            
            <tag> 异步编程 </tag>
            
            <tag> Pydantic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Claude文档(二) Agent Skills 使用指南</title>
      <link href="/posts/eccdaad5/"/>
      <url>/posts/eccdaad5/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><div class="note success flat"><p>Claude Code Skills 是一种上下文感知的指令系统, 相当于带目录的说明书. AI 使用 Skills 时, 会先把目录(元数据)加载进 Prompt, 然后根据用户 Prompt 按需加载正文和附录. 比起传统的 Prompt 或 MCP, 大幅降低 token 消耗与提示词复杂度.</p></div><h3 id="核心架构"><a href="#核心架构" class="headerlink" title="核心架构"></a>核心架构</h3><p>Skills 由三层结构组成:</p><div class="table-container"><table><thead><tr><th>层级</th><th>加载时机</th><th>作用</th></tr></thead><tbody><tr><td>元数据</td><td>必定加载</td><td>提供目录和概览信息</td></tr><tr><td>指令</td><td>按需加载</td><td>具体的操作指导</td></tr><tr><td>资源</td><td>按需加载</td><td>支持文件和参考资料</td></tr></tbody></table></div><h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">skill-name/</span><br><span class="line">├── SKILL.md              # 必需: 元数据 + 指令</span><br><span class="line">├── scripts/              # 可选: 可执行代码</span><br><span class="line">│   ├── setup.sh</span><br><span class="line">│   └── helper.py</span><br><span class="line">├── references/           # 可选: 参考文档</span><br><span class="line">│   ├── api-guide.md</span><br><span class="line">│   └── best-practices.md</span><br><span class="line">└── assets/               # 可选: 模板和资源文件</span><br><span class="line">    └── template.json</span><br></pre></td></tr></table></figure><div class="tag link"><a class="link-card" title="Claude Code Official Docs - About Skills" href="https://github.com/anthropics/claude-code/blob/main/plugins/plugin-dev/skills/skill-development/SKILL.md"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Claude Code Official Docs - About Skills</p><p class="url">https://github.com/anthropics/claude-code/blob/main/plugins/plugin-dev/skills/skill-development/SKILL.md</p></div></a></div><h2 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h2><h3 id="Claude-Code-安装"><a href="#Claude-Code-安装" class="headerlink" title="Claude Code 安装"></a>Claude Code 安装</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fab fa-linux"></i>Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Homebrew 安装</span></span><br><span class="line">brew install --cask claude-code</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用 curl</span></span><br><span class="line">curl -fsSL https://claude.ai/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用 npm</span></span><br><span class="line">npm install -g @anthropic-ai/claude-code</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 curl (Windows 10+)</span></span><br><span class="line"><span class="built_in">curl</span> <span class="literal">-fsSL</span> https://claude.ai/install.sh | sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用 npm</span></span><br><span class="line">npm install <span class="literal">-g</span> @anthropic<span class="literal">-ai</span>/claude<span class="literal">-code</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 curl</span></span><br><span class="line">curl -fsSL https://claude.ai/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用 npm</span></span><br><span class="line">npm install -g @anthropic-ai/claude-code</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><div class="note info flat"><p>P.S. 配置目录统一位于 <code>~/.claude</code></p></div><h3 id="账号配置"><a href="#账号配置" class="headerlink" title="账号配置"></a>账号配置</h3><div class="tabs"><div class="nav-tabs no-default"></div><div class="tab-contents"></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h3 id="创建第一个-Skill"><a href="#创建第一个-Skill" class="headerlink" title="创建第一个 Skill"></a>创建第一个 Skill</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建项目目录</span></span><br><span class="line"><span class="built_in">mkdir</span> agent-skills &amp;&amp; <span class="built_in">cd</span> agent-skills</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 创建 skill 目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p .claude/skills/my-first-skill</span><br></pre></td></tr></table></figure><h3 id="编写-SKILL-md"><a href="#编写-SKILL-md" class="headerlink" title="编写 SKILL.md"></a>编写 SKILL.md</h3><div class="note success flat"><p>e.g. 创建一个基础的 Skill:</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">name: my-first-skill</span><br><span class="line">description: 我的第一个 Claude Code Skill</span><br><span class="line"><span class="section">version: 1.0.0</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section"># My First Skill</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 用途</span></span><br><span class="line">帮助快速初始化项目结构</span><br><span class="line"></span><br><span class="line"><span class="section">## 使用场景</span></span><br><span class="line">当需要创建新项目时使用此 skill</span><br><span class="line"></span><br><span class="line"><span class="section">## 操作步骤</span></span><br><span class="line"><span class="bullet">1.</span> 创建项目目录</span><br><span class="line"><span class="bullet">2.</span> 初始化 git</span><br><span class="line"><span class="bullet">3.</span> 创建 README.md</span><br></pre></td></tr></table></figure><a class="btn-beautify blue" href="https://github.com/anthropics/claude-code/blob/main/plugins/plugin-dev/skills/plugin-structure/SKILL.md" title="Skill Structure Documentation"><i class="fa-solid fa-book"></i><span>Skill Structure Documentation</span></a><h3 id="添加资源文件"><a href="#添加资源文件" class="headerlink" title="添加资源文件"></a>添加资源文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 scripts 目录</span></span><br><span class="line"><span class="built_in">mkdir</span> .claude/skills/my-first-skill/scripts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加初始化脚本</span></span><br><span class="line"><span class="built_in">cat</span> &gt; .claude/skills/my-first-skill/scripts/init.sh &lt;&lt; <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">git init</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;# My Project&quot;</span> &gt; README.md</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> +x .claude/skills/my-first-skill/scripts/init.sh</span><br></pre></td></tr></table></figure><h2 id="作用范围"><a href="#作用范围" class="headerlink" title="作用范围"></a>作用范围</h2><h3 id="项目级生效"><a href="#项目级生效" class="headerlink" title="项目级生效"></a>项目级生效</h3><p>Skills 存放在项目的 <code>.claude/skills/</code> 目录下:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">project-root/</span><br><span class="line">├── .claude/</span><br><span class="line">│   └── skills/</span><br><span class="line">│       ├── skill-1/</span><br><span class="line">│       │   └── SKILL.md</span><br><span class="line">│       └── skill-2/</span><br><span class="line">│       ├── SKILL.md</span><br><span class="line">│       └── scripts/</span><br><span class="line">└── src/</span><br></pre></td></tr></table></figure><p>仅对当前项目生效.</p><h3 id="全局生效"><a href="#全局生效" class="headerlink" title="全局生效"></a>全局生效</h3><p>将调试好的 skill 复制到全局目录:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -r .claude/skills/my-first-skill ~/.claude/skills/</span><br></pre></td></tr></table></figure><div class="note primary flat"><p>P.S. 全局 skills 对所有项目可用, 建议将通用技能 (如 coding standards, git workflows) 放在全局目录.</p></div><h2 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h2><h3 id="自动加载机制"><a href="#自动加载机制" class="headerlink" title="自动加载机制"></a>自动加载机制</h3><p>Claude Code 按以下顺序加载 Skills:</p><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart TD    A[用户请求] --&gt; B[加载所有 Skill 元数据]    B --&gt; C{匹配相关 Skill}    C --&gt;|匹配成功| D[加载完整 Skill 内容]    C --&gt;|无匹配| E[仅使用基础能力]    D --&gt; F[加载相关资源文件]    F --&gt; G[执行任务]  </pre></div><h3 id="元数据格式"><a href="#元数据格式" class="headerlink" title="元数据格式"></a>元数据格式</h3><p>SKILL.md 必需的 YAML frontmatter:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">skill-name</span>          <span class="comment"># Skill 名称, 必需</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">简短描述</span>    <span class="comment"># 使用场景说明, 必需</span></span><br><span class="line"><span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span>           <span class="comment"># 版本号, 可选</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">your-name</span>        <span class="comment"># 作者, 可选</span></span><br><span class="line"><span class="attr">tags:</span>                    <span class="comment"># 标签, 可选</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">category1</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">category2</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><h3 id="资源目录说明"><a href="#资源目录说明" class="headerlink" title="资源目录说明"></a>资源目录说明</h3><div class="table-container"><table><thead><tr><th>目录</th><th>用途</th><th>示例</th></tr></thead><tbody><tr><td><code>scripts/</code></td><td>可执行脚本</td><td>Python, Bash, Node.js 脚本</td></tr><tr><td><code>references/</code></td><td>参考文档</td><td>API 文档, 最佳实践指南</td></tr><tr><td><code>assets/</code></td><td>输出资源</td><td>模板, 图标, 配置文件</td></tr></tbody></table></div><h2 id="进阶用法"><a href="#进阶用法" class="headerlink" title="进阶用法"></a>进阶用法</h2><h3 id="Skill-模板"><a href="#Skill-模板" class="headerlink" title="Skill 模板"></a>Skill 模板</h3><div class="note success flat"><p>e.g. 完整的 TypeScript 项目 Skill:</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">name: typescript-patterns</span><br><span class="line">description: TypeScript 项目编码规范和最佳实践</span><br><span class="line"><span class="section">version: 1.0.0</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section"># TypeScript Patterns</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 代码规范</span></span><br><span class="line"></span><br><span class="line"><span class="section">### 文件命名</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 组件: <span class="code">`PascalCase.tsx`</span></span><br><span class="line"><span class="bullet">-</span> 工具函数: <span class="code">`camelCase.ts`</span></span><br><span class="line"><span class="bullet">-</span> 类型定义: <span class="code">`*.types.ts`</span></span><br><span class="line"><span class="bullet">-</span> 测试文件: <span class="code">`*.test.ts`</span> 或 <span class="code">`__tests__/`</span></span><br><span class="line"></span><br><span class="line"><span class="section">### 目录结构</span></span><br><span class="line"></span><br><span class="line"><span class="code">```text</span></span><br><span class="line"><span class="code">src/</span></span><br><span class="line"><span class="code">├── components/     # React 组件</span></span><br><span class="line"><span class="code">├── hooks/          # 自定义 Hooks</span></span><br><span class="line"><span class="code">├── utils/          # 工具函数</span></span><br><span class="line"><span class="code">├── types/          # 类型定义</span></span><br><span class="line"><span class="code">└── services/       # API 服务</span></span><br></pre></td></tr></table></figure><h2 id="Commit-规范"><a href="#Commit-规范" class="headerlink" title="Commit 规范"></a>Commit 规范</h2><p>使用 Conventional Commits:</p><ul><li><code>feat:</code> - 新功能</li><li><code>fix:</code> - Bug 修复</li><li><code>chore:</code> - 构建/工具变动</li><li><code>docs:</code> - 文档更新</li><li><code>refactor:</code> - 代码重构</li><li><code>test:</code> - 测试相关</li></ul><h2 id="工作流"><a href="#工作流" class="headerlink" title="工作流"></a>工作流</h2><h3 id="添加新组件"><a href="#添加新组件" class="headerlink" title="添加新组件"></a>添加新组件</h3><ol><li>创建组件文件 <code>src/components/ComponentName.tsx</code></li><li>创建测试文件 <code>src/components/__tests__/ComponentName.test.tsx</code></li><li>从 <code>src/components/index.ts</code> 导出</li></ol><h3 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="built_in">test</span></span><br><span class="line">npm run <span class="built_in">test</span>:coverage</span><br></pre></td></tr></table></figure><div class="tag link"><a class="link-card" title="Everything Claude Code" href="https://github.com/affaan-m/everything-claude-code"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Everything Claude Code</p><p class="url">https://github.com/affaan-m/everything-claude-code</p></div></a></div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">### 从 Git 历史提取 Skill</span><br><span class="line"></span><br><span class="line">使用 `/learn` 命令自动从项目 Git 历史提取编码模式:</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line"># 在项目根目录执行</span><br><span class="line">/learn</span><br></pre></td></tr></table></figure><p>Claude 会分析 commit 历史, 生成符合项目实际的 Skill 文件.</p><div class="note info flat"><p>P.S. 生成的 Skill 保存在 <code>~/.claude/skills/learned/</code> 目录.</p></div><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="Skill-设计原则"><a href="#Skill-设计原则" class="headerlink" title="Skill 设计原则"></a>Skill 设计原则</h3><div class="table-container"><table><thead><tr><th>原则</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>单一职责</td><td>每个 Skill 专注一个领域</td><td>分离 “git-workflow” 和 “testing”</td></tr><tr><td>明确触发</td><td>description 清晰说明使用场景</td><td>“当创建 PR 时使用”</td></tr><tr><td>渐进加载</td><td>核心指令在 SKILL.md, 详情在 references/</td><td>API 参考放 references/</td></tr><tr><td>版本管理</td><td>使用 version 追踪变更</td><td>从 1.0.0 → 1.1.0</td></tr></tbody></table></div><h3 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h3><ul><li>使用 kebab-case: <code>api-integration</code>, <code>git-workflow</code></li><li>描述性名称: <code>typescript-react-patterns</code> (而非 <code>ts-patterns</code>)</li><li>避免过宽的名称: 不要用 <code>helpers</code>, <code>utils</code></li></ul><h3 id="内容组织"><a href="#内容组织" class="headerlink" title="内容组织"></a>内容组织</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">name: skill-name</span><br><span class="line"><span class="section">description: 具体的使用场景描述</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section"># 标题</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 概述</span></span><br><span class="line">简短说明 (2-3 句话)</span><br><span class="line"></span><br><span class="line"><span class="section">## 前置条件</span></span><br><span class="line"><span class="bullet">-</span> 条件 1</span><br><span class="line"><span class="bullet">-</span> 条件 2</span><br><span class="line"></span><br><span class="line"><span class="section">## 步骤</span></span><br><span class="line"><span class="section">### 步骤 1: 标题</span></span><br><span class="line">具体操作...</span><br><span class="line"></span><br><span class="line"><span class="section">### 步骤 2: 标题</span></span><br><span class="line">具体操作...</span><br><span class="line"></span><br><span class="line"><span class="section">## 注意事项</span></span><br><span class="line">重要提示...</span><br><span class="line"></span><br><span class="line"><span class="section">## 故障排查</span></span><br><span class="line">常见问题及解决方案</span><br></pre></td></tr></table></figure><h2 id="在其它-IDE-中使用"><a href="#在其它-IDE-中使用" class="headerlink" title="在其它 IDE 中使用"></a>在其它 IDE 中使用</h2><h3 id="CodeX"><a href="#CodeX" class="headerlink" title="CodeX"></a>CodeX</h3><p><strong>步骤 1</strong>: 编辑 <code>~/.codex/config.toml</code>:</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[features]</span></span><br><span class="line"><span class="attr">skills</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><strong>步骤 2</strong>: 将 <code>.claude</code> 目录重命名为 <code>.codex</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> .claude .codex</span><br></pre></td></tr></table></figure><a class="btn-beautify purple" href="https://codex.so/docs" title="CodeX Documentation"><i class="fa-solid fa-book"></i><span>CodeX Documentation</span></a><h3 id="Cursor"><a href="#Cursor" class="headerlink" title="Cursor"></a>Cursor</h3><div class="note success flat"><p>Cursor 原生支持 Claude Code Skills, 无需额外配置.</p></div><h3 id="Windsurf"><a href="#Windsurf" class="headerlink" title="Windsurf"></a>Windsurf</h3><p>Windsurf 支持 Skills, 需要配置 <code>.windsor/skills/</code> 目录.</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="Q1-Skill-没有被加载"><a href="#Q1-Skill-没有被加载" class="headerlink" title="Q1: Skill 没有被加载?"></a>Q1: Skill 没有被加载?</h3><p><strong>检查清单</strong>:</p><ul><li>[ ] SKILL.md 是否有正确的 YAML frontmatter</li><li>[ ] skill 目录是否在 <code>.claude/skills/</code> 下</li><li>[ ] description 是否清晰描述使用场景</li></ul><p><strong>调试方法</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看已加载的 skills</span></span><br><span class="line">claude --list-skills</span><br></pre></td></tr></table></figure><h3 id="Q2-如何测试-Skill"><a href="#Q2-如何测试-Skill" class="headerlink" title="Q2: 如何测试 Skill?"></a>Q2: 如何测试 Skill?</h3><p>在项目目录下, 直接向 Claude 提出相关请求, 观察是否使用了 Skill:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">claude</span><br><span class="line">&gt; 请按照我们的代码规范创建一个新组件</span><br></pre></td></tr></table></figure><h3 id="Q3-资源文件如何被引用"><a href="#Q3-资源文件如何被引用" class="headerlink" title="Q3: 资源文件如何被引用?"></a>Q3: 资源文件如何被引用?</h3><p>在 SKILL.md 中使用相对路径引用:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## 示例代码</span></span><br><span class="line"></span><br><span class="line">参见 @scripts/example.js</span><br><span class="line"></span><br><span class="line"><span class="section">## API 参考</span></span><br><span class="line"></span><br><span class="line">详见 @references/api-guide.md</span><br></pre></td></tr></table></figure><h3 id="Q4-如何分享-Skills"><a href="#Q4-如何分享-Skills" class="headerlink" title="Q4: 如何分享 Skills?"></a>Q4: 如何分享 Skills?</h3><ol><li>将 skill 目录发布到 GitHub</li><li>提交到 Awesome Claude Skills</li><li>其他人可以克隆到 <code>.claude/skills/</code> 目录</li></ol><a class="btn-beautify green" href="https://github.com/ComposioHQ/awesome-claude-skills" title="Awesome Claude Skills"><i class="fa-brands fa-github"></i><span>Awesome Claude Skills</span></a><h3 id="Q5-Skill-与-MCP-的区别"><a href="#Q5-Skill-与-MCP-的区别" class="headerlink" title="Q5: Skill 与 MCP 的区别?"></a>Q5: Skill 与 MCP 的区别?</h3><div class="table-container"><table><thead><tr><th>特性</th><th>Skills</th><th>MCP</th></tr></thead><tbody><tr><td>用途</td><td>指令和最佳实践</td><td>扩展工具能力</td></tr><tr><td>加载</td><td>渐进式按需加载</td><td>服务常驻</td></tr><tr><td>Token 消耗</td><td>低 (仅加载元数据)</td><td>高 (完整工具定义)</td></tr><tr><td>适用场景</td><td>编码规范, 工作流</td><td>API 调用, 数据库操作</td></tr></tbody></table></div><div class="note primary flat"><p>P.S. Skills 和 MCP 可以配合使用: Skills 提供指导, MCP 提供工具能力.</p></div><h2 id="Skills-生态"><a href="#Skills-生态" class="headerlink" title="Skills 生态"></a>Skills 生态</h2><h3 id="社区资源"><a href="#社区资源" class="headerlink" title="社区资源"></a>社区资源</h3><div class="tag link"><a class="link-card" title="Awesome Claude Skills" href="https://github.com/ComposioHQ/awesome-claude-skills"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Awesome Claude Skills</p><p class="url">https://github.com/ComposioHQ/awesome-claude-skills</p></div></a></div><div class="tag link"><a class="link-card" title="Everything Claude Code" href="https://github.com/affaan-m/everything-claude-code"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Everything Claude Code</p><p class="url">https://github.com/affaan-m/everything-claude-code</p></div></a></div><div class="tag link"><a class="link-card" title="Claude Code" href="https://github.com/anthropics/claude-code"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Claude Code</p><p class="url">https://github.com/anthropics/claude-code</p></div></a></div><h3 id="安全注意事项"><a href="#安全注意事项" class="headerlink" title="安全注意事项"></a>安全注意事项</h3><details class="folding-tag" red><summary> ⚠️ 风险评估 </summary>              <div class='content'>              <ul><li>Skills 可以执行系统命令 (通过 scripts/)</li><li>可能访问敏感文件 (通过 assets/)</li><li>建议审查社区分享的 Skills</li></ul>              </div>            </details><details class="folding-tag" green><summary> ✅ 最佳实践 </summary>              <div class='content'>              <ol><li>仅从可信来源获取 Skills</li><li>审查 SKILL.md 和 scripts/ 内容</li><li>使用沙箱环境测试新 Skills</li><li>定期更新已安装的 Skills</li></ol>              </div>            </details><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><a class="btn-beautify blue" href="https://github.com/anthropics/claude-code" title="Claude Code Official Documentation"><i class="fa-brands fa-github"></i><span>Claude Code Official Documentation</span></a><a class="btn-beautify purple" href="https://github.com/affaan-m/everything-claude-code" title="Everything Claude Code"><i class="fa-brands fa-github"></i><span>Everything Claude Code</span></a><a class="btn-beautify green" href="https://github.com/ComposioHQ/awesome-claude-skills" title="Awesome Claude Skills"><i class="fa-brands fa-github"></i><span>Awesome Claude Skills</span></a><a class="btn-beautify orange" href="https://open.bigmodel.cn/dev/api" title="智谱 AI API 文档"><i class="fa-solid fa-book"></i><span>智谱 AI API 文档</span></a>]]></content>
      
      
      <categories>
          
          <category> AI开发 </category>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Claude-Code </tag>
            
            <tag> Skills </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 现代化开发工具链指南</title>
      <link href="/posts/7af74e55/"/>
      <url>/posts/7af74e55/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>本文档介绍构建现代化 Python 开发环境的核心工具链，涵盖从包管理、代码质量检查到类型检测的完整工作流。这些工具能够显著提升开发效率、代码质量和团队协作体验。</p><div class="note success flat"><p><strong>核心工具</strong>:</p><ul><li><strong>uv</strong>: 极速 Python 包管理器，替代 pip 和 pip-tools</li><li><strong>Ruff</strong>: 用 Rust 编写的 Linter 和 Formatter，替代 Flake8/Black/isort</li><li><strong>Pyright</strong>: 微软开发的静态类型检查器，比 mypy 更快更强</li><li><strong>pre-commit</strong>: Git 钩子管理框架，自动化代码质量检查</li><li><strong>rich</strong>: 终端美化库，让 CLI 应用更加专业</li></ul></div><h2 id="IDE-配置"><a href="#IDE-配置" class="headerlink" title="IDE 配置"></a>IDE 配置</h2><h3 id="VSCode-及插件推荐"><a href="#VSCode-及插件推荐" class="headerlink" title="VSCode 及插件推荐"></a>VSCode 及插件推荐</h3><a class="btn-beautify outline blue" href="https://code.visualstudio.com/" title="VSCode 下载"><i class="fab fa-windows"></i><span>VSCode 下载</span></a><p><strong>推荐插件</strong>:</p><ul><li>Chinese (中文语言包)</li><li>Dracula Official (主题)</li><li>Material Icon Theme (图标)</li><li>Path Intellisense (路径自动补全)</li><li>Prettier (代码格式化)</li><li>Python (Microsoft 官方)</li><li>Python Debugger (调试器)</li></ul><div class="note warning flat"><p><strong>配置建议</strong>: 取消 “Auto Save” 选项，避免意外保存</p></div><h2 id="包管理：uv"><a href="#包管理：uv" class="headerlink" title="包管理：uv"></a>包管理：uv</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><code>uv</code> 是由 Astral 公司（Ruff 的开发者）推出的<strong>极速 Python 包管理器</strong>，用 Rust 编写，旨在替代 pip、pip-tools、pipx 等传统工具。</p><details class="folding-tag" green><summary> ⚡ uv 核心优势 </summary>              <div class='content'>              <ul><li><strong>极致速度</strong>: 比 pip 快 10-100 倍</li><li><strong>统一工具链</strong>: 整合 venv、pip、pip-tools、pipx 功能</li><li><strong>全局缓存</strong>: 所有项目共享，避免重复下载</li><li><strong>高性能解析器</strong>: 并行获取元数据，快速解决依赖冲突</li></ul>              </div>            </details><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS / Linux</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fas fa-box"></i>pip</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -LsSf https://astral.sh/uv/install.sh | sh</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="literal">-c</span> <span class="string">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install uv</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h3><div class="table-container"><table><thead><tr><th>操作</th><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>创建虚拟环境</td><td><code>uv venv</code></td><td>在当前目录创建 .venv</td></tr><tr><td>指定 Python 版本</td><td><code>uv venv -p 3.11</code></td><td>使用特定版本创建环境</td></tr><tr><td>激活环境</td><td><code>source .venv/bin/activate</code></td><td>macOS/Linux (Windows: <code>.venv\Scripts\activate</code>)</td></tr><tr><td>初始化项目</td><td><code>uv init</code></td><td>创建 pyproject.toml</td></tr><tr><td>安装包</td><td><code>uv pip install &lt;package&gt;</code></td><td>安装到当前环境</td></tr><tr><td>添加项目依赖</td><td><code>uv add &lt;package&gt;</code></td><td>添加到 pyproject.toml</td></tr><tr><td>同步环境</td><td><code>uv sync</code></td><td>根据 lock 文件安装依赖</td></tr><tr><td>生成依赖文件</td><td><code>uv pip freeze &gt; requirements.txt</code></td><td>导出精确版本列表</td></tr><tr><td>锁定依赖</td><td><code>uv pip compile requirements.in -o requirements.txt</code></td><td>生成锁定文件</td></tr><tr><td>运行命令</td><td><code>uv run &lt;command&gt;</code></td><td>自动激活环境并运行</td></tr><tr><td>安装全局工具</td><td><code>uv tool install &lt;package&gt;</code></td><td>替代 pipx</td></tr></tbody></table></div><h3 id="项目配置示例"><a href="#项目配置示例" class="headerlink" title="项目配置示例"></a>项目配置示例</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fas fa-file-code"></i>pyproject.toml</button><button type="button" class="tab"><i class="fas fa-terminal"></i>使用流程</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[project]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;my-project&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line"><span class="attr">description</span> = <span class="string">&quot;A modern Python project&quot;</span></span><br><span class="line"><span class="attr">requires-python</span> = <span class="string">&quot;&gt;=3.10&quot;</span></span><br><span class="line"><span class="attr">dependencies</span> = [</span><br><span class="line">    <span class="string">&quot;httpx&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rich&gt;=13.0.0&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[project.optional-dependencies]</span></span><br><span class="line"><span class="attr">dev</span> = [</span><br><span class="line">    <span class="string">&quot;pytest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ruff&quot;</span>,</span><br><span class="line">    <span class="string">&quot;pyright&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建项目</span></span><br><span class="line"><span class="built_in">mkdir</span> my-project &amp;&amp; <span class="built_in">cd</span> my-project</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 初始化 uv 项目</span></span><br><span class="line">uv init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 创建虚拟环境</span></span><br><span class="line">uv venv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 激活环境</span></span><br><span class="line"><span class="built_in">source</span> .venv/bin/activate  <span class="comment"># Windows: .venv\Scripts\activate</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 添加依赖</span></span><br><span class="line">uv add httpx rich</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 添加开发依赖</span></span><br><span class="line">uv add --dev pytest ruff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 同步环境 (团队成员使用)</span></span><br><span class="line">uv <span class="built_in">sync</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="进阶功能"><a href="#进阶功能" class="headerlink" title="进阶功能"></a>进阶功能</h3><details class="folding-tag" yellow><summary> 🔧 依赖锁定 </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从 requirements.in 生成锁定文件</span></span><br><span class="line">uv pip compile requirements.in -o requirements.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据锁定文件同步环境</span></span><br><span class="line">uv pip <span class="built_in">sync</span> requirements.txt</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> 🔧 全局工具管理 </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装全局工具</span></span><br><span class="line">uv tool install ruff</span><br><span class="line">uv tool install black --python 3.11</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出已安装工具</span></span><br><span class="line">uv tool list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行工具</span></span><br><span class="line">uv tool run ruff check .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卸载工具</span></span><br><span class="line">uv tool uninstall ruff</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="uv-vs-conda-对比"><a href="#uv-vs-conda-对比" class="headerlink" title="uv vs conda 对比"></a>uv vs conda 对比</h3><div class="table-container"><table><thead><tr><th>特性</th><th>uv</th><th>conda</th></tr></thead><tbody><tr><td>速度</td><td>极快</td><td>慢</td></tr><tr><td>生态</td><td>PyPI (Python 优先)</td><td>conda-forge (跨语言)</td></tr><tr><td>非 Python 依赖</td><td>不支持</td><td>原生支持</td></tr><tr><td>CUDA/MKL 优化</td><td>依赖系统</td><td>内置支持</td></tr><tr><td>适用场景</td><td>大多数 Python 项目</td><td>科学计算重依赖项目</td></tr></tbody></table></div><div class="note info flat"><p><strong>趋势</strong>: 随着 uv、pixi 等工具的出现，纯 Python 项目正在快速转向 uv，而 conda 仍主导需要非 Python 依赖的科学计算场景。</p></div><h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><details class="folding-tag" green><summary> ✅ 最佳实践 </summary>              <div class='content'>              <ol><li><strong>声明式依赖管理</strong>: 在 <code>pyproject.toml</code> 中声明直接依赖</li><li><strong>锁定依赖版本</strong>: 使用 <code>uv pip compile</code> 生成锁定文件</li><li><strong>环境同步</strong>: 使用 <code>uv sync</code> 确保环境一致性</li><li><strong>团队协作</strong>: 将 <code>requirements.txt</code> 或 <code>uv.lock</code> 提交到 Git</li><li><strong>避免提交虚拟环境</strong>: 将 <code>.venv</code> 加入 <code>.gitignore</code></li></ol>              </div>            </details><h2 id="代码质量：Ruff"><a href="#代码质量：Ruff" class="headerlink" title="代码质量：Ruff"></a>代码质量：Ruff</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p><strong>Ruff</strong> 是一个用 Rust 编写的<strong>极速 Python Linter 和 Formatter</strong>，旨在替代 Flake8、Black、isort、pyupgrade 等一众传统工具。</p><details class="folding-tag" blue><summary> ⚡ Ruff 核心特点 </summary>              <div class='content'>              <ul><li><strong>极致性能</strong>: 比传统工具快 10-100 倍</li><li><strong>一体化</strong>: 整合 Linting、Formatting、Import Sorting、语法升级</li><li><strong>自动修复</strong>: 大量规则支持 <code>--fix</code> 自动修复</li><li><strong>兼容性</strong>: 规则代码与传统工具保持一致，方便迁移</li></ul>              </div>            </details><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 pip</span></span><br><span class="line">pip install ruff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 uv</span></span><br><span class="line">uv pip install ruff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 uv 作为全局工具</span></span><br><span class="line">uv tool install ruff</span><br></pre></td></tr></table></figure><h3 id="常用操作-1"><a href="#常用操作-1" class="headerlink" title="常用操作"></a>常用操作</h3><div class="table-container"><table><thead><tr><th>任务</th><th>命令</th></tr></thead><tbody><tr><td>格式化代码</td><td><code>ruff format .</code></td></tr><tr><td>检查并自动修复</td><td><code>ruff check . --fix</code></td></tr><tr><td>仅检查不修改</td><td><code>ruff check .</code></td></tr><tr><td>格式化检查 (CI)</td><td><code>ruff format . --check</code></td></tr><tr><td>查看规则说明</td><td><code>ruff rule &lt;RULE_CODE&gt;</code></td></tr><tr><td>清理缓存</td><td><code>ruff cache clean</code></td></tr><tr><td>终极清理</td><td><code>ruff format . &amp;&amp; ruff check . --fix</code></td></tr></tbody></table></div><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[tool.ruff]</span></span><br><span class="line"><span class="comment"># 目标 Python 版本</span></span><br><span class="line"><span class="attr">target-version</span> = <span class="string">&quot;py310&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 行长</span></span><br><span class="line"><span class="attr">line-length</span> = <span class="number">88</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用预览功能 (类型感知 lint、新规则)</span></span><br><span class="line"><span class="attr">preview</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动修复 (不包含可能改变语义的修复)</span></span><br><span class="line"><span class="attr">fix</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">unsafe-fixes</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略的路径</span></span><br><span class="line"><span class="attr">extend-exclude</span> = [</span><br><span class="line">    <span class="string">&quot;.git&quot;</span>,</span><br><span class="line">    <span class="string">&quot;__pycache__&quot;</span>,</span><br><span class="line">    <span class="string">&quot;venv&quot;</span>,</span><br><span class="line">    <span class="string">&quot;.venv&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dist&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[tool.ruff.lint]</span></span><br><span class="line"><span class="comment"># 启用的规则集</span></span><br><span class="line"><span class="attr">select</span> = [</span><br><span class="line">    <span class="string">&quot;E&quot;</span>,   <span class="comment"># pycodestyle 错误</span></span><br><span class="line">    <span class="string">&quot;W&quot;</span>,   <span class="comment"># pycodestyle 警告</span></span><br><span class="line">    <span class="string">&quot;F&quot;</span>,   <span class="comment"># pyflakes</span></span><br><span class="line">    <span class="string">&quot;I&quot;</span>,   <span class="comment"># isort</span></span><br><span class="line">    <span class="string">&quot;UP&quot;</span>,  <span class="comment"># pyupgrade</span></span><br><span class="line">    <span class="string">&quot;C4&quot;</span>,  <span class="comment"># comprehensions</span></span><br><span class="line">    <span class="string">&quot;TID&quot;</span>, <span class="comment"># tidy imports</span></span><br><span class="line">    <span class="string">&quot;ARG&quot;</span>, <span class="comment"># unused args</span></span><br><span class="line">    <span class="string">&quot;PTH&quot;</span>, <span class="comment"># pathlib over os.path</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略的规则</span></span><br><span class="line"><span class="attr">ignore</span> = [</span><br><span class="line">    <span class="string">&quot;E501&quot;</span>,  <span class="comment"># 行长交给 formatter 处理</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每文件忽略规则</span></span><br><span class="line"><span class="section">[[tool.ruff.lint.per-file-ignores]]</span></span><br><span class="line"><span class="attr">&quot;tests/**.py&quot;</span> = [<span class="string">&quot;S101&quot;</span>, <span class="string">&quot;ARG&quot;</span>]  <span class="comment"># 允许 assert、忽略未使用参数</span></span><br><span class="line"><span class="attr">&quot;scripts/*.py&quot;</span> = [<span class="string">&quot;T20&quot;</span>]         <span class="comment"># 允许 print</span></span><br><span class="line"></span><br><span class="line"><span class="section">[tool.ruff.lint.isort]</span></span><br><span class="line"><span class="attr">known-first-party</span> = [<span class="string">&quot;my_project&quot;</span>]</span><br><span class="line"><span class="attr">combine-as-imports</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">force-sort-within-sections</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[tool.ruff.format]</span></span><br><span class="line"><span class="comment"># 使用单引号</span></span><br><span class="line"><span class="attr">quote-style</span> = <span class="string">&quot;single&quot;</span></span><br><span class="line"><span class="comment"># 缩进宽度</span></span><br><span class="line"><span class="attr">indent-width</span> = <span class="number">4</span></span><br><span class="line"><span class="comment"># 行长与 lint 一致</span></span><br><span class="line"><span class="attr">line-length</span> = <span class="number">88</span></span><br></pre></td></tr></table></figure><h3 id="规则集说明"><a href="#规则集说明" class="headerlink" title="规则集说明"></a>规则集说明</h3><p>Ruff 使用规则代码前缀来分类规则，兼容传统工具：</p><ul><li><strong>E/W</strong>: pycodestyle (代码风格)</li><li><strong>F</strong>: pyflakes (逻辑错误)</li><li><strong>I</strong>: isort (导入排序)</li><li><strong>UP</strong>: pyupgrade (语法升级)</li><li><strong>D</strong>: pydocstyle (文档字符串)</li><li><strong>N</strong>: pep8-naming (命名规范)</li><li><strong>PTH</strong>: 使用 pathlib 替代 os.path</li><li><strong>PL</strong>: pylint 子集</li><li><strong>RUF</strong>: Ruff 特定规则</li></ul><h3 id="进阶功能-1"><a href="#进阶功能-1" class="headerlink" title="进阶功能"></a>进阶功能</h3><details class="folding-tag" cyan><summary> 🔍 预览模式 </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令行启用</span></span><br><span class="line">ruff check --preview .</span><br><span class="line">ruff format --preview .</span><br></pre></td></tr></table></figure><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件启用</span></span><br><span class="line"><span class="section">[tool.ruff]</span></span><br><span class="line"><span class="attr">preview</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 🔍 类型感知 Lint </summary>              <div class='content'>              <p>Ruff 在预览模式下支持轻量级类型推断：</p><ul><li><strong>RUF014</strong>: 冗余的 <code>isinstance(x, str)</code> (当 <code>x: str</code> 已知)</li><li><strong>RUF015</strong>: 无效的 <code>assert isinstance(...)</code> (类型已确定)</li></ul><div class="note warning flat"><p><strong>注意</strong>: Ruff 不替代 mypy/Pyright，仅用类型信息增强 lint 规则。建议搭配 Pyright 做完整类型检查。</p></div>              </div>            </details><details class="folding-tag" cyan><summary> 🔍 细粒度控制 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 行内忽略</span></span><br><span class="line">x = <span class="number">1</span>  <span class="comment"># noqa: E741</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;debug&quot;</span>)  <span class="comment"># noqa: T201, T203</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件级忽略</span></span><br><span class="line">[[tool.ruff.lint.per-file-ignores]]</span><br><span class="line"><span class="string">&quot;tests/**.py&quot;</span> = [<span class="string">&quot;S101&quot;</span>, <span class="string">&quot;D&quot;</span>]</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 🔍 VS Code 集成 </summary>              <div class='content'>              <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;python.linting.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ruff.enable&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ruff.args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;--preview&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;[python]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;charliermarsh.ruff&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="最佳实践-1"><a href="#最佳实践-1" class="headerlink" title="最佳实践"></a>最佳实践</h3><details class="folding-tag" green><summary> ✅ 最佳实践 </summary>              <div class='content'>              <ol><li><strong>统一配置</strong>: 将所有配置集中在 <code>pyproject.toml</code></li><li><strong>明确目标版本</strong>: 设置 <code>target-version</code> 避免不必要的规则</li><li><strong>稳健起步</strong>: 从 <code>E</code>, <code>F</code>, <code>I</code>, <code>UP</code> 规则集开始</li><li><strong>拥抱自动修复</strong>: 将 <code>ruff check . --fix</code> 作为常规操作</li><li><strong>CI/CD 集成</strong>: 使用 <code>ruff check --output-format=github</code></li></ol>              </div>            </details><p><strong>e.g. GitHub Actions 示例</strong>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">Ruff</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    ruff check . --output-format=github</span></span><br><span class="line"><span class="string">    ruff format . --check</span></span><br></pre></td></tr></table></figure><h2 id="类型检查：Pyright"><a href="#类型检查：Pyright" class="headerlink" title="类型检查：Pyright"></a>类型检查：Pyright</h2><h3 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h3><p><strong>Pyright</strong> 是由微软开发的<strong>静态类型检查器</strong>，用 TypeScript 编写，集成在 VS Code 的 Pylance 插件中。</p><details class="folding-tag" purple><summary> 🎯 Pyright 核心优势 </summary>              <div class='content'>              <ul><li><strong>极快速度</strong>: 增量分析比 mypy 快数倍</li><li><strong>智能推断</strong>: 能根据上下文自动推导类型</li><li><strong>strict mode</strong>: 强制类型标注，避免漏网之鱼</li><li><strong>跨平台</strong>: 支持 CLI 和 VS Code 集成</li></ul>              </div>            </details><h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-npm"></i>npm (推荐)</button><button type="button" class="tab"><i class="fas fa-box"></i>pip</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g pyright</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyright</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="配置文件-1"><a href="#配置文件-1" class="headerlink" title="配置文件"></a>配置文件</h3><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[tool.pyright]</span></span><br><span class="line"><span class="attr">typeCheckingMode</span> = <span class="string">&quot;strict&quot;</span></span><br><span class="line"><span class="attr">pythonVersion</span> = <span class="string">&quot;3.10&quot;</span></span><br><span class="line"><span class="attr">include</span> = [<span class="string">&quot;src&quot;</span>, <span class="string">&quot;tests&quot;</span>]</span><br><span class="line"><span class="attr">exclude</span> = [</span><br><span class="line">    <span class="string">&quot;**/node_modules&quot;</span>,</span><br><span class="line">    <span class="string">&quot;**/__pycache__&quot;</span>,</span><br><span class="line">    <span class="string">&quot;.venv&quot;</span>,</span><br><span class="line">    <span class="string">&quot;venv&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dist&quot;</span>,</span><br><span class="line">]</span><br><span class="line"><span class="attr">reportMissingTypeStubs</span> = <span class="string">&quot;none&quot;</span></span><br><span class="line"><span class="attr">reportUnusedImport</span> = <span class="string">&quot;warning&quot;</span></span><br><span class="line"><span class="attr">reportUnusedVariable</span> = <span class="string">&quot;warning&quot;</span></span><br></pre></td></tr></table></figure><p><strong>pyrightconfig.json</strong> (备选):</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;tests&quot;</span><span class="punctuation">,</span> <span class="string">&quot;build&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typeCheckingMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;strict&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pythonVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.10&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="类型检查模式"><a href="#类型检查模式" class="headerlink" title="类型检查模式"></a>类型检查模式</h3><div class="table-container"><table><thead><tr><th>模式</th><th>说明</th></tr></thead><tbody><tr><td><strong>off</strong></td><td>禁用类型检查</td></tr><tr><td><strong>basic</strong></td><td>最基本的检查</td></tr><tr><td><strong>standard</strong></td><td>标准检查 (默认)</td></tr><tr><td><strong>strict</strong></td><td>严格模式，推荐使用</td></tr></tbody></table></div><h3 id="文件级指令"><a href="#文件级指令" class="headerlink" title="文件级指令"></a>文件级指令</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用严格模式</span></span><br><span class="line"><span class="comment"># pyright: strict</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用基本模式</span></span><br><span class="line"><span class="comment"># pyright: basic</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 覆盖特定规则</span></span><br><span class="line"><span class="comment"># pyright: strict, reportPrivateUsage=false, reportUnusedVariable=warning</span></span><br></pre></td></tr></table></figure><h3 id="常用操作-2"><a href="#常用操作-2" class="headerlink" title="常用操作"></a>常用操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查项目</span></span><br><span class="line">pyright .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查特定文件</span></span><br><span class="line">pyright src/main.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出详细日志</span></span><br><span class="line">pyright . --verbose</span><br></pre></td></tr></table></figure><h3 id="Pyright-vs-mypy"><a href="#Pyright-vs-mypy" class="headerlink" title="Pyright vs mypy"></a>Pyright vs mypy</h3><div class="table-container"><table><thead><tr><th>特性</th><th>Pyright</th><th>mypy</th></tr></thead><tbody><tr><td>性能</td><td>极快</td><td>慢</td></tr><tr><td>IDE 集成</td><td>VS Code/Pylance 完美</td><td>PyCharm 较好</td></tr><tr><td>类型推断</td><td>更智能</td><td>依赖显式注解</td></tr><tr><td>社区生态</td><td>新但发展快</td><td>历史悠久、兼容性好</td></tr><tr><td>配置</td><td>简单</td><td>灵活但复杂</td></tr></tbody></table></div><h3 id="最佳实践-2"><a href="#最佳实践-2" class="headerlink" title="最佳实践"></a>最佳实践</h3><details class="folding-tag" green><summary> ✅ 最佳实践 </summary>              <div class='content'>              <ol><li><strong>使用 strict mode</strong>: 强制完整的类型标注</li><li><strong>配合 VS Code</strong>: 安装 Pylance 插件获得实时反馈</li><li><strong>忽略不必要的警告</strong>: 使用 <code># type: ignore</code> 或配置文件</li><li><strong>CI/CD 集成</strong>: 在 CI 中运行 <code>pyright</code> 确保代码质量</li></ol>              </div>            </details><h2 id="Git-钩子：pre-commit"><a href="#Git-钩子：pre-commit" class="headerlink" title="Git 钩子：pre-commit"></a>Git 钩子：pre-commit</h2><h3 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h3><p><strong>pre-commit</strong> 是一个<strong>多语言 Git 钩子管理框架</strong>，它能够在代码提交前自动运行各种检查（Linting、Formatting、安全扫描等）。</p><details class="folding-tag" orange><summary> 🛡️ pre-commit 核心优势 </summary>              <div class='content'>              <ul><li><strong>自动化质量保障</strong>: 无需手动运行检查工具</li><li><strong>团队一致性</strong>: 所有开发者使用相同版本的工具</li><li><strong>提前发现问题</strong>: 在代码进入仓库前拦截问题</li><li><strong>简化配置</strong>: 新成员只需运行 <code>pre-commit install</code></li></ul>              </div>            </details><h3 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 pip</span></span><br><span class="line">pip install pre-commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 uv</span></span><br><span class="line">uv pip install pre-commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 uv 作为全局工具</span></span><br><span class="line">uv tool install pre-commit</span><br></pre></td></tr></table></figure><h3 id="配置文件-2"><a href="#配置文件-2" class="headerlink" title="配置文件"></a>配置文件</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最小 pre-commit 版本要求</span></span><br><span class="line"><span class="attr">minimum_pre_commit_version:</span> <span class="string">&#x27;2.9.0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">repos:</span></span><br><span class="line">  <span class="comment"># 通用钩子</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">https://github.com/pre-commit/pre-commit-hooks</span></span><br><span class="line">    <span class="attr">rev:</span> <span class="string">v4.6.0</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">trailing-whitespace</span>     <span class="comment"># 移除行尾空格</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">end-of-file-fixer</span>       <span class="comment"># 文件末尾添加空行</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-yaml</span>              <span class="comment"># 检查 YAML 语法</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-json</span>              <span class="comment"># 检查 JSON 语法</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-toml</span>              <span class="comment"># 检查 TOML 语法</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-added-large-files</span> <span class="comment"># 防止提交大文件</span></span><br><span class="line">        <span class="attr">args:</span> [<span class="string">&#x27;--maxkb=5120&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Ruff (Lint + Format)</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">https://github.com/astral-sh/ruff-pre-commit</span></span><br><span class="line">    <span class="attr">rev:</span> <span class="string">v0.5.0</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff</span></span><br><span class="line">        <span class="attr">args:</span> [<span class="string">--fix</span>]</span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff-format</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 密钥泄露检测</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">https://github.com/trufflesecurity/trufflehog</span></span><br><span class="line">    <span class="attr">rev:</span> <span class="string">v3.77.1</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">trufflehog</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">TruffleHog</span> <span class="bullet">-</span> <span class="string">Scan</span> <span class="string">for</span> <span class="string">secrets</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 本地钩子 (pyright)</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">local</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pyright</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">pyright</span></span><br><span class="line">        <span class="attr">entry:</span> <span class="string">pyright</span> <span class="string">.</span></span><br><span class="line">        <span class="attr">language:</span> <span class="string">system</span></span><br><span class="line">        <span class="attr">types:</span> [<span class="string">python</span>]</span><br><span class="line">        <span class="attr">require_serial:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="常用操作-3"><a href="#常用操作-3" class="headerlink" title="常用操作"></a>常用操作</h3><div class="table-container"><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>安装钩子</td><td><code>pre-commit install</code></td></tr><tr><td>手动运行所有文件</td><td><code>pre-commit run --all-files</code></td></tr><tr><td>手动运行暂存文件</td><td><code>pre-commit run</code></td></tr><tr><td>更新工具版本</td><td><code>pre-commit autoupdate</code></td></tr><tr><td>清理缓存</td><td><code>pre-commit clean</code></td></tr><tr><td>跳过检查 (谨慎)</td><td><code>git commit --no-verify</code></td></tr></tbody></table></div><h3 id="hooks-配置详解"><a href="#hooks-配置详解" class="headerlink" title="hooks 配置详解"></a>hooks 配置详解</h3><p><strong>必需字段</strong>:</p><ul><li><code>repo</code>: 钩子仓库地址</li><li><code>rev</code>: 固定版本号 (避免使用分支名)</li><li><code>hooks</code>: 启用的钩子列表</li></ul><p><strong>可选字段</strong>:</p><ul><li><code>args</code>: 传递给钩子的参数</li><li><code>files</code>: 正则表达式，筛选文件</li><li><code>exclude</code>: 正则表达式，排除文件</li><li><code>types</code>: 文件类型列表 (python, yaml, json 等)</li><li><code>name</code>: 覆盖默认显示名称</li><li><code>stages</code>: Git 阶段 (commit, push, merge-commit)</li></ul><p><strong>e.g. 排除自动生成的文件</strong>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="string">^(auto_generated/|migrations/).*\.py$</span></span><br></pre></td></tr></table></figure><h3 id="本地钩子"><a href="#本地钩子" class="headerlink" title="本地钩子"></a>本地钩子</h3><p>对于需要访问项目依赖的工具 (如 pyright)，使用 <code>repo: local</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">hooks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pyright</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">pyright</span></span><br><span class="line">      <span class="attr">entry:</span> <span class="string">pyright</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">system</span></span><br><span class="line">      <span class="attr">types:</span> [<span class="string">python</span>]</span><br><span class="line">      <span class="attr">require_serial:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><div class="note info flat"><p><strong>提示</strong>: <code>language: system</code> 告诉 pre-commit 使用当前虚拟环境，而不是创建隔离环境。</p></div><h3 id="最佳实践-3"><a href="#最佳实践-3" class="headerlink" title="最佳实践"></a>最佳实践</h3><details class="folding-tag" green><summary> ✅ 最佳实践 </summary>              <div class='content'>              <ol><li><strong>固定版本号</strong>: 使用 <code>v1.2.3</code> 而非 <code>main</code></li><li><strong>提交配置文件</strong>: 将 <code>.pre-commit-config.yaml</code> 加入 Git</li><li><strong>CI/CD 集成</strong>: 使用 <code>pre-commit run --all-files</code></li><li><strong>谨慎跳过</strong>: <code>--no-verify</code> 仅用于紧急情况</li><li><strong>定期更新</strong>: 运行 <code>pre-commit autoupdate</code> 保持工具最新</li></ol>              </div>            </details><h2 id="终端美化：rich"><a href="#终端美化：rich" class="headerlink" title="终端美化：rich"></a>终端美化：rich</h2><h3 id="简介-4"><a href="#简介-4" class="headerlink" title="简介"></a>简介</h3><p><strong>rich</strong> 是一个用于在终端中创建<strong>富文本和精美格式化输出</strong>的 Python 库。</p><details class="folding-tag" pink><summary> 🎨 rich 核心特点 </summary>              <div class='content'>              <ul><li><strong>易用性</strong>: API 设计直观 Pythonic</li><li><strong>功能强大</strong>: 颜色、样式、表格、进度条、Markdown、语法高亮</li><li><strong>跨平台</strong>: 在 Windows/macOS/Linux 上表现良好</li><li><strong>自动化</strong>: 智能处理终端宽度和文本溢出</li></ul>              </div>            </details><h3 id="安装-4"><a href="#安装-4" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 pip</span></span><br><span class="line">pip install rich</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 uv</span></span><br><span class="line">uv pip install rich</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加到项目依赖</span></span><br><span class="line">uv add rich</span><br></pre></td></tr></table></figure><h3 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h3><details class="folding-tag" cyan><summary> 1. Console 对象与 print </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rich.console <span class="keyword">import</span> Console</span><br><span class="line"></span><br><span class="line">console = Console()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 彩色文本</span></span><br><span class="line">console.<span class="built_in">print</span>(<span class="string">&quot;[bold red]Hello[/bold red], World!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 样式标记</span></span><br><span class="line">console.<span class="built_in">print</span>(</span><br><span class="line">    <span class="string">&quot;[italic yellow]Warning:[/italic yellow] &quot;</span></span><br><span class="line">    <span class="string">&quot;This is a [underline]warning[/underline] message.&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 2. 表格 (Table) </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rich.console <span class="keyword">import</span> Console</span><br><span class="line"><span class="keyword">from</span> rich.table <span class="keyword">import</span> Table</span><br><span class="line"></span><br><span class="line">console = Console()</span><br><span class="line"></span><br><span class="line">table = Table(title=<span class="string">&quot;Star Wars Movies&quot;</span>)</span><br><span class="line"></span><br><span class="line">table.add_column(<span class="string">&quot;Date&quot;</span>, style=<span class="string">&quot;dim&quot;</span>, width=<span class="number">12</span>)</span><br><span class="line">table.add_column(<span class="string">&quot;Title&quot;</span>)</span><br><span class="line">table.add_column(<span class="string">&quot;Box Office&quot;</span>, justify=<span class="string">&quot;right&quot;</span>)</span><br><span class="line"></span><br><span class="line">table.add_row(<span class="string">&quot;Dec 20, 2019&quot;</span>, <span class="string">&quot;Star Wars: The Rise of Skywalker&quot;</span>, <span class="string">&quot;$1,332,539,889&quot;</span>)</span><br><span class="line">table.add_row(<span class="string">&quot;May 25, 2018&quot;</span>, <span class="string">&quot;[red]Solo[/red]&quot;</span>, <span class="string">&quot;$393,151,347&quot;</span>)</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">print</span>(table)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 3. 进度条 (Progress) </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rich.progress <span class="keyword">import</span> Progress</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Progress() <span class="keyword">as</span> progress:</span><br><span class="line">    task = progress.add_task(<span class="string">&quot;[cyan]Processing...&quot;</span>, total=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        time.sleep(<span class="number">0.02</span>)</span><br><span class="line">        progress.update(task, advance=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 4. Markdown 渲染 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rich.console <span class="keyword">import</span> Console</span><br><span class="line"><span class="keyword">from</span> rich.markdown <span class="keyword">import</span> Markdown</span><br><span class="line"></span><br><span class="line">console = Console()</span><br><span class="line"></span><br><span class="line">markdown = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># Title</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This is a *markdown* document.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. Item 1</span></span><br><span class="line"><span class="string">2. Item 2</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">md = Markdown(markdown)</span><br><span class="line">console.<span class="built_in">print</span>(md)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 5. 语法高亮 (Syntax) </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rich.console <span class="keyword">import</span> Console</span><br><span class="line"><span class="keyword">from</span> rich.syntax <span class="keyword">import</span> Syntax</span><br><span class="line"></span><br><span class="line">console = Console()</span><br><span class="line"></span><br><span class="line">code = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">def hello(name: str) -&gt; str:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;Greet someone.&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    return f&quot;Hello, &#123;name&#125;!&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">syntax = Syntax(code, <span class="string">&quot;python&quot;</span>, theme=<span class="string">&quot;monokai&quot;</span>, line_numbers=<span class="literal">True</span>)</span><br><span class="line">console.<span class="built_in">print</span>(syntax)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 6. 美化 Traceback </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rich.traceback <span class="keyword">import</span> install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装为默认处理器</span></span><br><span class="line">install(show_locals=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 现在所有异常都会被美化</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a / b</span><br><span class="line"></span><br><span class="line">divide(<span class="number">10</span>, <span class="number">0</span>)  <span class="comment"># 显示美化的错误信息</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="最佳实践-4"><a href="#最佳实践-4" class="headerlink" title="最佳实践"></a>最佳实践</h3><details class="folding-tag" green><summary> ✅ 最佳实践 </summary>              <div class='content'>              <ol><li><strong>使用 Console 对象</strong>: 比直接导入 <code>print</code> 更灵活</li><li><strong>合理使用颜色</strong>: 避免过度装饰</li><li><strong>进度条用于长时间任务</strong>: 提升用户体验</li><li><strong>语法高亮用于代码</strong>: 让输出更易读</li><li><strong>Traceback 美化</strong>: 仅用于开发环境</li></ol>              </div>            </details><h2 id="完整项目配置示例"><a href="#完整项目配置示例" class="headerlink" title="完整项目配置示例"></a>完整项目配置示例</h2><h3 id="pyproject-toml"><a href="#pyproject-toml" class="headerlink" title="pyproject.toml"></a>pyproject.toml</h3><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;setuptools&gt;=61.0&quot;</span>, <span class="string">&quot;wheel&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;setuptools.build_meta&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[project]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;my-project&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line"><span class="attr">description</span> = <span class="string">&quot;A modern Python project&quot;</span></span><br><span class="line"><span class="attr">requires-python</span> = <span class="string">&quot;&gt;=3.10&quot;</span></span><br><span class="line"><span class="attr">dependencies</span> = [</span><br><span class="line">    <span class="string">&quot;httpx&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rich&gt;=13.0.0&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[project.optional-dependencies]</span></span><br><span class="line"><span class="attr">dev</span> = [</span><br><span class="line">    <span class="string">&quot;pytest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ruff&quot;</span>,</span><br><span class="line">    <span class="string">&quot;pyright&quot;</span>,</span><br><span class="line">    <span class="string">&quot;pre-commit&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[project.scripts]</span></span><br><span class="line"><span class="attr">my-cli</span> = <span class="string">&quot;my_package.cli:main&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================</span></span><br><span class="line"><span class="comment"># Ruff 配置</span></span><br><span class="line"><span class="comment"># ==============================</span></span><br><span class="line"><span class="section">[tool.ruff]</span></span><br><span class="line"><span class="attr">target-version</span> = <span class="string">&quot;py310&quot;</span></span><br><span class="line"><span class="attr">line-length</span> = <span class="number">88</span></span><br><span class="line"><span class="attr">preview</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">fix</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">unsafe-fixes</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[tool.ruff.lint]</span></span><br><span class="line"><span class="attr">select</span> = [<span class="string">&quot;E&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;UP&quot;</span>, <span class="string">&quot;C4&quot;</span>, <span class="string">&quot;TID&quot;</span>, <span class="string">&quot;ARG&quot;</span>, <span class="string">&quot;PTH&quot;</span>]</span><br><span class="line"><span class="attr">ignore</span> = [<span class="string">&quot;E501&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[[tool.ruff.lint.per-file-ignores]]</span></span><br><span class="line"><span class="attr">&quot;tests/**.py&quot;</span> = [<span class="string">&quot;S101&quot;</span>, <span class="string">&quot;ARG&quot;</span>]</span><br><span class="line"><span class="attr">&quot;scripts/*.py&quot;</span> = [<span class="string">&quot;T20&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[tool.ruff.format]</span></span><br><span class="line"><span class="attr">quote-style</span> = <span class="string">&quot;single&quot;</span></span><br><span class="line"><span class="attr">indent-width</span> = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================</span></span><br><span class="line"><span class="comment"># Pyright 配置</span></span><br><span class="line"><span class="comment"># ==============================</span></span><br><span class="line"><span class="section">[tool.pyright]</span></span><br><span class="line"><span class="attr">typeCheckingMode</span> = <span class="string">&quot;strict&quot;</span></span><br><span class="line"><span class="attr">pythonVersion</span> = <span class="string">&quot;3.10&quot;</span></span><br><span class="line"><span class="attr">include</span> = [<span class="string">&quot;src&quot;</span>, <span class="string">&quot;tests&quot;</span>]</span><br><span class="line"><span class="attr">reportMissingTypeStubs</span> = <span class="string">&quot;none&quot;</span></span><br><span class="line"><span class="attr">reportUnusedImport</span> = <span class="string">&quot;warning&quot;</span></span><br><span class="line"><span class="attr">reportUnusedVariable</span> = <span class="string">&quot;warning&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================</span></span><br><span class="line"><span class="comment"># Pytest 配置</span></span><br><span class="line"><span class="comment"># ==============================</span></span><br><span class="line"><span class="section">[tool.pytest.ini_options]</span></span><br><span class="line"><span class="attr">minversion</span> = <span class="string">&quot;6.0&quot;</span></span><br><span class="line"><span class="attr">addopts</span> = <span class="string">&quot;-ra -q&quot;</span></span><br><span class="line"><span class="attr">testpaths</span> = [<span class="string">&quot;tests&quot;</span>]</span><br></pre></td></tr></table></figure><h3 id="pre-commit-config-yaml"><a href="#pre-commit-config-yaml" class="headerlink" title=".pre-commit-config.yaml"></a>.pre-commit-config.yaml</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">repos:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">https://github.com/pre-commit/pre-commit-hooks</span></span><br><span class="line">    <span class="attr">rev:</span> <span class="string">v4.6.0</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">trailing-whitespace</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">end-of-file-fixer</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-yaml</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-json</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-toml</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">check-added-large-files</span></span><br><span class="line">        <span class="attr">args:</span> [<span class="string">&#x27;--maxkb=5120&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">https://github.com/astral-sh/ruff-pre-commit</span></span><br><span class="line">    <span class="attr">rev:</span> <span class="string">v0.5.0</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff</span></span><br><span class="line">        <span class="attr">args:</span> [<span class="string">--fix</span>]</span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff-format</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">local</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pyright</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">pyright</span></span><br><span class="line">        <span class="attr">entry:</span> <span class="string">pyright</span> <span class="string">.</span></span><br><span class="line">        <span class="attr">language:</span> <span class="string">system</span></span><br><span class="line">        <span class="attr">types:</span> [<span class="string">python</span>]</span><br><span class="line">        <span class="attr">require_serial:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="工作流总结"><a href="#工作流总结" class="headerlink" title="工作流总结"></a>工作流总结</h2><h3 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建项目目录</span></span><br><span class="line"><span class="built_in">mkdir</span> my-project &amp;&amp; <span class="built_in">cd</span> my-project</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 初始化 Git</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 初始化 uv 项目</span></span><br><span class="line">uv init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 创建虚拟环境</span></span><br><span class="line">uv venv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 激活环境</span></span><br><span class="line"><span class="built_in">source</span> .venv/bin/activate  <span class="comment"># Windows: .venv\Scripts\activate</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 添加依赖</span></span><br><span class="line">uv add httpx rich</span><br><span class="line">uv add --dev pytest ruff pyright pre-commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 安装 pre-commit 钩子</span></span><br><span class="line">pre-commit install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. 提交初始配置</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;chore: initialize project with modern tooling&quot;</span></span><br></pre></td></tr></table></figure><h3 id="日常开发"><a href="#日常开发" class="headerlink" title="日常开发"></a>日常开发</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 拉取最新代码</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 同步依赖</span></span><br><span class="line">uv <span class="built_in">sync</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 开发代码...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 代码质量检查 (可选，pre-commit 会自动运行)</span></span><br><span class="line">ruff format . &amp;&amp; ruff check . --fix</span><br><span class="line">pyright .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 运行测试</span></span><br><span class="line">pytest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 提交代码 (pre-commit 自动运行)</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;feat: add new feature&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 推送代码</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><h3 id="团队协作"><a href="#团队协作" class="headerlink" title="团队协作"></a>团队协作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新成员加入项目</span></span><br><span class="line">git <span class="built_in">clone</span> &lt;repo-url&gt;</span><br><span class="line"><span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line">uv <span class="built_in">sync</span>      <span class="comment"># 安装所有依赖</span></span><br><span class="line">pre-commit install  <span class="comment"># 安装 Git 钩子</span></span><br></pre></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><div class="tag link"><a class="link-card" title="uv" href="https://github.com/astral-sh/uv"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">uv</p><p class="url">https://github.com/astral-sh/uv</p></div></a></div><div class="tag link"><a class="link-card" title="Ruff" href="https://github.com/astral-sh/ruff"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Ruff</p><p class="url">https://github.com/astral-sh/ruff</p></div></a></div><div class="tag link"><a class="link-card" title="Pyright" href="https://github.com/microsoft/pyright"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Pyright</p><p class="url">https://github.com/microsoft/pyright</p></div></a></div><a class="btn-beautify outline purple" href="https://pre-commit.com/" title="pre-commit 官方文档"><i class="fas fa-book"></i><span>pre-commit 官方文档</span></a><a class="btn-beautify outline pink" href="https://rich.readthedocs.io/" title="rich 官方文档"><i class="fas fa-palette"></i><span>rich 官方文档</span></a><a class="btn-beautify outline blue" href="https://docs.python.org/zh-cn/3.14/library/typing.html" title="Python 类型注解"><i class="fas fa-code"></i><span>Python 类型注解</span></a><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>现代化 Python 开发工具链的核心优势：</p><div class="note success flat"><p><strong>核心优势</strong>:</p><ol><li><strong>极致性能</strong>: Rust 编写的工具比传统工具快 10-100 倍</li><li><strong>统一配置</strong>: 所有配置集中在 <code>pyproject.toml</code></li><li><strong>自动化</strong>: pre-commit 自动运行检查，减少人为错误</li><li><strong>类型安全</strong>: Pyright strict mode 保证代码质量</li><li><strong>开发体验</strong>: rich 让终端输出更加专业</li></ol></div><p>这些工具共同构成了一个高效、可靠、现代化的 Python 开发环境，显著提升了开发效率和代码质量。</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> uv </tag>
            
            <tag> Ruff </tag>
            
            <tag> Pyright </tag>
            
            <tag> pre-commit </tag>
            
            <tag> rich </tag>
            
            <tag> 工具链 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Claude文档(一) Claude Code 安装配置</title>
      <link href="/posts/8982d5cb/"/>
      <url>/posts/8982d5cb/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Claude Code 是 Anthropic 推出的终端驻留式 AI 编程代理工具, 能够完整理解代码库上下文, 通过自然语言指令完成代码阅读、生成、修改、git 操作等任务。</p><a class="btn-beautify purple" href="https://code.claude.com" title="Claude Code 官网"><i class="fa-solid fa-globe"></i><span>Claude Code 官网</span></a><h3 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h3><ul><li><strong>智能代码库理解</strong>: 使用 agent 搜索理解整个代码库结构, 无需手动选择上下文文件</li><li><strong>多文件协作</strong>: 能够在多个文件间协调修改, 保持代码一致性</li><li><strong>原生工具集成</strong>: 支持所有 CLI 工具, 包括 Git、包管理器、构建系统等</li><li><strong>安全可控</strong>: 修改文件前始终请求权限, 不会意外破坏代码</li><li><strong>多平台支持</strong>: 可在终端、VS Code、JetBrains IDEs 和浏览器中使用</li></ul><h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><ul><li>中大型项目的重构和特性开发</li><li>理解遗留代码和复杂业务逻辑</li><li>自动化测试生成和 bug 修复</li><li>跨文件代码迁移和架构调整</li><li>文档生成和代码审查</li></ul><div class="note success flat"><p>✅ <strong>效率提升</strong>: 相比传统代码补全工具, Claude Code 更像一个可执行多步计划的”同事”, 能够将编码效率提升 2-4 倍。</p></div><hr><h2 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h2><p>Claude Code 官方推荐使用原生二进制安装方式(npm 方式已标记 deprecated)。</p><h3 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h3><ul><li><strong>Node.js</strong>: 18.0 或更高版本</li><li><strong>操作系统</strong>: macOS、Linux(含 WSL2)、Windows</li><li><strong>网络</strong>: 需要访问 Anthropic API 或兼容服务</li></ul><h3 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-linux"></i>Ubuntu/Debian/WSL</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>方法一: Homebrew 安装(推荐)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确保 brew 已更新</span></span><br><span class="line">brew update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 Claude Code(会自动拉取最新稳定版)</span></span><br><span class="line">brew install --cask claude-code</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 Homebrew 会自动配置 PATH 环境变量, 无需手动配置。</p></div><p><strong>方法二: 官方安装脚本</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载并执行安装脚本(会放置在 /usr/local/bin/claude)</span></span><br><span class="line">curl -fsSL https://claude.ai/install.sh | bash</span><br></pre></td></tr></table></figure><div class="note warning flat"><p>⚠️ 如果使用 nvm 安装 Node.js, 可能会遇到权限问题, 建议使用 Homebrew 方式。</p></div></div><div class="tab-item-content"><p><strong>使用官方安装脚本(推荐)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载并执行安装脚本(会放置在 ~/.local/bin/claude)</span></span><br><span class="line">curl -fsSL https://claude.ai/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加到 PATH(如果尚未添加)</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$HOME/.local/bin:$PATH&quot;&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p><strong>使用 Node.js 全局安装(备用方案)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确保 Node.js &gt;= 18</span></span><br><span class="line">node --version</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局安装 Claude Code</span></span><br><span class="line">npm install -g @anthropic-ai/claude-code</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 npm 方式需要确保有全局 npm 权限, 避免使用 sudo。</p></div></div><div class="tab-item-content"><p><strong>推荐方案: WSL2 + Ubuntu</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 PowerShell 中安装 WSL2</span></span><br><span class="line">wsl <span class="literal">--install</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装完成后, 在 WSL Ubuntu 中按上述 Linux 方式安装</span></span><br></pre></td></tr></table></figure><p><strong>原生 Windows 支持(实验性)</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 PowerShell 安装脚本</span></span><br><span class="line"><span class="built_in">irm</span> https://claude.ai/install.ps1 | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>⚠️ 原生 Windows 支持仍在完善中, 稳定性与生态完整度建议走 WSL。</p></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="验证安装"><a href="#验证安装" class="headerlink" title="验证安装"></a>验证安装</h3><p>安装完成后验证:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">claude --version</span><br><span class="line"><span class="comment"># 应输出版本号, 如 v2.0.14</span></span><br></pre></td></tr></table></figure><p>如果输出了版本号, 说明安装成功。</p><div class="tag link"><a class="link-card" title="Claude Code 安装文档" href="https://docs.anthropic.com/en/docs/claude-code/overview"><div class="left"><img src="https://avatars.githubusercontent.com/u/81847?v=4"/></div><div class="right"><p class="text">Claude Code 安装文档</p><p class="url">https://docs.anthropic.com/en/docs/claude-code/overview</p></div></a></div><h3 id="VS-Code-JetBrains-IDE-扩展"><a href="#VS-Code-JetBrains-IDE-扩展" class="headerlink" title="VS Code / JetBrains IDE 扩展"></a>VS Code / JetBrains IDE 扩展</h3><p>如果需要在 IDE 中使用 Claude Code:</p><div class="tabs"><div class="nav-tabs no-default"></div><div class="tab-contents"></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><div class="note info flat"><p>💡 IDE 扩展提供可视化 diff 对比, 适合需要频繁查看代码变更的场景。</p></div><hr><h2 id="认证配置"><a href="#认证配置" class="headerlink" title="认证配置"></a>认证配置</h2><p>Claude Code 支持三种主要认证模式:</p><div class="tabs"><div class="nav-tabs no-default"></div><div class="tab-contents"></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="创建多模型-alias"><a href="#创建多模型-alias" class="headerlink" title="创建多模型 alias"></a>创建多模型 alias</h3><p>建议创建不同模型的 alias, 方便快速切换:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ~/.bashrc 或 ~/.zshrc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 官方 Claude(需要代理)</span></span><br><span class="line"><span class="built_in">alias</span> claude-claude=<span class="string">&quot;ANTHROPIC_BASE_URL=https://api.anthropic.com ANTHROPIC_API_KEY=sk-ant-... claude&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 智谱 GLM-4.7</span></span><br><span class="line"><span class="built_in">alias</span> claude-glm=<span class="string">&quot;ANTHROPIC_BASE_URL=https://open.bigmodel.cn/api/anthropic/v1 ANTHROPIC_API_KEY=sk-xxx claude&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># z.ai GLM-4.7</span></span><br><span class="line"><span class="built_in">alias</span> claude-zai=<span class="string">&quot;ANTHROPIC_BASE_URL=https://api.z.ai/v1 ANTHROPIC_API_KEY=sk-xxx claude&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 应用配置</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc  <span class="comment"># 或 source ~/.zshrc</span></span><br></pre></td></tr></table></figure><p>使用示例:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用官方 Claude</span></span><br><span class="line">claude-claude</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用智谱 GLM-4.7</span></span><br><span class="line">claude-glm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 z.ai GLM-4.7</span></span><br><span class="line">claude-zai</span><br></pre></td></tr></table></figure><hr><h2 id="模型选择与优化配置"><a href="#模型选择与优化配置" class="headerlink" title="模型选择与优化配置"></a>模型选择与优化配置</h2><h3 id="Claude-Code-模型映射"><a href="#Claude-Code-模型映射" class="headerlink" title="Claude Code 模型映射"></a>Claude Code 模型映射</h3><p>Claude Code 使用三种模型层级:</p><div class="table-container"><table><thead><tr><th>模型</th><th>用途</th><th>GLM-4.7 映射</th><th>特点</th></tr></thead><tbody><tr><td><strong>Haiku</strong></td><td>轻量级任务</td><td>glm-4.5-air</td><td>快速响应, 适合简单查询</td></tr><tr><td><strong>Sonnet</strong></td><td>主要开发工作</td><td>glm-4.7</td><td>平衡性能与速度</td></tr><tr><td><strong>Opus</strong></td><td>复杂推理任务</td><td>glm-4.7</td><td>最强能力, 适合复杂架构设计</td></tr></tbody></table></div><div class="note info flat"><p>💡 GLM-4.7-long 上下文更稳定, 适合超过 100k token 的巨型代码库分析。</p></div><h3 id="配置-GLM-4-7-模型映射"><a href="#配置-GLM-4-7-模型映射" class="headerlink" title="配置 GLM-4.7 模型映射"></a>配置 GLM-4.7 模型映射</h3><p>修改 <code>~/.claude/settings.json</code>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ANTHROPIC_DEFAULT_HAIKU_MODEL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glm-4.5-air&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ANTHROPIC_DEFAULT_SONNET_MODEL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glm-4.7&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ANTHROPIC_DEFAULT_OPUS_MODEL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glm-4.7&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="推荐配置组合"><a href="#推荐配置组合" class="headerlink" title="推荐配置组合"></a>推荐配置组合</h3><div class="tabs"><div class="nav-tabs no-default"></div><div class="tab-contents"></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="验证模型配置"><a href="#验证模型配置" class="headerlink" title="验证模型配置"></a>验证模型配置</h3><p>启动 Claude Code 后, 使用 <code>/status</code> 命令查看当前模型状态:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">claude</span><br><span class="line"><span class="comment"># 在 Claude Code 交互界面中</span></span><br><span class="line">claude &gt; /status</span><br></pre></td></tr></table></figure><p>应显示类似:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Current Model: glm-4.7</span><br><span class="line">Base URL: https://open.bigmodel.cn/api/anthropic/v1</span><br></pre></td></tr></table></figure><hr><h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h3 id="启动-Claude-Code"><a href="#启动-Claude-Code" class="headerlink" title="启动 Claude Code"></a>启动 Claude Code</h3><p>进入任意项目目录, 直接启动:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/projects/my-app</span><br><span class="line">claude</span><br></pre></td></tr></table></figure><p>出现 <code>claude &gt;</code> 提示符即成功。</p><h3 id="首次使用授权"><a href="#首次使用授权" class="headerlink" title="首次使用授权"></a>首次使用授权</h3><p>首次启动时, Claude Code 会请求文件访问权限:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Claude Code wants to access files in /Users/xxx/projects/my-app</span><br><span class="line">[Allow] [Deny]</span><br></pre></td></tr></table></figure><p>选择 <strong>Allow</strong> 以授予访问权限。</p><div class="note warning flat"><p>⚠️ 如果误选了 Deny, 可以在 <code>~/.claude/settings.json</code> 中删除相关路径配置。</p></div><h3 id="基础测试指令"><a href="#基础测试指令" class="headerlink" title="基础测试指令"></a>基础测试指令</h3><p><strong>使用 /ask 指令(不修改文件)</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ask 当前项目使用什么语言? package.json 和 requirements.txt 里主要依赖是什么?</span><br></pre></td></tr></table></figure><p><strong>使用自然语言指令</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">帮我分析 src/components 目录下所有组件的作用和关系</span><br></pre></td></tr></table></figure><p>正常情况下 5–15 秒内会返回带文件树和关键代码引用的分析。</p><h3 id="查看帮助信息"><a href="#查看帮助信息" class="headerlink" title="查看帮助信息"></a>查看帮助信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/help</span><br></pre></td></tr></table></figure><p>会列出所有可用指令和快捷键。</p><hr><h2 id="核心功能使用"><a href="#核心功能使用" class="headerlink" title="核心功能使用"></a>核心功能使用</h2><h3 id="Slash-Commands-必须掌握"><a href="#Slash-Commands-必须掌握" class="headerlink" title="Slash Commands(必须掌握)"></a>Slash Commands(必须掌握)</h3><p>Claude Code 使用 <code>/</code> 开头的 slash command 与纯自然语言两种交互方式。</p><p>常用内置指令:</p><div class="table-container"><table><thead><tr><th>指令</th><th>作用</th><th>示例</th></tr></thead><tbody><tr><td><code>/ask</code></td><td>提问(不修改文件)</td><td><code>/ask 这个函数的性能瓶颈可能在哪里?</code></td></tr><tr><td><code>/generate</code></td><td>生成新文件或代码片段</td><td><code>/generate 创建一个用户登录的 RESTful 接口</code></td></tr><tr><td><code>/edit</code></td><td>修改已有文件</td><td><code>/edit 在 auth.js 中添加 JWT 刷新逻辑</code></td></tr><tr><td><code>/run</code></td><td>执行 shell 命令(需确认)</td><td><code>/run npm test</code></td></tr><tr><td><code>/git</code></td><td>git 操作</td><td><code>/git commit -m &quot;feat: add login endpoint&quot;</code></td></tr><tr><td><code>/model</code></td><td>查看&amp;切换当前模型</td><td><code>/model list</code></td></tr><tr><td><code>/status</code></td><td>查看当前状态</td><td><code>/status</code></td></tr><tr><td><code>/clear</code></td><td>清空对话历史</td><td><code>/clear</code></td></tr><tr><td><code>/help</code></td><td>完整指令列表</td><td><code>/help</code></td></tr></tbody></table></div><div class="note info flat"><p>💡 <code>/ask</code> 指令适合探索性提问, 不会修改任何文件。</p></div><h3 id="典型使用场景"><a href="#典型使用场景" class="headerlink" title="典型使用场景"></a>典型使用场景</h3><h4 id="1-快速理解陌生项目"><a href="#1-快速理解陌生项目" class="headerlink" title="1. 快速理解陌生项目"></a>1. 快速理解陌生项目</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">给我一份这个仓库的架构概览, 重点标注入口文件和核心模块</span><br></pre></td></tr></table></figure><p>Claude Code 会:</p><ul><li>扫描项目结构</li><li>分析 package.json/requirements.txt</li><li>识别主要模块和依赖关系</li><li>生成架构概览</li></ul><p>e.g.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">claude &gt; 给我一份这个仓库的架构概览, 重点标注入口文件和核心模块</span><br><span class="line"></span><br><span class="line"><span class="comment"># Claude Code 会分析并输出类似:</span></span><br><span class="line">- 入口文件: src/index.ts</span><br><span class="line">- 核心模块:</span><br><span class="line">  - src/auth/: 认证模块</span><br><span class="line">  - src/api/: API 路由</span><br><span class="line">  - src/utils/: 工具函数</span><br><span class="line">  - src/components/: React 组件</span><br></pre></td></tr></table></figure><h4 id="2-批量生成测试用例"><a href="#2-批量生成测试用例" class="headerlink" title="2. 批量生成测试用例"></a>2. 批量生成测试用例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 __tests__ 目录下为所有 utils/*.ts 文件生成 jest 测试用例, 覆盖率目标 90%</span><br></pre></td></tr></table></figure><p>Claude Code 会:</p><ul><li>读取所有 utils 文件</li><li>分析函数签名和逻辑</li><li>生成完整的测试用例</li><li>确保覆盖率达标</li></ul><p>e.g.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">claude &gt; 在 __tests__ 目录下为所有 utils/*.ts 文件生成 jest 测试用例</span><br><span class="line"></span><br><span class="line"><span class="comment"># Claude Code 会:</span></span><br><span class="line">1. 分析 src/utils/format.ts, src/utils/validate.ts 等</span><br><span class="line">2. 生成 __tests__/format.test.ts, __tests__/validate.test.ts</span><br><span class="line">3. 包含边界测试、错误处理测试</span><br></pre></td></tr></table></figure><h4 id="3-跨文件重构"><a href="#3-跨文件重构" class="headerlink" title="3. 跨文件重构"></a>3. 跨文件重构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把所有 class 组件统一改写为 function component + hooks, 改动尽量原子化, 每个文件单独 commit</span><br></pre></td></tr></table></figure><p>Claude Code 会:</p><ul><li>找到所有 class 组件</li><li>逐个改写为 hooks</li><li>每改完一个文件提交一次</li><li>保持代码风格一致</li></ul><p>e.g.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">claude &gt; 把所有 class 组件改写为 <span class="keyword">function</span> component + hooks, 每个文件单独 commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># Claude Code 会:</span></span><br><span class="line">1. 搜索所有 class 组件</span><br><span class="line">2. 逐个改写为 hooks</span><br><span class="line">3. 运行 git commit 对每个文件单独提交</span><br></pre></td></tr></table></figure><h4 id="4-自动修复-lint-amp-type-错误"><a href="#4-自动修复-lint-amp-type-错误" class="headerlink" title="4. 自动修复 lint &amp; type 错误"></a>4. 自动修复 lint &amp; type 错误</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">运行 tsc --noEmit 后把所有报错修复掉, 必要时添加类型声明</span><br></pre></td></tr></table></figure><p>Claude Code 会:</p><ul><li>运行 TypeScript 编译器</li><li>分析所有错误</li><li>自动修复或添加类型声明</li><li>验证修复结果</li></ul><p>e.g.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">claude &gt; 运行 tsc --noEmit 后修复所有类型错误</span><br><span class="line"></span><br><span class="line"><span class="comment"># Claude Code 会:</span></span><br><span class="line">1. 执行 tsc --noEmit</span><br><span class="line">2. 分析错误列表</span><br><span class="line">3. 逐个修复类型错误</span><br><span class="line">4. 再次运行 tsc 验证</span><br></pre></td></tr></table></figure><div class="note warning flat"><p>⚠️ GLM-4.7 在多轮工具调用连续性上稍逊官方 Sonnet 模型, 复杂任务建议在 prompt 里明确写 “step by step, don’t stop until finished”。</p></div><h3 id="使用技巧"><a href="#使用技巧" class="headerlink" title="使用技巧"></a>使用技巧</h3><h4 id="明确指令"><a href="#明确指令" class="headerlink" title="明确指令"></a>明确指令</h4><p>❌ 模糊指令:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">帮我优化一下代码</span><br></pre></td></tr></table></figure></p><p>✅ 明确指令:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把 src/api/user.ts 中的所有 Promise 链改写为 async/await, 保持错误处理逻辑不变</span><br></pre></td></tr></table></figure></p><h4 id="分步执行"><a href="#分步执行" class="headerlink" title="分步执行"></a>分步执行</h4><p>对于复杂任务, 分步执行效果更好:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 第一步: 分析问题</span><br><span class="line">/ask 这个项目中的类型错误主要集中在哪些文件?</span><br><span class="line"></span><br><span class="line"># 第二步: 修复问题</span><br><span class="line">修复 src/api/auth.ts 中的所有类型错误, 添加必要的类型声明</span><br><span class="line"></span><br><span class="line"># 第三步: 验证结果</span><br><span class="line">/run npm run type-check</span><br></pre></td></tr></table></figure><h4 id="交互式确认"><a href="#交互式确认" class="headerlink" title="交互式确认"></a>交互式确认</h4><p>Claude Code 在执行危险操作前会请求确认:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">⚠️  Claude Code will delete the following files:</span><br><span class="line">- src/old-component.tsx</span><br><span class="line">- src/old-utils.ts</span><br><span class="line"></span><br><span class="line">Continue? [y/N]</span><br></pre></td></tr></table></figure><div class="note danger flat"><p>🚫 始终仔细查看变更内容, 特别是删除操作。</p></div><hr><h2 id="进阶功能"><a href="#进阶功能" class="headerlink" title="进阶功能"></a>进阶功能</h2><h3 id="MCP-工具扩展"><a href="#MCP-工具扩展" class="headerlink" title="MCP 工具扩展"></a>MCP 工具扩展</h3><p>Claude Code 支持 MCP(Model Context Protocol)服务器扩展能力, 可以增强其功能:</p><h4 id="常用-MCP-服务器"><a href="#常用-MCP-服务器" class="headerlink" title="常用 MCP 服务器"></a>常用 MCP 服务器</h4><p><strong>文件系统 MCP</strong>(深度文件操作)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加文件系统 MCP(常用于大项目索引)</span></span><br><span class="line">claude mcp add filesystem -- npx -y @modelcontextprotocol/server-filesystem .</span><br></pre></td></tr></table></figure><p><strong>浏览器自动化 MCP</strong>(让 Claude 自己查文档)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 Puppeteer MCP</span></span><br><span class="line">claude mcp add puppeteer -- npx -y @modelcontextprotocol/server-puppeteer</span><br></pre></td></tr></table></figure><p><strong>搜索增强 MCP</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 Brave Search MCP</span></span><br><span class="line">claude mcp add brave-search -- npx -y @modelcontextprotocol/server-brave-search</span><br></pre></td></tr></table></figure><p><strong>GitHub MCP</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 GitHub MCP(集成 GitHub API)</span></span><br><span class="line">claude mcp add github -- npx -y @modelcontextprotocol/server-github</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 MCP 服务器需要额外的配置和认证, 参考 <a href="https://docs.anthropic.com/en/docs/build-with-claude/mcp">MCP 官方文档</a>。</p></div><h4 id="查看-移除-MCP"><a href="#查看-移除-MCP" class="headerlink" title="查看/移除 MCP"></a>查看/移除 MCP</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看已安装的 MCP</span></span><br><span class="line">claude mcp list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除 MCP 服务器</span></span><br><span class="line">claude mcp remove &lt;mcp-name&gt;</span><br></pre></td></tr></table></figure><div class="tag link"><a class="link-card" title="MCP 官方文档" href="https://docs.anthropic.com/en/docs/build-with-claude/mcp"><div class="left"><img src="https://avatars.githubusercontent.com/u/182288589?s=200&v=4"/></div><div class="right"><p class="text">MCP 官方文档</p><p class="url">https://docs.anthropic.com/en/docs/build-with-claude/mcp</p></div></a></div><h3 id="自定义配置"><a href="#自定义配置" class="headerlink" title="自定义配置"></a>自定义配置</h3><h4 id="配置文件位置"><a href="#配置文件位置" class="headerlink" title="配置文件位置"></a>配置文件位置</h4><ul><li><strong>全局配置</strong>: <code>~/.claude/settings.json</code></li><li><strong>项目配置</strong>: <code>.claude/settings.json</code></li></ul><h4 id="常用配置项"><a href="#常用配置项" class="headerlink" title="常用配置项"></a>常用配置项</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// 模型配置</span></span><br><span class="line">  <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ANTHROPIC_DEFAULT_SONNET_MODEL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glm-4.7&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ANTHROPIC_DEFAULT_OPUS_MODEL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glm-4.7&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;CLAUDE_CODE_MAX_OUTPUT_TOKENS&quot;</span><span class="punctuation">:</span> <span class="number">64000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 允许的工具</span></span><br><span class="line">  <span class="attr">&quot;allowedTools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;Read&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Write&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Edit&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Bash&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Git&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 禁用的工具</span></span><br><span class="line">  <span class="attr">&quot;disabledTools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自动确认操作(谨慎使用)</span></span><br><span class="line">  <span class="attr">&quot;dangerouslySkipPermissions&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义系统提示</span></span><br><span class="line">  <span class="attr">&quot;systemPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你是一个专业的全栈工程师...&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="note danger flat"><p>🚫 <code>dangerouslySkipPermissions</code> 会跳过所有权限确认, 仅在完全信任的环境中使用。</p></div><h3 id="环境变量配置"><a href="#环境变量配置" class="headerlink" title="环境变量配置"></a>环境变量配置</h3><p>除了在 <code>~/.claude/settings.json</code> 中配置, 也可以使用环境变量:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ~/.bashrc 或 ~/.zshrc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># API 配置</span></span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_BASE_URL=https://open.bigmodel.cn/api/anthropic/v1</span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_API_KEY=sk-xxx...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型配置</span></span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_DEFAULT_SONNET_MODEL=glm-4.7</span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_DEFAULT_OPUS_MODEL=glm-4.7</span><br><span class="line"></span><br><span class="line"><span class="comment"># 性能配置</span></span><br><span class="line"><span class="built_in">export</span> CLAUDE_CODE_MAX_OUTPUT_TOKENS=64000</span><br><span class="line"><span class="built_in">export</span> CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 代理配置(如需要)</span></span><br><span class="line"><span class="built_in">export</span> HTTP_PROXY=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> HTTPS_PROXY=http://127.0.0.1:7890</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 环境变量优先级高于 <code>settings.json</code>。</p></div><hr><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3><h4 id="1-需求分析阶段"><a href="#1-需求分析阶段" class="headerlink" title="1. 需求分析阶段"></a>1. 需求分析阶段</h4><p>使用 <code>/ask</code> 探索问题:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ask 这个项目的认证流程是如何实现的? 涉及哪些文件?</span><br></pre></td></tr></table></figure><h4 id="2-方案设计阶段"><a href="#2-方案设计阶段" class="headerlink" title="2. 方案设计阶段"></a>2. 方案设计阶段</h4><p>让 Claude Code 提供多个方案:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">给出三种重构数据库查询的方案, 对比优劣和实现难度</span><br></pre></td></tr></table></figure><h4 id="3-实现阶段"><a href="#3-实现阶段" class="headerlink" title="3. 实现阶段"></a>3. 实现阶段</h4><p>使用明确的指令:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">创建 src/utils/db.ts, 实现方案一中的数据库连接池, 使用 TypeORM</span><br></pre></td></tr></table></figure><h4 id="4-测试阶段"><a href="#4-测试阶段" class="headerlink" title="4. 测试阶段"></a>4. 测试阶段</h4><p>自动生成测试:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">为 src/utils/db.ts 生成完整的单元测试, 覆盖所有分支</span><br></pre></td></tr></table></figure><h4 id="5-提交阶段"><a href="#5-提交阶段" class="headerlink" title="5. 提交阶段"></a>5. 提交阶段</h4><p>使用 <code>/git</code> 提交:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/git add .</span><br><span class="line">/git commit -m &quot;feat: implement database connection pool&quot;</span><br></pre></td></tr></table></figure><h3 id="提示词工程"><a href="#提示词工程" class="headerlink" title="提示词工程"></a>提示词工程</h3><h4 id="好的提示词特征"><a href="#好的提示词特征" class="headerlink" title="好的提示词特征"></a>好的提示词特征</h4><ul><li><strong>具体明确</strong>: 指定文件名、函数名、具体行为</li><li><strong>上下文完整</strong>: 提供必要的背景信息</li><li><strong>约束清晰</strong>: 说明不能做什么</li><li><strong>可验证</strong>: 有明确的验收标准</li></ul><p>e.g. 好的提示词:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在 src/api/auth.ts 中添加 JWT token 刷新功能:</span><br><span class="line">1. 使用 jsonwebtoken 库</span><br><span class="line">2. 实现 refresh() 函数, 接收旧 token, 返回新 token</span><br><span class="line">3. 添加过期时间检查, 过期返回 401</span><br><span class="line">4. 保持现有的 login() 和 logout() 函数不变</span><br><span class="line">5. 添加类型声明</span><br></pre></td></tr></table></figure><h4 id="不好的提示词特征"><a href="#不好的提示词特征" class="headerlink" title="不好的提示词特征"></a>不好的提示词特征</h4><p>❌ 模糊:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">优化一下认证代码</span><br></pre></td></tr></table></figure></p><p>❌ 缺少上下文:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">添加一个新功能</span><br></pre></td></tr></table></figure></p><p>❌ 约束不清:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">重构这个文件, 但不要改太多</span><br></pre></td></tr></table></figure></p><h3 id="团队协作"><a href="#团队协作" class="headerlink" title="团队协作"></a>团队协作</h3><h4 id="统一配置"><a href="#统一配置" class="headerlink" title="统一配置"></a>统一配置</h4><p>在项目根目录创建 <code>.claude/settings.json</code>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ANTHROPIC_DEFAULT_SONNET_MODEL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glm-4.7&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;systemPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;这是团队 X 的项目, 遵循以下编码规范:...&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="文档化使用规范"><a href="#文档化使用规范" class="headerlink" title="文档化使用规范"></a>文档化使用规范</h4><p>创建 <code>CLAUDE.md</code> 文件:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Claude Code 使用规范</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 常用指令</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 项目结构</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 编码规范</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 测试要求</span></span><br></pre></td></tr></table></figure><div class="note success flat"><p>✅ 将 <code>.claude/</code> 和 <code>CLAUDE.md</code> 加入版本控制。</p></div><h3 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h3><h4 id="减少上下文加载"><a href="#减少上下文加载" class="headerlink" title="减少上下文加载"></a>减少上下文加载</h4><p>使用具体路径而非通配符:</p><p>❌ 不好:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分析所有组件文件</span><br></pre></td></tr></table></figure></p><p>✅ 好:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分析 src/components/Auth/Login.tsx 和 src/components/Auth/Register.tsx</span><br></pre></td></tr></table></figure></p><h4 id="使用轻量模型"><a href="#使用轻量模型" class="headerlink" title="使用轻量模型"></a>使用轻量模型</h4><p>简单查询使用 Haiku:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/model haiku</span><br><span class="line">/ask 这个函数的作用是什么?</span><br></pre></td></tr></table></figure><h4 id="清理历史记录"><a href="#清理历史记录" class="headerlink" title="清理历史记录"></a>清理历史记录</h4><p>定期清理对话历史:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/clear</span><br></pre></td></tr></table></figure><div class="note warning flat"><p>⚠️ 长对话会占用大量 token, 影响响应速度。</p></div><h3 id="安全建议"><a href="#安全建议" class="headerlink" title="安全建议"></a>安全建议</h3><h4 id="不要泄露敏感信息"><a href="#不要泄露敏感信息" class="headerlink" title="不要泄露敏感信息"></a>不要泄露敏感信息</h4><p>❌ 危险:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这是一个生产环境的数据库配置, host=prod-db.example.com, user=admin, password=xxx, 帮我优化查询</span><br></pre></td></tr></table></figure></p><p>✅ 安全:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">优化以下数据库查询, 使用参数化查询防止 SQL 注入:</span><br><span class="line">[提供脱敏后的查询代码]</span><br></pre></td></tr></table></figure></p><h4 id="审查生成的代码"><a href="#审查生成的代码" class="headerlink" title="审查生成的代码"></a>审查生成的代码</h4><p>Claude Code 生成的代码需要:</p><ol><li>安全审查(SQL 注入、XSS、CSRF 等)</li><li>性能测试(时间复杂度、资源使用)</li><li>边界测试(异常输入、并发场景)</li></ol><div class="note danger flat"><p>🚫 不要直接在生产环境使用生成的代码。</p></div><h4 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h4><p>使用 <code>allowedTools</code> 限制可用工具:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;allowedTools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;Read&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Edit&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Grep&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;disabledTools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;Bash&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;Git&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="安装问题"><a href="#安装问题" class="headerlink" title="安装问题"></a>安装问题</h3><details class="folding-tag" blue><summary> Q: brew 安装后找不到 claude 命令 </summary>              <div class='content'>              <p>检查 PATH 配置:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 PATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 应包含 /opt/homebrew/bin (Apple Silicon) 或 /usr/local/bin (Intel)</span></span><br><span class="line"><span class="comment"># 如果没有, 添加到 ~/.zshrc</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;/opt/homebrew/bin:$PATH&quot;&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> Q: npm 安装后权限不足 </summary>              <div class='content'>              <p>不要使用 sudo, 使用 nvm 安装 Node.js:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 nvm</span></span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 nvm 安装 Node.js</span></span><br><span class="line">nvm install 18</span><br><span class="line">nvm use 18</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新安装 Claude Code</span></span><br><span class="line">npm install -g @anthropic-ai/claude-code</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="认证问题"><a href="#认证问题" class="headerlink" title="认证问题"></a>认证问题</h3><details class="folding-tag" yellow><summary> Q: 提示 Invalid API key </summary>              <div class='content'>              <p>检查环境变量:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 API Key</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$ANTHROPIC_API_KEY</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 应该输出 sk- 开头的 key</span></span><br><span class="line"><span class="comment"># 如果为空, 检查配置文件</span></span><br><span class="line"><span class="built_in">cat</span> ~/.zshrc | grep ANTHROPIC</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> Q: 网络超时 </summary>              <div class='content'>              <p>配置代理或使用国内服务:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方案一: 配置代理</span></span><br><span class="line"><span class="built_in">export</span> HTTP_PROXY=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> HTTPS_PROXY=http://127.0.0.1:7890</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方案二: 使用智谱 GLM-4.7</span></span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_BASE_URL=https://open.bigmodel.cn/api/anthropic/v1</span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_API_KEY=sk-xxx...</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="配置问题"><a href="#配置问题" class="headerlink" title="配置问题"></a>配置问题</h3><details class="folding-tag" green><summary> Q: 修改 settings.json 后不生效 </summary>              <div class='content'>              <p>重启 Claude Code:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭所有 Claude Code 窗口</span></span><br><span class="line"><span class="comment"># 重新打开终端</span></span><br><span class="line">claude</span><br></pre></td></tr></table></figure><p>如果还不生效, 检查 JSON 格式:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 验证 JSON 格式</span></span><br><span class="line"><span class="built_in">cat</span> ~/.claude/settings.json | python -m json.tool</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> Q: 模型切换失败 </summary>              <div class='content'>              <p>检查模型名称:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前模型</span></span><br><span class="line">claude &gt; /status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看可用模型</span></span><br><span class="line">claude &gt; /model list</span><br></pre></td></tr></table></figure><p>确保模型名称正确:</p><ul><li>Haiku: <code>glm-4.5-air</code></li><li>Sonnet: <code>glm-4.7</code></li><li>Opus: <code>glm-4.7</code></li></ul>              </div>            </details><h3 id="使用问题"><a href="#使用问题" class="headerlink" title="使用问题"></a>使用问题</h3><details class="folding-tag" cyan><summary> Q: 响应速度慢 </summary>              <div class='content'>              <p>可能的原因和解决方案:</p><ol><li><strong>代码库太大</strong>: 使用具体路径而非通配符</li><li><strong>输出 token 限制太小</strong>: 增加 <code>CLAUDE_CODE_MAX_OUTPUT_TOKENS</code></li><li><strong>网络慢</strong>: 配置代理或使用国内服务</li><li><strong>模型太重</strong>: 切换到 Haiku 处理简单任务</li></ol>              </div>            </details><details class="folding-tag" cyan><summary> Q: 生成的代码有错误 </summary>              <div class='content'>              <p>提供更详细的上下文:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 不好</span><br><span class="line">修复这个 bug</span><br><span class="line"></span><br><span class="line"># 好</span><br><span class="line">修复以下 bug: 当用户名包含中文时, 登录失败.</span><br><span class="line">文件: src/api/auth.ts</span><br><span class="line">函数: login()</span><br><span class="line">错误信息: &quot;Invalid username&quot;</span><br><span class="line">期望行为: 支持中文用户名</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> Q: 如何回滚 Claude Code 的修改 </summary>              <div class='content'>              <p>使用 Git:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看变更</span></span><br><span class="line">git diff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 撤销未提交的修改</span></span><br><span class="line">git checkout -- &lt;file&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回滚已提交的修改</span></span><br><span class="line">git revert &lt;commit-hash&gt;</span><br></pre></td></tr></table></figure><p>P.S. Claude Code 的所有操作都会经过 Git, 可以随时回滚。</p>              </div>            </details><h3 id="MCP-问题"><a href="#MCP-问题" class="headerlink" title="MCP 问题"></a>MCP 问题</h3><details class="folding-tag" red><summary> Q: MCP 服务器无法连接 </summary>              <div class='content'>              <p>检查 MCP 配置:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 MCP 列表</span></span><br><span class="line">claude mcp list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 MCP 日志</span></span><br><span class="line">claude mcp logs &lt;mcp-name&gt;</span><br></pre></td></tr></table></figure><p>常见问题:</p><ul><li>端口被占用: 更换端口</li><li>认证失败: 检查 API Key</li><li>网络不通: 配置代理</li></ul>              </div>            </details><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><div class="tag link"><a class="link-card" title="Claude Code 官网" href="https://code.claude.com"><div class="left"><img src="https://avatars.githubusercontent.com/u/81847?v=4"/></div><div class="right"><p class="text">Claude Code 官网</p><p class="url">https://code.claude.com</p></div></a></div><div class="tag link"><a class="link-card" title="Claude Code 开发者文档" href="https://docs.anthropic.com/en/docs/claude-code/overview"><div class="left"><img src="https://avatars.githubusercontent.com/u/81847?v=4"/></div><div class="right"><p class="text">Claude Code 开发者文档</p><p class="url">https://docs.anthropic.com/en/docs/claude-code/overview</p></div></a></div><div class="tag link"><a class="link-card" title="MCP 协议规范" href="https://docs.anthropic.com/en/docs/build-with-claude/mcp"><div class="left"><img src="https://avatars.githubusercontent.com/u/182288589?s=200&v=4"/></div><div class="right"><p class="text">MCP 协议规范</p><p class="url">https://docs.anthropic.com/en/docs/build-with-claude/mcp</p></div></a></div><div class="tag link"><a class="link-card" title="Claude API 文档" href="https://docs.anthropic.com/en/api/index"><div class="left"><img src="https://avatars.githubusercontent.com/u/81847?v=4"/></div><div class="right"><p class="text">Claude API 文档</p><p class="url">https://docs.anthropic.com/en/api/index</p></div></a></div><h3 id="社区资源"><a href="#社区资源" class="headerlink" title="社区资源"></a>社区资源</h3><div class="tag link"><a class="link-card" title="anthropics/claude-code" href="https://github.com/anthropics/claude-code"><div class="left"><img src="https://avatars.githubusercontent.com/u/76263028?s=48&v=4"/></div><div class="right"><p class="text">anthropics/claude-code</p><p class="url">https://github.com/anthropics/claude-code</p></div></a></div><div class="tag link"><a class="link-card" title="MCP 服务器列表" href="https://github.com/modelcontextprotocol"><div class="left"><img src="https://avatars.githubusercontent.com/u/182288589?s=200&v=4"/></div><div class="right"><p class="text">MCP 服务器列表</p><p class="url">https://github.com/modelcontextprotocol</p></div></a></div><h3 id="国内资源"><a href="#国内资源" class="headerlink" title="国内资源"></a>国内资源</h3><div class="tag link"><a class="link-card" title="智谱 GLM-4.7 接入指南" href="https://docs.z.ai/scenario-example/develop-tools/claude"><div class="left"><img src="https://cdn.bigmodel.cn/static/logo/dark.svg"/></div><div class="right"><p class="text">智谱 GLM-4.7 接入指南</p><p class="url">https://docs.z.ai/scenario-example/develop-tools/claude</p></div></a></div><div class="tag link"><a class="link-card" title="智谱 AI 开放平台" href="https://open.bigmodel.cn"><div class="left"><img src="https://cdn.bigmodel.cn/static/logo/dark.svg"/></div><div class="right"><p class="text">智谱 AI 开放平台</p><p class="url">https://open.bigmodel.cn</p></div></a></div><div class="tag link"><a class="link-card" title="z.ai 文档" href="https://docs.z.ai"><div class="left"><img src="https://cdn.bigmodel.cn/static/logo/dark.svg"/></div><div class="right"><p class="text">z.ai 文档</p><p class="url">https://docs.z.ai</p></div></a></div><h3 id="相关工具"><a href="#相关工具" class="headerlink" title="相关工具"></a>相关工具</h3><div class="tag link"><a class="link-card" title="Cursor IDE" href="https://cursor.sh"><div class="left"><img src="https://cursor.sh/favicon.ico"/></div><div class="right"><p class="text">Cursor IDE</p><p class="url">https://cursor.sh</p></div></a></div><div class="tag link"><a class="link-card" title="Windsurf IDE" href="https://windsurf.ai"><div class="left"><img src="https://windsurf.ai/favicon.ico"/></div><div class="right"><p class="text">Windsurf IDE</p><p class="url">https://windsurf.ai</p></div></a></div><div class="tag link"><a class="link-card" title="Aider" href="https://aider.chat"><div class="left"><img src="https://aider.chat//assets/logo.svg"/></div><div class="right"><p class="text">Aider</p><p class="url">https://aider.chat</p></div></a></div><hr><div class="note success flat"><p>✅ 到这里, Claude Code 的安装、认证、GLM-4.7 接入与基本使用已完整搭建完成。下一篇文章将重点介绍如何基于此环境实现多模型动态路由、自定义 agent 行为, 以及在真实业务项目中的最佳实践。</p></div>]]></content>
      
      
      <categories>
          
          <category> AI开发 </category>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Claude-Code </tag>
            
            <tag> GLM-4.7 </tag>
            
            <tag> Terminal </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenCode 安装配置</title>
      <link href="/posts/c97f2813/"/>
      <url>/posts/c97f2813/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><div class="note info flat"><p>OpenCode 是一个开源的 AI 编程助手，提供多种使用形态，包括命令行（CLI）、客户端、IDE 插件和云端环境。</p></div><p><strong>核心优势</strong>:</p><ul><li>免费模型支持，开箱即用</li><li>开源，灵活可扩展</li><li>四种使用形态，满足不同场景</li><li>强大的插件生态系统</li></ul><div class="tag link"><a class="link-card" title="OpenCode" href="https://github.com/anomalyco/opencode"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">OpenCode</p><p class="url">https://github.com/anomalyco/opencode</p></div></a></div><div class="tag link"><a class="link-card" title="Oh-My-OpenCode" href="https://github.com/code-yeongyu/oh-my-opencode"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Oh-My-OpenCode</p><p class="url">https://github.com/code-yeongyu/oh-my-opencode</p></div></a></div><hr><h2 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h2><h3 id="CLI-安装"><a href="#CLI-安装" class="headerlink" title="CLI 安装"></a>CLI 安装</h3><p>OpenCode 提供了多种安装方式，适配不同的操作系统和包管理器。</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fab fa-linux"></i>Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>方式一: Homebrew（推荐）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用官方 tap（始终最新）</span></span><br><span class="line">brew install anomalyco/tap/opencode</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用官方 formula（更新较慢）</span></span><br><span class="line">brew install opencode</span><br></pre></td></tr></table></figure><p><strong>方式二: NPM</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g opencode-ai@latest</span><br></pre></td></tr></table></figure><p><strong>方式三: 快速安装脚本</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://opencode.ai/install | bash</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>方式一: Chocolatey</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install opencode</span><br></pre></td></tr></table></figure><p><strong>方式二: Scoop</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add extras</span><br><span class="line">scoop install extras/opencode</span><br></pre></td></tr></table></figure><p><strong>方式三: NPM</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i <span class="literal">-g</span> opencode<span class="literal">-ai</span>@latest</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p><strong>Arch Linux</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paru -S opencode-bin</span><br></pre></td></tr></table></figure><p><strong>通用方式</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NPM/Bun/PNPM/Yarn</span></span><br><span class="line">npm i -g opencode-ai@latest</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">bun add -g opencode-ai</span><br><span class="line"></span><br><span class="line"><span class="comment"># 快速安装脚本</span></span><br><span class="line">curl -fsSL https://opencode.ai/install | bash</span><br></pre></td></tr></table></figure><p><strong>方式四: Mise（跨平台）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mise use -g opencode</span><br></pre></td></tr></table></figure><p><strong>方式五: Nix</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nix run nixpkgs#opencode</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="客户端安装"><a href="#客户端安装" class="headerlink" title="客户端安装"></a>客户端安装</h3><h4 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install --cask opencode-desktop</span><br></pre></td></tr></table></figure><h4 id="下载页面"><a href="#下载页面" class="headerlink" title="下载页面"></a>下载页面</h4><a class="btn-beautify green" href="https://opencode.ai/download" title="下载 OpenCode 客户端"><i class="icon:fa-solid fa-download"></i><span>下载 OpenCode 客户端</span></a><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-OpenCode.png" alt="进入OpenCode客户端"></p><div class="note warning flat"><p>注意：客户端目前处于 Beta 测试阶段，Bug 较多，建议以命令行为主。</p></div><h3 id="IDE-插件安装"><a href="#IDE-插件安装" class="headerlink" title="IDE 插件安装"></a>IDE 插件安装</h3><h4 id="VSCode"><a href="#VSCode" class="headerlink" title="VSCode"></a>VSCode</h4><ol><li>在 VSCode 插件市场搜索 <code>OpenCode</code></li><li>安装 <code>OpenCode for VSCode</code> 插件</li></ol><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-OpenCode_for_vscode.png" alt="OpenCode_for_VScode"></p><p><strong>快捷键</strong>:</p><ul><li>Windows: <code>Ctrl</code> + <code>Shift</code> + <code>P</code></li><li>macOS: <code>Cmd</code> + <code>Shift</code> + <code>P</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-vscode%E6%89%93%E5%BC%80opencode.png" alt="vscode打开opencode命令面板"></p><div class="tag link"><a class="link-card" title="OpenCode for VSCode" href="https://marketplace.visualstudio.com/items?itemName=anomalyco.opencode-vscode"><div class="left"><img src="https://marketplace.visualstudio.com/favicon.ico"/></div><div class="right"><p class="text">OpenCode for VSCode</p><p class="url">https://marketplace.visualstudio.com/items?itemName=anomalyco.opencode-vscode</p></div></a></div><h3 id="启动-OpenCode"><a href="#启动-OpenCode" class="headerlink" title="启动 OpenCode"></a>启动 OpenCode</h3><p>安装完成后，在项目目录下运行:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opencode</span><br></pre></td></tr></table></figure><p>这将启动 OpenCode 的交互式终端界面（TUI）。</p><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E8%BF%9B%E5%85%A5opencode.png" alt="进入OpenCode命令行界面"></p><hr><h2 id="免费模型配置"><a href="#免费模型配置" class="headerlink" title="免费模型配置"></a>免费模型配置</h2><h3 id="查看可用模型"><a href="#查看可用模型" class="headerlink" title="查看可用模型"></a>查看可用模型</h3><p>在 OpenCode 中输入以下命令查看免费模型:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/models</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-opencoe%E9%80%89%E6%8B%A9%E6%A8%A1%E5%9E%8B.png" alt="opencode选择模型"></p><h3 id="Antigravity-插件（Google-Gemini-3-Pro，Claude-Opus-4-5）"><a href="#Antigravity-插件（Google-Gemini-3-Pro，Claude-Opus-4-5）" class="headerlink" title="Antigravity 插件（Google Gemini 3 Pro，Claude Opus 4.5）"></a>Antigravity 插件（Google Gemini 3 Pro，Claude Opus 4.5）</h3><div class="tag link"><a class="link-card" title="OpenCode Antigravity Auth" href="https://github.com/NoeFabris/opencode-antigravity-auth"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">OpenCode Antigravity Auth</p><p class="url">https://github.com/NoeFabris/opencode-antigravity-auth</p></div></a></div><p>Antigravity 是 Google 推出的 AI 编程 IDE，内置免费的 Gemini 3 Pro 和 Claude Opus 4.5 模型。通过该插件，可以免费使用这两个顶级的编程模型。</p><p><strong>安装方式</strong>:</p><p>在 OpenCode 中发送以下命令，将自动安装:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install the opencode-antigravity-auth plugin and add the Antigravity model definitions to ~/.config/opencode/opencode.json by following: https://raw.githubusercontent.com/NoeFabris/opencode-antigravity-auth/dev/README.md</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E5%AE%89%E8%A3%85opencode%E6%8F%92%E4%BB%B6.png" alt="安装opencode-antigravity-auth插件"></p><p><strong>认证步骤</strong>:</p><ol><li>打开新的命令行窗口</li><li>执行认证命令:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opencode auth login</span><br></pre></td></tr></table></figure><ol><li>在浏览器中登录 Google 账号</li></ol><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%20antigravity%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81.png" alt="Antigravity登录认证"></p><ol><li>验证成功后，重启 OpenCode</li><li>输入 <code>/models</code> 切换到 Google 模型</li></ol><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E5%88%87%E6%8D%A2google%E6%A8%A1%E5%9E%8B.png" alt="切换到Google模型"></p><div class="note info flat"><p>P.S. Antigravity 提供的模型需要通过 Google 账号认证，使用时注意网络环境。</p></div><h3 id="接入-ChatGPT-CodeX"><a href="#接入-ChatGPT-CodeX" class="headerlink" title="接入 ChatGPT CodeX"></a>接入 ChatGPT CodeX</h3><p><strong>前提条件</strong>: 需要订阅 ChatGPT Plus 或更高级别会员</p><p><strong>配置步骤</strong>:</p><ol><li>在 OpenCode CLI 中输入 <code>/connect</code></li><li>选择 <code>OpenAI</code></li><li>选择 <code>ChatGPT Pro/Plus</code></li><li>在浏览器打开认证链接</li><li>登录并完成认证</li><li>在 OpenCode 中输入 <code>/models</code> 后，可以选择 ChatGPT 的编程模型</li></ol><h3 id="OpenRouter-集成"><a href="#OpenRouter-集成" class="headerlink" title="OpenRouter 集成"></a>OpenRouter 集成</h3><div class="note success flat"><p>P.S. 输入 <code>/connect</code> 可以查到市面上几乎所有的模型供应商</p></div><p><strong>配置步骤</strong>:</p><ol><li>在 OpenCode 中输入 <code>/connect</code></li><li>选择 <code>Other</code> 中的 <code>openrouter</code></li><li>访问 OpenRouter 官网: <a href="https://openrouter.ai/">https://openrouter.ai/</a></li><li>获取 API Key</li><li>填写 API Key 后，即可连接到几乎所有模型供应商</li></ol><hr><h2 id="功能亮点"><a href="#功能亮点" class="headerlink" title="功能亮点"></a>功能亮点</h2><h3 id="Session-管理"><a href="#Session-管理" class="headerlink" title="Session 管理"></a>Session 管理</h3><p><strong>概念</strong>: 每次与 AI 开启的新对话就是一个全新的 Session，可以在后台运行，支持多个 Session 并行执行。</p><p><strong>Session 相关命令</strong>:</p><div class="table-container"><table><thead><tr><th>命令</th><th>功能</th></tr></thead><tbody><tr><td><code>/session</code></td><td>显示 Session 列表，查看运行状态，切换 Session</td></tr><tr><td><code>/new</code></td><td>创建全新的 Session</td></tr></tbody></table></div><p><strong>Session 管理功能</strong>:</p><ul><li>后台运行多个任务</li><li>并行执行不同的 Session</li><li>查看 Session 的实时状态</li><li>在 Session 之间快速切换</li></ul><div class="tag link"><a class="link-card" title="SDK 文档" href="https://opencode.ai/docs/sdk.mdx"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">SDK 文档</p><p class="url">https://opencode.ai/docs/sdk.mdx</p></div></a></div><h3 id="Share-分享"><a href="#Share-分享" class="headerlink" title="Share 分享"></a>Share 分享</h3><p><strong>功能</strong>: 将当前 Session 的对话以 URL 链接的形式分享为在线网页</p><p><strong>使用方法</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/share</span><br></pre></td></tr></table></figure><div class="note default flat"><p>P.S. 分享链接可以直接在浏览器中查看完整的对话记录，方便团队协作和代码审查。</p></div><h3 id="Timeline-时间线回退"><a href="#Timeline-时间线回退" class="headerlink" title="Timeline 时间线回退"></a>Timeline 时间线回退</h3><p><strong>功能</strong>: 查看当前 Session 的完整对话记录，并可以将代码和内容回退到任意一次对话之前的状态。</p><p><strong>使用方法</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/timeline</span><br></pre></td></tr></table></figure><p><strong>操作步骤</strong>:</p><ol><li>输入 <code>/timeline</code> 查看时间线</li><li>选择任意一次对话记录</li><li>选择 <code>Revert</code> 选项</li><li>代码和内容将回退到该对话之前的状态</li></ol><div class="note info flat"><p>e.g. 假设在实现功能过程中发现方向错误，可以使用 Timeline 快速回退到之前的正确状态，避免手动撤销多个步骤。</p></div><hr><h2 id="Skills-与-MCP-配置"><a href="#Skills-与-MCP-配置" class="headerlink" title="Skills 与 MCP 配置"></a>Skills 与 MCP 配置</h2><h3 id="Skills-机制"><a href="#Skills-机制" class="headerlink" title="Skills 机制"></a>Skills 机制</h3><p><strong>目录结构</strong>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">项目目录/</span><br><span class="line">├── .claude/</span><br><span class="line">│   └── skills/</span><br><span class="line">│       ├── skill-name1/</span><br><span class="line">│       │   └── SKILL.md</span><br><span class="line">│       └── skill-name2/</span><br><span class="line">│           └── SKILL.md</span><br></pre></td></tr></table></figure><p><strong>Claude Code 到 OpenCode 的迁移</strong>:</p><p>只需要将 <code>.claude</code> 目录替换为 <code>.opencode</code> 目录。OpenCode 兼容 Claude Code 的 Skills 格式，不修改也可以直接使用。</p><h3 id="MCP-服务器配置"><a href="#MCP-服务器配置" class="headerlink" title="MCP 服务器配置"></a>MCP 服务器配置</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fas fa-desktop"></i>Local MCP（本地命令调用）</button><button type="button" class="tab"><i class="fas fa-cloud"></i>Remote MCP（远程服务器）</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>配置文件位置</strong>: <code>~/.config/opencode/opencode.json</code></p><p><strong>配置示例</strong>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;$schema&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://opencode.ai/config.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mcp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;my-local-mcp-server&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;local&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;npx&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;my-mcp-command&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;environment&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;MY_ENV_VAR&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my_env_var_value&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>实际案例 - Shadcn MCP</strong>:</p><details class="folding-tag" blue><summary> 查看配置代码 </summary>              <div class='content'>              <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;$schema&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://opencode.ai/config.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plugin&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;opencode-antigravity-auth@latest&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mcp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;shadcn&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;local&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;npx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;-y&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;shadcn@latest&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;mcp&quot;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>              </div>            </details><div class="tag link"><a class="link-card" title="" href=""><div class="left"><img src="/img/link.png"/></div><div class="right"><p class="text"></p><p class="url"></p></div></a></div></div><div class="tab-item-content"><p><strong>配置示例</strong>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;$schema&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://opencode.ai/config.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mcp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;context7&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;remote&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mcp.context7.com/mcp&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;CONTEXT7_API_KEY&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ctx7sk-df4f046b-125d-4083-a908-764d55da99fd&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="note primary flat"><p>Context7 说明: Context7 是一个基于 MCP 的工具，为大型语言模型和 AI 代码编辑器提供最新、版本特定的官方文档和代码示例，帮助减少过时信息和生成错误代码的问题。</p></div><div class="tag link"><a class="link-card" title="" href=""><div class="left"><img src="/img/link.png"/></div><div class="right"><p class="text"></p><p class="url"></p></div></a></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="验证-MCP-配置"><a href="#验证-MCP-配置" class="headerlink" title="验证 MCP 配置"></a>验证 MCP 配置</h3><p>配置完成后:</p><ol><li>退出 OpenCode: <code>/exit</code></li><li>重新启动: <code>opencode</code></li><li>查看 MCP 服务器: <code>/mcp</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-opencode%E9%85%8D%E7%BD%AEmcp.png" alt="opencode配置mcps"></p><hr><h2 id="OMO-插件（Oh-My-OpenCode）"><a href="#OMO-插件（Oh-My-OpenCode）" class="headerlink" title="OMO 插件（Oh My OpenCode）"></a>OMO 插件（Oh My OpenCode）</h2><div class="tag link"><a class="link-card" title="Oh-My-OpenCode" href="https://github.com/code-yeongyu/oh-my-opencode"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Oh-My-OpenCode</p><p class="url">https://github.com/code-yeongyu/oh-my-opencode</p></div></a></div><p>Oh My OpenCode 是 OpenCode 最热门的编程插件，本质上是预设 Tools + 预设 MCP + 预设 Agent 的捆绑包。</p><h3 id="预设功能"><a href="#预设功能" class="headerlink" title="预设功能"></a>预设功能</h3><h4 id="预设-Tools"><a href="#预设-Tools" class="headerlink" title="预设 Tools"></a>预设 Tools</h4><ol><li><strong>LSP 高级版</strong>: 通过编程语言的语法和定义，帮助 AI 快速定位理解代码</li><li><strong>AST</strong>: 抽象语法树分析</li><li><strong>Look At</strong>: 查看和分析文件内容</li><li><strong>Delegate-Task</strong>: Agent 任务分配</li><li><strong>Background-Task</strong>: Agent 后台调度</li></ol><h4 id="预设-MCP"><a href="#预设-MCP" class="headerlink" title="预设 MCP"></a>预设 MCP</h4><ul><li><strong>Web Search</strong>: 网络搜索</li><li><strong>Context7</strong>: 官方文档查询</li><li><strong>Grep App</strong>: 代码搜索</li></ul><h3 id="预设智能体"><a href="#预设智能体" class="headerlink" title="预设智能体"></a>预设智能体</h3><p>插件内置了 7 大编程智能体，每个智能体分配了最适合的 AI 模型:</p><div class="table-container"><table><thead><tr><th>智能体名称</th><th>职责</th><th>说明</th></tr></thead><tbody><tr><td>Sisyphus</td><td>主智能体</td><td>规划和调度任务</td></tr><tr><td>Oracle</td><td>架构师</td><td>架构设计、代码评审</td></tr><tr><td>Librarian</td><td>图书管理员</td><td>查找文档、代码示例</td></tr><tr><td>Explore</td><td>探索者</td><td>代码库分析、模式发现</td></tr><tr><td>Frontend UI/UX Engineer</td><td>前端工程师</td><td>UI/UX 设计和实现</td></tr><tr><td>Document Writer</td><td>文档编写者</td><td>技术文档编写</td></tr><tr><td>Multimodal Looker</td><td>多模态观察者</td><td>图片、PDF 等媒体分析</td></tr></tbody></table></div><h3 id="安装-OMO-插件"><a href="#安装-OMO-插件" class="headerlink" title="安装 OMO 插件"></a>安装 OMO 插件</h3><p><strong>安装命令</strong>:</p><p>在 OpenCode 中发送:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install and configure by following the instructions here https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/refs/heads/master/README.md</span><br></pre></td></tr></table></figure><p><strong>配置步骤</strong>:</p><ol><li>根据提示确认是否拥有 Claude、GPT、Gemini 的订阅</li><li>等待安装完成</li><li>配置文件位置: <code>~/.config/opencode/oh-my-opencode.json</code></li></ol><h3 id="OMO-插件使用方法"><a href="#OMO-插件使用方法" class="headerlink" title="OMO 插件使用方法"></a>OMO 插件使用方法</h3><h4 id="方法一-智能体选择"><a href="#方法一-智能体选择" class="headerlink" title="方法一: 智能体选择"></a>方法一: 智能体选择</h4><ol><li>输入 <code>@</code> 符号</li><li>挑选其中一个智能体进行工作</li></ol><h4 id="方法二-Ultra-Work（ulw）"><a href="#方法二-Ultra-Work（ulw）" class="headerlink" title="方法二: Ultra Work（ulw）"></a>方法二: Ultra Work（ulw）</h4><p><strong>魔法词</strong>: <code>ulw</code></p><p>输入 <code>ulw</code> 后，OMO 插件将调用一切潜能:</p><ul><li>综合调度各个领域最强的模型</li><li>主智能体 <code>Sisyphus</code> 将任务分配给其他智能体</li><li>后台同时开启多个任务，并行执行</li><li>将问题做成 Todo List，实时跟踪进度</li></ul><div class="note success flat"><p>e.g. 输入 <code>ulw 实现一个完整的用户认证系统</code>，插件将自动:</p><ul><li>调用 Oracle 设计架构</li><li>调用 Explore 分析现有代码</li><li>调用 Frontend Engineer 实现 UI</li><li>调用 Document Writer 编写文档</li><li>所有任务并行执行</li></ul></div><h4 id="方法三-Ralph-Loop"><a href="#方法三-Ralph-Loop" class="headerlink" title="方法三: Ralph Loop"></a>方法三: Ralph Loop</h4><p><strong>命令</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ralph-loop</span><br></pre></td></tr></table></figure><p><strong>拉尔夫循环模式</strong>: 强制 AI 长时间循环，对非常复杂的任务进行持续工作，直到任务完成。</p><div class="note warning flat"><p>P.S. 可以连续运行数小时，适合处理大型重构、复杂 bug 修复等需要长期专注的任务。</p></div><hr><h2 id="云端环境"><a href="#云端环境" class="headerlink" title="云端环境"></a>云端环境</h2><h3 id="GitHub-集成"><a href="#GitHub-集成" class="headerlink" title="GitHub 集成"></a>GitHub 集成</h3><p>OpenCode 支持在 GitHub 的 Issue 中通过 <code>/opencode</code> 命令调用 AI 进行工作。</p><p><strong>主要功能</strong>:</p><ul><li>在 GitHub 云端解释问题</li><li>自动修复问题</li><li>创建 Pull Request</li></ul><div class="tag link"><a class="link-card" title="" href=""><div class="left"><img src="/img/link.png"/></div><div class="right"><p class="text"></p><p class="url"></p></div></a></div><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fas fa-terminal"></i>CLI 命令安装</button><button type="button" class="tab"><i class="fas fa-cog"></i>手动配置</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opencode github install</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li>创建工作流文件 <code>.github/workflows/opencode.yml</code>:</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">opencode</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">issue_comment:</span></span><br><span class="line">    <span class="attr">types:</span> [<span class="string">created</span>]</span><br><span class="line">  <span class="attr">pull_request_review_comment:</span></span><br><span class="line">    <span class="attr">types:</span> [<span class="string">created</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">opencode:</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      contains(github.event.comment.body, &#x27;/oc&#x27;) ||</span></span><br><span class="line"><span class="string">      contains(github.event.comment.body, &#x27;/opencode&#x27;)</span></span><br><span class="line"><span class="string"></span>    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">permissions:</span></span><br><span class="line">      <span class="attr">id-token:</span> <span class="string">write</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">repository</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v6</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">fetch-depth:</span> <span class="number">1</span></span><br><span class="line">          <span class="attr">persist-credentials:</span> <span class="literal">false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">OpenCode</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">anomalyco/opencode/github@latest</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">ANTHROPIC_API_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ANTHROPIC_API_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">model:</span> <span class="string">anthropic/claude-sonnet-4-20250514</span></span><br></pre></td></tr></table></figure><ol><li>选择模型供应商（仅支持 API Key）</li><li>将 <code>.github/workflows/opencode.yml</code> 提交到 GitHub 公开仓库</li><li>在 GitHub 设置页面的 <code>Actions</code> 中添加模型供应商的 API Key</li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ol><li>在 GitHub Issue 或 PR 中添加评论</li><li>输入 <code>/opencode</code> 或 <code>/oc</code> 加上具体指令</li><li>e.g. <code>/opencode 修复这个 bug: [详细描述]</code></li><li>Actions 开始执行，在 Actions 页面查看进度</li><li>执行完成后，可以在 Pull Requests 中看到代码变更</li><li>审查后点击 <code>Merge pull request</code> 合并代码</li></ol><hr><h2 id="高级功能"><a href="#高级功能" class="headerlink" title="高级功能"></a>高级功能</h2><h3 id="项目初始化（-init）"><a href="#项目初始化（-init）" class="headerlink" title="项目初始化（/init）"></a>项目初始化（/init）</h3><p><strong>功能</strong>: 让 AI 通读整个项目文件夹，将学到的知识生成到 <code>AGENTS.md</code> 文件中。</p><p><strong>作用</strong>: 类似 Claude Code 的 <code>CLAUDE.md</code>，该文件作为整个项目的系统提示词，帮助 AI 快速了解项目结构、技术栈和业务逻辑。</p><p><strong>使用方法</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/init</span><br></pre></td></tr></table></figure><div class="note info flat"><p>P.S. 建议在新项目加入时或项目结构发生重大变化时执行，保持 <code>AGENTS.md</code> 的准确性。</p></div><h3 id="上下文压缩（-compact）"><a href="#上下文压缩（-compact）" class="headerlink" title="上下文压缩（/compact）"></a>上下文压缩（/compact）</h3><p><strong>功能</strong>: 压缩当前对话的上下文，提炼关键信息。</p><p><strong>使用场景</strong>:</p><ul><li>对话过长，接近 token 限制</li><li>需要保留关键信息，丢弃无关细节</li></ul><p><strong>使用方法</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/compact</span><br></pre></td></tr></table></figure><h3 id="自定义命令"><a href="#自定义命令" class="headerlink" title="自定义命令"></a>自定义命令</h3><p><strong>配置目录</strong>: <code>~/.config/opencode/commands</code></p><p><strong>创建方法</strong>:</p><p>在 commands 目录中创建 markdown 文件，e.g. <code>test.md</code>:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">description: Run unit tests with coverage</span><br><span class="line">agent: run<span class="emphasis">_test</span></span><br><span class="line"><span class="emphasis">model: anthropic/claude-haiku-4-5</span></span><br><span class="line"><span class="emphasis">---</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Run the full test suite with coverage report.</span></span><br><span class="line"><span class="emphasis">Focus on the failing tests and suggest fixes.</span></span><br></pre></td></tr></table></figure><p><strong>使用方法</strong>:</p><p>在 OpenCode 中通过 <code>/$&#123;command_name&#125;</code> 运行:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/test</span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 查看配置文件方式 </summary>              <div class='content'>              <p>也可以在 <code>~/.config/opencode/opencode.json</code> 中配置:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;$schema&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://opencode.ai/config.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;template&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Run the test suite with coverage. Show failing tests and suggest fixes.&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Run tests with coverage&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;agent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;anthropic/claude-haiku-4-5&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;review&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;template&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Review the changes in this PR: $ARGUMENTS\nFocus on code quality, potential bugs, and adherence to project conventions.&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Review a pull request&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;agent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;code-reviewer&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>              </div>            </details><div class="tag link"><a class="link-card" title="" href=""><div class="left"><img src="/img/link.png"/></div><div class="right"><p class="text"></p><p class="url"></p></div></a></div><h3 id="自定义智能体"><a href="#自定义智能体" class="headerlink" title="自定义智能体"></a>自定义智能体</h3><p><strong>配置目录</strong>: <code>~/.config/opencode/agents</code></p><p><strong>创建方法</strong>:</p><p>在 agents 目录中创建 markdown 文件，e.g. <code>code_review.md</code>:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">description: Reviews code for best practices and potential issues</span><br><span class="line">mode: subagent</span><br><span class="line"><span class="section">model: anthropic/claude-sonnet-4-20250514</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line">You are a code reviewer. Focus on:</span><br><span class="line"><span class="bullet">-</span> Security vulnerabilities</span><br><span class="line"><span class="bullet">-</span> Performance issues</span><br><span class="line"><span class="bullet">-</span> Code maintainability</span><br><span class="line"><span class="bullet">-</span> Best practices adherence</span><br><span class="line"><span class="bullet">-</span> Potential bugs</span><br></pre></td></tr></table></figure><p><strong>Agent 类型</strong>:</p><div class="table-container"><table><thead><tr><th>类型</th><th>说明</th><th>调用方式</th></tr></thead><tbody><tr><td>primary</td><td>主智能体</td><td>通过 Tab 键切换</td></tr><tr><td>subagent</td><td>子智能体</td><td>由主智能体后台调用</td></tr></tbody></table></div><details class="folding-tag" cyan><summary> 查看配置文件方式 </summary>              <div class='content'>              <p>在 <code>~/.config/opencode/opencode.json</code> 中配置:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;$schema&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://opencode.ai/config.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;agent&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;primary&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;anthropic/claude-sonnet-4-20250514&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;file:./prompts/build.txt&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;write&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;edit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bash&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;plan&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;primary&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;anthropic/claude-haiku-4-5&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;write&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;edit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bash&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;code-reviewer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Reviews code for best practices and potential issues&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;subagent&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;anthropic/claude-sonnet-4-20250514&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;You are a code reviewer. Focus on security, performance, and maintainability.&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;write&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;edit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>使用方法</strong>:</p><ul><li>主智能体: 在 OpenCode 中按 Tab 键切换</li><li>子智能体: 由主智能体自动调度，后台运行</li></ul><div class="tag link"><a class="link-card" title="" href=""><div class="left"><img src="/img/link.png"/></div><div class="right"><p class="text"></p><p class="url"></p></div></a></div><hr><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="项目管理"><a href="#项目管理" class="headerlink" title="项目管理"></a>项目管理</h3><ol><li><strong>初始化项目</strong>: 使用 <code>/init</code> 生成 AGENTS.md，让 AI 了解项目</li><li><strong>使用 Todo List</strong>: 复杂任务使用 <code>ulw</code> 或手动创建 Todo List，跟踪进度</li><li><strong>利用 Timeline</strong>: 实验性功能开发时使用 Timeline，方便回退</li><li><strong>Session 管理</strong>: 不同功能使用不同 Session，保持上下文清晰</li></ol><h3 id="插件使用"><a href="#插件使用" class="headerlink" title="插件使用"></a>插件使用</h3><ol><li><strong>安装 OMO 插件</strong>: 优先安装 Oh My OpenCode，获得完整功能</li><li><strong>配置 MCP</strong>: 根据项目需求配置必要的 MCP 服务器</li><li><strong>使用合适模型</strong>:<ul><li>简单任务: 使用 Haiku（快速便宜）</li><li>复杂任务: 使用 Sonnet（平衡性能）</li><li>代码生成: 使用 Claude Sonnet/GPT-4</li><li>文档编写: 使用 GPT-4/Claude Opus</li></ul></li></ol><h3 id="效率提升"><a href="#效率提升" class="headerlink" title="效率提升"></a>效率提升</h3><ol><li><strong>自定义命令</strong>: 将重复性操作定义为自定义命令，e.g. <code>/test</code> 运行测试</li><li><strong>智能体分工</strong>: 使用 OMO 的 7 大智能体，让每个 AI 发挥专长</li><li><strong>并行执行</strong>: 使用 <code>ulw</code> 或 <code>background_task</code> 并行处理多个任务</li><li><strong>上下文管理</strong>: 及时使用 <code>/compact</code> 压缩对话，节省 token</li></ol><h3 id="团队协作"><a href="#团队协作" class="headerlink" title="团队协作"></a>团队协作</h3><ol><li><strong>Share 分享</strong>: 使用 <code>/share</code> 分享对话，团队成员可以查看完整过程</li><li><strong>GitHub 集成</strong>: 配置云端环境，在 Issue 中直接调用 AI 修复 bug</li><li><strong>统一配置</strong>: 将 <code>.opencode</code> 目录纳入版本控制，统一团队配置</li></ol><hr><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="Q1-OpenCode-与-Claude-Code-有什么区别"><a href="#Q1-OpenCode-与-Claude-Code-有什么区别" class="headerlink" title="Q1: OpenCode 与 Claude Code 有什么区别?"></a>Q1: OpenCode 与 Claude Code 有什么区别?</h3><div class="table-container"><table><thead><tr><th>特性</th><th>OpenCode</th><th>Claude Code</th></tr></thead><tbody><tr><td>开源性</td><td>完全开源</td><td>闭源</td></tr><tr><td>模型支持</td><td>不限模型</td><td>仅支持 Claude</td></tr><tr><td>插件系统</td><td>丰富插件</td><td>有限</td></tr><tr><td>免费模型</td><td>支持 Gemini、Antigravity 等</td><td>仅 Claude</td></tr><tr><td>跨平台</td><td>完整支持 macOS/Windows/Linux</td><td>限制较多</td></tr></tbody></table></div><h3 id="Q2-如何选择合适的模型"><a href="#Q2-如何选择合适的模型" class="headerlink" title="Q2: 如何选择合适的模型?"></a>Q2: 如何选择合适的模型?</h3><p><strong>简单任务</strong>（代码解释、小修改）:</p><ul><li>Claude Haiku 4.5（快速、便宜）</li></ul><p><strong>常规开发</strong>（功能实现、代码重构）:</p><ul><li>Claude Sonnet 4（平衡性能）</li></ul><p><strong>复杂任务</strong>（架构设计、文档编写）:</p><ul><li>Claude Opus 4.5 / GPT-4（最强性能）</li></ul><p><strong>特定领域</strong>:</p><ul><li>前端开发: GPT-4o</li><li>后端开发: Claude Sonnet 4</li><li>安全审计: Claude Opus 4.5</li></ul><h3 id="Q3-MCP-配置后无法使用"><a href="#Q3-MCP-配置后无法使用" class="headerlink" title="Q3: MCP 配置后无法使用?"></a>Q3: MCP 配置后无法使用?</h3><p><strong>检查步骤</strong>:</p><ol><li>配置文件格式是否正确</li><li><code>enabled</code> 字段是否为 <code>true</code></li><li>Local MCP 的命令是否可执行</li><li>Remote MCP 的 URL 是否正确</li><li>API Key 是否有效</li><li>退出并重启 OpenCode: <code>/exit</code> → <code>opencode</code></li><li>查看 MCP 列表: <code>/mcp</code></li></ol><h3 id="Q4-OMO-插件安装失败"><a href="#Q4-OMO-插件安装失败" class="headerlink" title="Q4: OMO 插件安装失败?"></a>Q4: OMO 插件安装失败?</h3><p><strong>解决方案</strong>:</p><ol><li>检查网络连接（需要访问 GitHub）</li><li>确认有足够权限修改配置文件</li><li>手动下载配置文件: <a href="https://github.com/code-yeongyu/oh-my-opencode">https://github.com/code-yeongyu/oh-my-opencode</a></li><li>检查 <code>~/.config/opencode/oh-my-opencode.json</code> 是否生成</li></ol><h3 id="Q5-如何减少-API-成本"><a href="#Q5-如何减少-API-成本" class="headerlink" title="Q5: 如何减少 API 成本?"></a>Q5: 如何减少 API 成本?</h3><p><strong>方法</strong>:</p><ol><li>使用免费模型: Antigravity（Gemini 3 Pro，Claude Opus 4.5）</li><li>简单任务使用 Haiku 模型</li><li>及时压缩上下文: <code>/compact</code></li><li>使用自定义命令减少重复对话</li><li>开启缓存，避免重复请求</li></ol><h3 id="Q6-GitHub-Actions-执行失败"><a href="#Q6-GitHub-Actions-执行失败" class="headerlink" title="Q6: GitHub Actions 执行失败?"></a>Q6: GitHub Actions 执行失败?</h3><p><strong>常见原因</strong>:</p><ol><li>API Key 未配置或已过期</li><li>Workflow 文件路径错误（应为 <code>.github/workflows/opencode.yml</code>）</li><li>模型名称错误（使用 <code>/models</code> 查看）</li><li>权限不足（需要 <code>id-token: write</code>）</li></ol><p><strong>调试步骤</strong>:</p><ol><li>查看 GitHub Actions 日志</li><li>确认 Secrets 中的 API Key</li><li>测试模型连接: 在本地使用相同配置</li><li>检查 Workflow 语法: 使用 GitHub Actions linter</li></ol><h3 id="Q7-Session-切换后上下文丢失"><a href="#Q7-Session-切换后上下文丢失" class="headerlink" title="Q7: Session 切换后上下文丢失?"></a>Q7: Session 切换后上下文丢失?</h3><p><strong>说明</strong>: 每个 Session 是独立的，切换 Session 不会共享上下文。</p><p><strong>解决方案</strong>:</p><ul><li>使用 <code>/share</code> 分享重要对话</li><li>将关键信息写入文件或注释</li><li>使用 Todo List 记录跨 Session 的任务</li><li>将项目知识写入 AGENTS.md</li></ul><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><div class="tag link"><a class="link-card" title="OpenCode 官网" href="https://opencode.ai/"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">OpenCode 官网</p><p class="url">https://opencode.ai/</p></div></a></div><div class="tag link"><a class="link-card" title="GitHub 仓库" href="https://github.com/anomalyco/opencode"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">GitHub 仓库</p><p class="url">https://github.com/anomalyco/opencode</p></div></a></div><div class="tag link"><a class="link-card" title="CLI 文档" href="https://opencode.ai/docs/cli"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">CLI 文档</p><p class="url">https://opencode.ai/docs/cli</p></div></a></div><div class="tag link"><a class="link-card" title="TUI 文档" href="https://opencode.ai/docs/tui"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">TUI 文档</p><p class="url">https://opencode.ai/docs/tui</p></div></a></div><div class="tag link"><a class="link-card" title="MCP 文档" href="https://opencode.ai/docs/mcp-servers"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">MCP 文档</p><p class="url">https://opencode.ai/docs/mcp-servers</p></div></a></div><div class="tag link"><a class="link-card" title="GitHub 集成" href="https://opencode.ai/docs/github"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">GitHub 集成</p><p class="url">https://opencode.ai/docs/github</p></div></a></div><div class="tag link"><a class="link-card" title="SDK 文档" href="https://opencode.ai/docs/sdk"><div class="left"><img src="https://opencode.ai/favicon.ico"/></div><div class="right"><p class="text">SDK 文档</p><p class="url">https://opencode.ai/docs/sdk</p></div></a></div><h3 id="插件与工具"><a href="#插件与工具" class="headerlink" title="插件与工具"></a>插件与工具</h3><div class="tag link"><a class="link-card" title="Oh-My-OpenCode" href="https://github.com/code-yeongyu/oh-my-opencode"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">Oh-My-OpenCode</p><p class="url">https://github.com/code-yeongyu/oh-my-opencode</p></div></a></div><div class="tag link"><a class="link-card" title="OpenCode Antigravity Auth" href="https://github.com/NoeFabris/opencode-antigravity-auth"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">OpenCode Antigravity Auth</p><p class="url">https://github.com/NoeFabris/opencode-antigravity-auth</p></div></a></div><a class="btn-beautify blue" href="https://context7.com/" title="Context7"><i class="icon:fa-solid fa-book"></i><span>Context7</span></a><a class="btn-beautify purple" href="https://openrouter.ai/" title="OpenRouter"><i class="icon:fa-solid fa-link"></i><span>OpenRouter</span></a><h3 id="社区资源"><a href="#社区资源" class="headerlink" title="社区资源"></a>社区资源</h3><a class="btn-beautify blue" href="https://discord.gg/opencode" title="Discord 社区"><i class="icon:fa-brands fa-discord"></i><span>Discord 社区</span></a><a class="btn-beautify blue" href="https://twitter.com/opencode_ai" title="Twitter"><i class="icon:fa-brands fa-twitter"></i><span>Twitter</span></a><div class="tag link"><a class="link-card" title="OpenCode for VSCode" href="https://marketplace.visualstudio.com/items?itemName=sst-dev.opencode"><div class="left"><img src="https://marketplace.visualstudio.com/favicon.ico"/></div><div class="right"><p class="text">OpenCode for VSCode</p><p class="url">https://marketplace.visualstudio.com/items?itemName=sst-dev.opencode</p></div></a></div><h3 id="相关工具"><a href="#相关工具" class="headerlink" title="相关工具"></a>相关工具</h3><a class="btn-beautify blue" href="https://modelcontextprotocol.io/" title="MCP 规范"><i class="icon:fa-solid fa-book"></i><span>MCP 规范</span></a><div class="tag link"><a class="link-card" title="MCP Servers" href="https://github.com/modelcontextprotocol/servers"><div class="left"><img src="https://github.com/favicon.ico"/></div><div class="right"><p class="text">MCP Servers</p><p class="url">https://github.com/modelcontextprotocol/servers</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> AI开发 </category>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenCode </tag>
            
            <tag> 编程助手 </tag>
            
            <tag> CLI </tag>
            
            <tag> Plugin </tag>
            
            <tag> Oh-My-OpenCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly文档(三) 标签外挂</title>
      <link href="/posts/e5e815c7/"/>
      <url>/posts/e5e815c7/</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>标签外挂是 Hexo 独有的功能，并不是标准的 Markdown 格式. 以下的写法，只适用于 Butterfly 主题，用在其它主题上不会有效果，甚至可能会报错.<br>使用前请留意.</p></div><div class="note warning flat"><p>标签外挂虽然能为主题带来一些额外的功能和 UI 方面的强化，但是，标签外挂也有明显的限制，使用时请留意。</p></div><hr><h2 id="Note-Bootstrap-Callout"><a href="#Note-Bootstrap-Callout" class="headerlink" title="Note (Bootstrap Callout)"></a>Note (Bootstrap Callout)</h2><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">通用设置</button><button type="button" class="tab">用法1</button><button type="button" class="tab">用法2(自定义icon)</button></div><div class="tab-contents"><div class="tab-item-content active"><p>移植于 next 主题，并进行修改。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">note:</span></span><br><span class="line">  <span class="comment"># Note（提示框）标签样式类型：</span></span><br><span class="line">  <span class="comment">#  - simple    传统的 bs-callout 风格（旧版 alert），默认样式</span></span><br><span class="line">  <span class="comment">#  - modern    新版 bs-callout 风格（v2–v3），更现代</span></span><br><span class="line">  <span class="comment">#  - flat      扁平化提示框样式，类似 Mozilla / StackOverflow 的效果</span></span><br><span class="line">  <span class="comment">#  - disabled  禁用 Note 标签的所有 CSS 样式（仅保留结构，不加载样式）</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 是否在 Note 提示框中显示图标</span></span><br><span class="line">  <span class="comment"># true  表示显示图标</span></span><br><span class="line">  <span class="comment"># false 表示不显示图标</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 提示框圆角大小（单位：px）</span></span><br><span class="line">  <span class="comment"># 数值越大，圆角越明显</span></span><br><span class="line">  <span class="attr">border_radius:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 背景亮度偏移百分比（仅对 modern / flat 样式生效）</span></span><br><span class="line">  <span class="comment"># modern 样式推荐范围：-12 ～ 12</span></span><br><span class="line">  <span class="comment"># flat   样式推荐范围：-18 ～ 6</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># 该参数同时会影响 label 标签的配色</span></span><br><span class="line">  <span class="comment"># 即使 style 设置为 disabled，此参数依然会生效</span></span><br><span class="line">  <span class="attr">light_bg_offset:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th style="text-align:center">名称</th><th>解释</th></tr></thead><tbody><tr><td style="text-align:center"><code>style</code></td><td>可选: <code>simple</code>/<code>modern</code>/<code>flat</code>/<code>disabled</code></td></tr><tr><td style="text-align:center"><code>icons</code></td><td>可选: 是否显示 icon</td></tr><tr><td style="text-align:center"><code>border_radius</code></td><td>可选: 边框圆角</td></tr><tr><td style="text-align:center"><code>light_bg_offset</code></td><td>可选: 背景色偏移量</td></tr></tbody></table></div><p><code>icons</code> 和 <code>light_bg_offset</code> 只对方法一生效</p><p><code>Note</code> 标签外挂有两种用法</p></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="code">`class`</span>: 可选色彩: <span class="code">`default`</span> / <span class="code">`primary`</span> / <span class="code">`success`</span> / <span class="code">`info`</span> / <span class="code">`warning`</span> / <span class="code">`danger`</span> --&gt;</span><br><span class="line">&lt;!-- <span class="code">`no-icon`</span>: 可选: 不显示图标 --&gt;</span><br><span class="line">&lt;!-- <span class="code">`style`</span>: 可选: 可覆盖配置中的 style （<span class="code">`simple`</span>/<span class="code">`modern`</span>/<span class="code">`flat`</span>/<span class="code">`disabled`</span>） --&gt;</span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">任何内容（也支持内联标签）.</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic"></i><p><strong><code>Simple</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic"></i><p><strong><code>Modern</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic"></i><p><strong><code>Flat</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic"></i><p><strong><code>Disabled</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic"></i><p><strong><code>No-icon</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note no-icon flat"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div></div><div class="tab-item-content"><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p><strong>3.2.0 以上版本支持</strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th style="text-align:center">名称</th><th>解释</th></tr></thead><tbody><tr><td style="text-align:center"><code>color</code></td><td>可选: 顔色(<code>default</code>/<code>blue</code>/<code>pink</code>/<code>red</code>/<code>purple</code>/<code>orange</code>/<code>green</code>)</td></tr><tr><td style="text-align:center"><code>icons</code></td><td>可选: 可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td style="text-align:center"><code>style</code></td><td>可选: 可以覆盖配置中的 style（<code>simple</code>/<code>modern</code>/<code>flat</code>/<code>disabled</code>）</td></tr></tbody></table></div><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>Simple</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;</span><br><span class="line">2021 年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021 年快到了….</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><hr><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>Modern</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;</span><br><span class="line">2021 年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021 年快到了….</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><hr><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>Flat</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;</span><br><span class="line">2021 年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021 年快到了….</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><hr><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>Disabled</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;</span><br><span class="line">2021 年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><hr><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>No-icon</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue no-icon %&#125;</span><br><span class="line">2021 年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink no-icon %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red no-icon %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple no-icon %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green no-icon %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021 年快到了….</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><hr><h2 id="Gallery-相册图库"><a href="#Gallery-相册图库" class="headerlink" title="Gallery 相册图库"></a>Gallery 相册图库</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p><strong>2.2.0 以上提供</strong></p></div><p>一个图库集合。</p><p>写法:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- name: 图库名字 --&gt;</span><br><span class="line">&lt;!-- description: 图库描述 --&gt;</span><br><span class="line">&lt;!-- link: 连接到对应相册的地址 --&gt;</span><br><span class="line">&lt;!-- img-url: 图库封面的地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>例子</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup &#x27;自然｜风景&#x27; &#x27;绝美的自然风景桌面壁纸~&#x27; &#x27;/wallpaper/nature&#x27; https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面03.png %&#125;</span><br><span class="line">&#123;% galleryGroup &#x27;动漫｜二次元&#x27; &#x27;动漫高清桌面壁纸~&#x27; &#x27;/wallpaper/anime&#x27; https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物07.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><div class="gallery-group-main"><figure class="gallery-group">    <img class="gallery-group-img no-lightbox" src='https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面03.png' alt="Group Image Gallery">    <figcaption>      <div class="gallery-group-name">自然｜风景</div>      <p>绝美的自然风景桌面壁纸~</p>      <a href='/wallpaper/nature'></a>    </figcaption>  </figure><figure class="gallery-group">    <img class="gallery-group-img no-lightbox" src='https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物07.png' alt="Group Image Gallery">    <figcaption>      <div class="gallery-group-name">动漫｜二次元</div>      <p>动漫高清桌面壁纸~</p>      <a href='/wallpaper/anime'></a>    </figcaption>  </figure></div><hr><h2 id="Gallery-相册"><a href="#Gallery-相册" class="headerlink" title="Gallery 相册"></a>Gallery 相册</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p><strong>2.0.0 以上提供</strong></p></div><p>区别于旧版的 Gallery 相册,新的 Gallery 相册会自动根据图片长度进行排版，书写也更加方便，与 markdown 格式一样。可根据需要插入到相应的<br>md。</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">本地</button><button type="button" class="tab">远程拉取</button></div><div class="tab-contents"><div class="tab-item-content active"><p>写法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- button: 【可选】点击按钮加载更多图片，填写 true/false。默认为 false。 --&gt;</span><br><span class="line">&#123;% gallery [button] %&#125;</span><br><span class="line">markdown 图片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><div class="note primary icon-padding flat"><i class="note-icon fa-solid fa-wand-magic-sparkles"></i><p><strong><code>例子</code></strong></p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面01.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面02.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面03.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面04.png</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><div class="gallery-container" data-type="data" data-button="" data-limit="10" data-first="10">    <div class="gallery-items">[{"url":"https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面01.png","alt":"","title":""},{"url":"https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面02.png","alt":"","title":""},{"url":"https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面03.png","alt":"","title":""},{"url":"https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面04.png","alt":"","title":""}]</div>  </div></div><div class="tab-item-content"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- url: 【必须】 识别词 --&gt;</span><br><span class="line">&lt;!-- link: 【必须】远程的 json 链接 --&gt;</span><br><span class="line">&lt;!-- button: 【可选】点击按钮加载更多图片，填写 true/false。默认为 false。 --&gt;</span><br><span class="line">&#123;% gallery url,[link],[button] %&#125;</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>远程链接 Json 的例子. 有三个参数，url是必须存在的，alt 和 title 可有，也可没有。</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/IMG_0556.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;alt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;IMG_0556.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;这是title&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/IMG_0472.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;alt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;IMG_0472.jpg&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/IMG_0453.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;alt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/IMG_0931.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;alt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery url,https://xxxx.com/sss.json %&#125;</span><br><span class="line">&#123;% endgallery %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% gallery url,https://xxxx.com/sss.json,true,220,10 %&#125;</span><br><span class="line">&#123;% endgallery %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% gallery url,https://xxxx.com/sss.json,true,,10 %&#125;</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><hr><h2 id="Tag-hide"><a href="#Tag-hide" class="headerlink" title="Tag-hide"></a>Tag-hide</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p>2.2.0 以上提供</p><p>请注意，tag-hide 内的标签外挂 content 内都不建议有 h1 - h6 等标题。因为 Toc 会把隐藏内容标题也显示出来，而且当滚动屏幕时，如果隐藏内容没有显示出来，会导致<br>Toc 的滚动出现异常。</p></div><p>如果你想把一些文字、内容隐藏起来，并提供按钮让用户点击显示。可以使用这个标签外挂.</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">Inline</button><button type="button" class="tab">Block</button><button type="button" class="tab">Toggle</button></div><div class="tab-contents"><div class="tab-item-content active"><ul><li><code>inline</code> 在文本里面添加按钮隐藏内容，只限文字</li><li><code>content</code> 不能包含英文逗号，可用<code>&amp;sbquo;</code></li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- content: 文本内容 --&gt;</span><br><span class="line">&lt;!-- display: 【可选】按钮显示的文字 --&gt;</span><br><span class="line">&lt;!-- bg: 【可选】按钮的背景颜色 --&gt;</span><br><span class="line">&lt;!-- color: 【可选】按钮文字的颜色 --&gt;</span><br><span class="line">&#123;% hideInline content,display,bg,color %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 哪个英文字母最酷？ &#123;% hideInline 因为西装裤(C装酷),查看答案,#FF7242,#fff %&#125;</span><br><span class="line"><span class="bullet">-</span> 门里站着一个人? &#123;% hideInline 闪 %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>哪个英文字母最酷？ <span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看答案</button><span class="hide-content">因为西装裤(C装酷)</span>&lt;/span&gt;</p></li><li><p>门里站着一个人? <span class="hide-inline"><button type="button" class="hide-button" style="">Click</button><span class="hide-content">闪</span>&lt;/span&gt;</p></li></ul></div><div class="tab-item-content"><ul><li>block独立的 block 隐藏内容，可以隐藏很多内容，包括图片，代码块等等</li><li>display 不能包含英文逗号，可用<code>&amp;sbquo;</code></li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- content: 文本内容 --&gt;</span><br><span class="line">&lt;!-- display: 【可选】按钮显示的文字 --&gt;</span><br><span class="line">&lt;!-- bg: 【可选】按钮的背景颜色 --&gt;</span><br><span class="line">&lt;!-- color: 【可选】按钮文字的颜色 --&gt;</span><br><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查看答案</span><br><span class="line">&#123;% hideBlock 查看答案 %&#125;</span><br><span class="line">傻子，怎么可能有答案</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><p>查看答案</p><div class="hide-block"><button type="button" class="hide-button" style="">查看答案</button><div class="hide-content"><p>傻子，怎么可能有答案</p></div></div></div><div class="tab-item-content"><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p><strong>2.3.0 以上支持</strong></p></div><ul><li><p>如果你需要展示的内容太多，可以把它隐藏在收缩框里，需要时再把它展开。</p></li><li><p>display 不能包含英文逗号，可用<code>&amp;sbquo;</code></p></li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- display: 显示的文字 --&gt;</span><br><span class="line">&lt;!-- bg: 【可选】按钮的背景颜色 --&gt;</span><br><span class="line">&lt;!-- color: 【可选】按钮文字的颜色 --&gt;</span><br><span class="line">&#123;% hideToggle display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle Butterfly 安装方法 %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 在你的博客根目录里</span><br><span class="line">   git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> 如果想要安装比较新的 dev 分支，可以</span><br><span class="line">   git clone -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line">   &#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><details class="toggle" ><summary class="toggle-button" style="">Butterfly 安装方法</summary><div class="toggle-content"><ol><li><p>在你的博客根目录里</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br></pre></td></tr></table></figure></li><li><p>如果想要安装比较新的 dev 分支，可以</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br></pre></td></tr></table></figure></li></ol></div></details></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><hr><h2 id="Mermaid-图表"><a href="#Mermaid-图表" class="headerlink" title="Mermaid 图表"></a>Mermaid 图表</h2><blockquote><p>使用 mermaid 标签可以绘制 Flowchart（流程图）、Sequence diagram（时序图 ）、Class Diagram（类别图）、State<br>Diagram（状态图）、Gantt（甘特图）和 Pie Chart（圆形图），具体可以查看mermaid 文档.</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Mermaid</span></span><br><span class="line"><span class="comment"># https://github.com/mermaid-js/mermaid</span></span><br><span class="line"><span class="attr">mermaid:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Write Mermaid diagrams using code blocks</span></span><br><span class="line">  <span class="attr">code_write:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># built-in themes: default / forest / dark / neutral</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">default</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">dark</span></span><br></pre></td></tr></table></figure><p>写法:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- config: 【可选】mermaid 图表配置, 以 JSON 格式书写，具体配置参数请参考mermaid 文档 --&gt;</span><br><span class="line">&#123;% mermaid &#x27;[config]&#x27; %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>示例-饼状图:</p></blockquote><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">pie</span><br><span class="line">title Key elements in Product X</span><br><span class="line">&quot;Calcium&quot; : 42.96</span><br><span class="line">&quot;Potassium&quot; : 50.05</span><br><span class="line">&quot;Magnesium&quot; : 10.01</span><br><span class="line">&quot;Iron&quot; : 5</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    pietitle Key elements in Product X&quot;Calcium&quot; : 42.96&quot;Potassium&quot; : 50.05&quot;Magnesium&quot; : 10.01&quot;Iron&quot; : 5  </pre></div><blockquote><p>流程图:</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid &#x27;&#123;&quot;themeVariables&quot;: &#123; &quot;fontSize&quot;: &quot;16px&quot; &#125;, &quot;layout&quot;: &quot;elk&quot;, &quot;look&quot;: &quot;handDrawn&quot;&#125;&#x27; %&#125;</span><br><span class="line">flowchart LR</span><br><span class="line">A[Start] --&gt; B&#123;Decision&#125;</span><br><span class="line">B --&gt;|Yes| C[Continue]</span><br><span class="line">B --&gt;|No| D[Stop]</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{&quot;themeVariables&quot;: { &quot;fontSize&quot;: &quot;16px&quot; }, &quot;layout&quot;: &quot;elk&quot;, &quot;look&quot;: &quot;handDrawn&quot;}" hidden>    flowchart LRA[Start] --&gt; B{Decision}B --&gt;|Yes| C[Continue]B --&gt;|No| D[Stop]  </pre></div><hr><h2 id="Tabs"><a href="#Tabs" class="headerlink" title="Tabs"></a>Tabs</h2><blockquote><p>移植于 next 主题</p></blockquote><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Unique name: tabs 区块标签的唯一名称，不包含逗号。将用于每个选项卡的 #id 前缀，并附加其索引号。若名称中有空格，生成 #id 时会将空格替换为短横线。仅对当前文章/页面的 URL 必须唯一！ --&gt;</span><br><span class="line">&lt;!-- index: 【可选】活动选项卡的索引号。如果未指定，将选择第一个选项卡（1）。如果索引为 -1，则不会选择任何选项卡，类似于折叠内容。可选参数。 --&gt;</span><br><span class="line">&lt;!-- Tab caption: 当前选项卡的标题。如果未指定标题，将使用唯一名称和选项卡索引后缀作为选项卡标题。如果未指定标题，但指定了图标，标题将为空。 --&gt;</span><br><span class="line">&lt;!-- @icon: 【可选】FontAwesome 图标名称（全名，如 &#x27;fas fa-font&#x27;）。可以有或没有空格；例如 &#x27;Tab caption @icon&#x27; 与 &#x27;Tab caption@icon&#x27; 类似。 --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line"></span><br><span class="line">Any content (support inline tags too).</span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子 1 - 预设选择第一个【默认】</p></blockquote><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">test1 1</button><button type="button" class="tab">test1 2</button><button type="button" class="tab">test1 3</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>This is Tab 1.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 2.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 3.</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><blockquote><p>例子 2 - 预设选择 tabs</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs"><button type="button" class="tab">test2 1</button><button type="button" class="tab">test2 2</button><button type="button" class="tab active">test2 3</button></div><div class="tab-contents"><div class="tab-item-content"><p><strong>This is Tab 1.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 2.</strong></p></div><div class="tab-item-content active"><p><strong>This is Tab 3.</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><blockquote><p>例子 3 - 没有预设值</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs no-default"><button type="button" class="tab">test3 1</button><button type="button" class="tab">test3 2</button><button type="button" class="tab">test3 3</button></div><div class="tab-contents"><div class="tab-item-content"><p><strong>This is Tab 1.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 2.</strong></p></div><div class="tab-item-content"><p><strong>This is Tab 3.</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><blockquote><p>例子 4 - 自定义 Tab 名 + 只有 icon + icon 和 Tab 名</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**tab 名字为第一个 Tab**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**只有图标 没有 Tab 名字**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"></span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line"></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">第一个Tab</button><button type="button" class="tab"><i class="fab fa-apple-pay"></i></button><button type="button" class="tab"><i class="fas fa-bomb"></i>炸弹</button></div><div class="tab-contents"><div class="tab-item-content active"><p><strong>tab 名字为第一个 Tab</strong></p></div><div class="tab-item-content"><p><strong>只有图标 没有 Tab 名字</strong></p></div><div class="tab-item-content"><p><strong>名字+icon</strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><hr><h2 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p>3.0 以上提供</p></div><p>使用方法:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- url: 【必须】链接地址 --&gt;</span><br><span class="line">&lt;!-- text: 【必须】按钮文字 --&gt;</span><br><span class="line">&lt;!-- icon: 【可选】图标 --&gt;</span><br><span class="line">&lt;!-- color: 【可选】按钮背景顔色（默认 style 时）按钮字体和边框顔色(outline 时), 配置： default/blue/pink/red/purple/orange/green --&gt;</span><br><span class="line">&lt;!-- style: 【可选】按钮样式 默认实心, 配置： outline/留空 --&gt;</span><br><span class="line">&lt;!-- layout: 【可选】按钮佈局 默认为 line, 配置： block/留空 --&gt;</span><br><span class="line">&lt;!-- position: 【可选】按钮位置 前提是设置了 layout 为 block 默认为左边, 配置： center/right/留空 --&gt;</span><br><span class="line">&lt;!-- size: 【可选】按钮大小, 配置： larger/留空 --&gt;</span><br><span class="line">&#123;% btn [url],[text],[icon],[color] [style] [layout] [position] [size] %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is my website, click the button &#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,larger %&#125;</span><br></pre></td></tr></table></figure><p>This is my website, click the button <a class="btn-beautify " href="https://butterfly.js.org/" title="Butterfly"><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify " href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://butterfly.js.org/" title="Butterfly"><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,block %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,block center larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,block right outline larger %&#125;</span><br></pre></td></tr></table></figure><a class="btn-beautify block" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify block center larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify block right outline larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><blockquote><p>more than one button in center</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,blue larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,pink larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,red larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,purple larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,orange larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,green larger %&#125;</span><br></pre></td></tr></table></figure><a class="btn-beautify larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify blue larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify pink larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify red larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify purple larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify orange larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify green larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-center&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline blue larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline pink larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline red larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline purple larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline orange larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://butterfly.js.org/&#x27;,Butterfly,far fa-hand-point-right,outline green larger %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><div class="btn-center"><a class="btn-beautify outline larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify outline blue larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify outline pink larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify outline red larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify outline purple larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify outline orange larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><a class="btn-beautify outline green larger" href="https://butterfly.js.org/" title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a></div><hr><h2 id="InlineImg"><a href="#InlineImg" class="headerlink" title="InlineImg"></a>InlineImg</h2><blockquote><p>主题中的图片都是默认以块级元素显示，如果你想以内联元素显示，可以使用这个标签外挂。</p></blockquote><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- src: 图片链接 --&gt;</span><br><span class="line">&lt;!-- height: 【可选】图片高度限制 --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% inlineImg [src] [height] %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% inlineImg [src] [height] %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">你看她长得漂亮不</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://i.loli.net/2021/03/19/2P6ivUGsdaEXSFI.png</span>)</span><br><span class="line"></span><br><span class="line">我觉得很漂亮 &#123;% inlineImg https://i.loli.net/2021/03/19/5M4jUB3ynq7ePgw.png 150px %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Label"><a href="#Label" class="headerlink" title="Label"></a>Label</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p>由于 hexo 的渲染限制， 在段落开头使用 label 标签外挂会出现一些问题。例如：连续开头使用 label 标签外挂的段落无法换行</p><p>建议 不要 在段落开头使用 label 标签外挂</p></div><p>高亮所需的文字</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- text: 文字 --&gt;</span><br><span class="line">&lt;!-- color: 【可选】背景颜色，默认为 default, default/blue/pink/red/purple/orange/green --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% label text color %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% label text color %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">臣亮言：&#123;% label 先帝 %&#125;创业未半，而&#123;% label 中道崩殂 blue %&#125;。今天下三分，&#123;% label 益州疲敝 pink %&#125;，此诚&#123;% label 危急存亡之秋</span><br><span class="line">red %&#125;也！然侍衞之臣，不懈于内；&#123;% label 忠志之士 purple %&#125;，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。</span><br><span class="line">宫中、府中，俱为一体；陟罚臧否，不宜异同。若有&#123;% label 作奸 orange %&#125;、&#123;% label 犯科 green</span><br><span class="line">%&#125;，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</span><br></pre></td></tr></table></figure><p>臣亮言：<mark class="hl-label default">先帝</mark>创业未半，而<mark class="hl-label blue">中道崩殂</mark>。今天下三分，<mark class="hl-label pink">益州疲敝</mark>，此诚<mark class="hl-label red">危急存亡之秋</mark>也！然侍衞之臣，不懈于内；<mark class="hl-label purple">忠志之士</mark>，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。<br>宫中、府中，俱为一体；陟罚臧否，不宜异同。若有<mark class="hl-label orange">作奸</mark>、<mark class="hl-label green">犯科</mark>，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</p><hr><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p>4.0.0 以上支持</p></div><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- title: 标题/时间线 --&gt;</span><br><span class="line">&lt;!-- color: timeline 颜色, default(留空) / blue / pink / red / purple / orange / green --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% timeline title,color %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line"></span><br><span class="line">xxxxx</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line"></span><br><span class="line">xxxxx</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子: default(留空)</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026 %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline "><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2026</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><blockquote><p>blue</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline blue"><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2026</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><blockquote><p>pink</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026,pink %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline pink"><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2026</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><blockquote><p>red</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026,red %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline red"><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2026</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><blockquote><p>purple</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026,purple %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline purple"><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2026</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><blockquote><p>orange</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026,orange %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline orange"><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2022</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><blockquote><p>green</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2026,green %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line"></span><br><span class="line">这是测试页面</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline green"><div class='timeline-item headline'>        <div class='timeline-item-title'>          <div class='item-circle'><p>2022</p></div>        </div>      </div><div class='timeline-item'>        <div class='timeline-item-title'>          <div class='item-circle'><p>01-02</p></div>        </div>        <div class='timeline-item-content'><p>这是测试页面</p></div>      </div></div><hr><h2 id="Flink"><a href="#Flink" class="headerlink" title="Flink"></a>Flink</h2><div class="note pink icon-padding flat"><i class="note-icon fa-solid fa-bell"></i><p>4.1.0 以上支持</p></div><p>可在任何界面插入类似友情链接列表效果</p><p>内容格式与友情链接界面一样，支持 <code>yml</code> 格式</p><p>插入友链效果:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endflink %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> class<span class="emphasis">_name: 友情链接</span></span><br><span class="line"><span class="emphasis">  class_</span>desc: 那些人，那些事</span><br><span class="line">  link<span class="emphasis">_list:</span></span><br><span class="line"><span class="emphasis">    - name: CrazyWong</span></span><br><span class="line"><span class="emphasis">      link: https://crazywong.com</span></span><br><span class="line"><span class="emphasis">      avatar: https://crazywong.com/img/avatar.png</span></span><br><span class="line"><span class="emphasis">      descr: 今日事,今日毕</span></span><br><span class="line"><span class="emphasis">    - name: Hexo</span></span><br><span class="line"><span class="emphasis">      link: https://hexo.io/zh-tw/</span></span><br><span class="line"><span class="emphasis">      avatar: https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line"><span class="emphasis">      descr: 快速、简单且强大的网志框架</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">- class_</span>name: 网站</span><br><span class="line">  class<span class="emphasis">_desc: 值得推荐的网站</span></span><br><span class="line"><span class="emphasis">  link_</span>list:</span><br><span class="line"><span class="bullet">    -</span> name: Youtube</span><br><span class="line"><span class="code">      link: https://www.youtube.com/</span></span><br><span class="line"><span class="code">      avatar: https://i.loli.net/2020/05/14/9ZkGg8v3azHJfM1.png</span></span><br><span class="line"><span class="code">      descr: 视频网站</span></span><br><span class="line"><span class="code">    - name: Weibo</span></span><br><span class="line"><span class="code">      link: https://www.weibo.com/</span></span><br><span class="line"><span class="code">      avatar: https://i.loli.net/2020/05/14/TLJBum386vcnI1P.png</span></span><br><span class="line"><span class="code">      descr: 中国最大社交分享平台</span></span><br><span class="line"><span class="code">    - name: Twitter</span></span><br><span class="line"><span class="code">      link: https://twitter.com/</span></span><br><span class="line"><span class="code">      avatar: https://i.loli.net/2020/05/14/5VyHPQqR6LWF39a.png</span></span><br><span class="line"><span class="code">      descr: 社交分享平台</span></span><br><span class="line"><span class="code">      &#123;% endflink %&#125;</span></span><br></pre></td></tr></table></figure><div class="flink"><div class="flink-name">友情链接</div><div class="flink-desc">那些人，那些事</div><div class="flink-list">      <div class="flink-list-item">        <a href="https://crazywong.com" title="CrazyWong" target="_blank">          <div class="flink-item-icon">            <img class="no-lightbox" src="https://crazywong.com/img/avatar.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="CrazyWong" />          </div>          <div class="flink-item-name">CrazyWong</div>          <div class="flink-item-desc" title="今日事,今日毕">今日事,今日毕</div>        </a>      </div>      <div class="flink-list-item">        <a href="https://hexo.io/zh-tw/" title="Hexo" target="_blank">          <div class="flink-item-icon">            <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Hexo" />          </div>          <div class="flink-item-name">Hexo</div>          <div class="flink-item-desc" title="快速、简单且强大的网志框架">快速、简单且强大的网志框架</div>        </a>      </div></div><div class="flink-name">网站</div><div class="flink-desc">值得推荐的网站</div><div class="flink-list">      <div class="flink-list-item">        <a href="https://www.youtube.com/" title="Youtube" target="_blank">          <div class="flink-item-icon">            <img class="no-lightbox" src="https://i.loli.net/2020/05/14/9ZkGg8v3azHJfM1.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Youtube" />          </div>          <div class="flink-item-name">Youtube</div>          <div class="flink-item-desc" title="视频网站">视频网站</div>        </a>      </div>      <div class="flink-list-item">        <a href="https://www.weibo.com/" title="Weibo" target="_blank">          <div class="flink-item-icon">            <img class="no-lightbox" src="https://i.loli.net/2020/05/14/TLJBum386vcnI1P.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Weibo" />          </div>          <div class="flink-item-name">Weibo</div>          <div class="flink-item-desc" title="中国最大社交分享平台">中国最大社交分享平台</div>        </a>      </div>      <div class="flink-list-item">        <a href="https://twitter.com/" title="Twitter" target="_blank">          <div class="flink-item-icon">            <img class="no-lightbox" src="https://i.loli.net/2020/05/14/5VyHPQqR6LWF39a.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Twitter" />          </div>          <div class="flink-item-name">Twitter</div>          <div class="flink-item-desc" title="社交分享平台">社交分享平台</div>        </a>      </div></div></div><hr><h2 id="ABCJS-乐谱"><a href="#ABCJS-乐谱" class="headerlink" title="ABCJS 乐谱"></a>ABCJS 乐谱</h2><blockquote><p>在页面上渲染乐谱.</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># abcjs (乐谱渲染)</span></span><br><span class="line"><span class="comment"># See https://github.com/paulrosen/abcjs</span></span><br><span class="line"><span class="comment"># ---------------</span></span><br><span class="line"><span class="comment"># enable: 是否启用 ABCJS</span></span><br><span class="line"><span class="comment"># per_page: 是否每页都加载 ABCJS, 如果设爲 false, 在你使用 ABCJS 时，你需要在使用 ABCJS 的页面 Front-matter 添加 abcjs: true</span></span><br><span class="line"><span class="attr">abcjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>写法:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% score %&#125;</span><br><span class="line">乐谱代码</span><br><span class="line">&#123;% endscore %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;% score %&#125;</span><br><span class="line">X:1</span><br><span class="line">T:alternate heads</span><br><span class="line">M:C</span><br><span class="line">L:1/8</span><br><span class="line">U:n=!style=normal!</span><br><span class="line">K:C treble style=rhythm</span><br><span class="line">&quot;Am&quot; BBBB B2 B&gt;B | &quot;Dm&quot; B2 B/B/B &quot;C&quot; B4 |&quot;Am&quot; B2 nGnB B2 nGnA | &quot;Dm&quot; nDB/B/ nDB/B/ &quot;C&quot; nCB/B/ nCB/B/ |B8| B0 B0 B0 B0 |]</span><br><span class="line">%%text This translates to:</span><br><span class="line">[<span class="string">M:C</span>][<span class="symbol">K:style=normal</span>]</span><br><span class="line">[<span class="string">A,EAce</span>][<span class="symbol">A,EAce</span>][<span class="string">A,EAce</span>][<span class="symbol">A,EAce</span>] [A,EAce]2 [A,EAce]&gt;[A,EAce] |[DAdf]2 [DAdf]/[DAdf]/[DAdf] [CEGce]4 |[A,EAce]2</span><br><span class="line">GA [A,EAce] GA |D[DAdf]/[DAdf]/ D[DAdf]/[DAdf]/ C [CEGce]/[CEGce]/ C[CEGce]/[CEGce]/ |[CEGce]8 | [CEGce]2 [CEGce]</span><br><span class="line">2 [CEGce]2 [CEGce]2 |]</span><br><span class="line">GAB2 !style=harmonic![gb]4|GAB2 [K: style=harmonic]gbgb|</span><br><span class="line">[K: style=x]</span><br><span class="line">C/A,/ C/C/E C/zz2|</span><br><span class="line">w:Rock-y did-nt like that</span><br><span class="line">&#123;% endscore %&#125;</span><br></pre></td></tr></table></figure><div class="abc-music-sheet">X:1T:alternate headsM:CL:1/8U:n=!style=normal!K:C treble style=rhythm&quot;Am&quot; BBBB B2 B&gt;B | &quot;Dm&quot; B2 B/B/B &quot;C&quot; B4 |&quot;Am&quot; B2 nGnB B2 nGnA | &quot;Dm&quot; nDB/B/ nDB/B/ &quot;C&quot; nCB/B/ nCB/B/ |B8| B0 B0 B0 B0 |]%%text This translates to:[M:C][K:style=normal][A,EAce][A,EAce][A,EAce][A,EAce] [A,EAce]2 [A,EAce]&gt;[A,EAce] |[DAdf]2 [DAdf]/[DAdf]/[DAdf] [CEGce]4 |[A,EAce]2GA [A,EAce] GA |D[DAdf]/[DAdf]/ D[DAdf]/[DAdf]/ C [CEGce]/[CEGce]/ C[CEGce]/[CEGce]/ |[CEGce]8 | [CEGce]2 [CEGce]2 [CEGce]2 [CEGce]2 |]GAB2 !style=harmonic![gb]4|GAB2 [K: style=harmonic]gbgb|[K: style=x]C/A,/ C/C/E C/zz2|w:Rock-y did-nt like that</div><hr><h2 id="Series-系列文章"><a href="#Series-系列文章" class="headerlink" title="Series 系列文章"></a>Series 系列文章</h2><blockquote><p>在页面上显示系列文章.</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># enable: 是否启用 series</span></span><br><span class="line"><span class="comment"># orderBy: 排序方式，默认为 title, 可选 title / date</span></span><br><span class="line"><span class="comment"># order: 排序方式，默认为 1, 可选 1 (升序) / -1（降序）</span></span><br><span class="line"><span class="comment"># number: 显示序列号</span></span><br><span class="line"><span class="attr">series:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">orderBy:</span> <span class="string">&#x27;title&#x27;</span> <span class="comment"># Order by title or date</span></span><br><span class="line">  <span class="attr">order:</span> <span class="number">1</span> <span class="comment"># Sort of order. 1, asc for ascending; -1, desc for descending</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>写法:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% series %&#125;</span><br><span class="line">&#123;% series [series name] %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>在文章的 front-matter 上添加参数 series，并给与一个标识</p></li><li><p>使用此标签外挂，会把相同标识的文章以列表的形式展示</p></li><li><p>如果不写 series 标识，则默认为你使用此标签外挂所在的文章的 series 标识</p></li></ul><blockquote><p>例子</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% series docs %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Chartjs-图表"><a href="#Chartjs-图表" class="headerlink" title="Chartjs 图表"></a>Chartjs 图表</h2><blockquote><p>另一种方式添加图表.</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chartjs</span></span><br><span class="line"><span class="comment"># 参见 https://www.chartjs.org/docs/latest/</span></span><br><span class="line"><span class="attr">chartjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 除非你了解它们的工作原理，否则不要修改。</span></span><br><span class="line">  <span class="comment"># 默认设置仅在未指定 MD 语法时使用。</span></span><br><span class="line">  <span class="comment"># 图表的字体颜色</span></span><br><span class="line">  <span class="attr">fontColor:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">&quot;rgba(0, 0, 0, 0.8)&quot;</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">&quot;rgba(255, 255, 255, 0.8)&quot;</span></span><br><span class="line">  <span class="comment"># 图表的边框颜色</span></span><br><span class="line">  <span class="attr">borderColor:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">&quot;rgba(0, 0, 0, 0.1)&quot;</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">&quot;rgba(255, 255, 255, 0.2)&quot;</span></span><br><span class="line">  <span class="comment"># 雷达图和极区图的刻度标签背景颜色</span></span><br><span class="line">  <span class="attr">scale_ticks_backdropColor:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">&quot;transparent&quot;</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">&quot;transparent&quot;</span></span><br></pre></td></tr></table></figure><p>写法:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- width: 【可选】图表宽度 --&gt;</span><br><span class="line">&lt;!-- abreast: 【可选】是否并排显示，当你写了 , 使用并排模式，图标和描述将并排显示。abreast 为 true 时，需要配置 width 的值 --&gt;</span><br><span class="line">&lt;!-- chartId: 【可选】图表 ID --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% chartjs [width, abreast, chartId] %&#125;</span><br><span class="line">&lt;!-- chart --&gt;</span><br><span class="line">&lt;!-- endchart --&gt;</span><br><span class="line">&lt;!-- desc --&gt;</span><br><span class="line">&lt;!-- enddesc --&gt;</span><br><span class="line">&#123;% endchartjs %&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>折线图</strong></p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;% chartjs 70 %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- chart --&gt;</span><br><span class="line">&#123;</span><br><span class="line">&quot;type&quot;: &quot;line&quot;,</span><br><span class="line">&quot;data&quot;: &#123;</span><br><span class="line">&quot;labels&quot;: [&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;],</span><br><span class="line">&quot;datasets&quot;: [&#123;</span><br><span class="line">&quot;label&quot;: &quot;My First dataset&quot;,</span><br><span class="line">&quot;backgroundColor&quot;: &quot;rgb(255, 99, 132)&quot;,</span><br><span class="line">&quot;borderColor&quot;: &quot;rgb(255, 99, 132)&quot;,</span><br><span class="line">&quot;data&quot;: [0, 10, 5, 2, 20, 30, 45]</span><br><span class="line">&#125;]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;options&quot;: &#123;</span><br><span class="line">&quot;responsive&quot;: true,</span><br><span class="line">&quot;title&quot;: &#123;</span><br><span class="line">&quot;display&quot;: true,</span><br><span class="line">&quot;text&quot;: &quot;Chart.js Line Chart&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;!-- endchart --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endchartjs %&#125;</span><br></pre></td></tr></table></figure><div class="chartjs-container" data-chartjs-id="" data-width="70%">            <pre class="chartjs-src" hidden>{&quot;type&quot;: &quot;line&quot;,&quot;data&quot;: {&quot;labels&quot;: [&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;],&quot;datasets&quot;: [{&quot;label&quot;: &quot;My First dataset&quot;,&quot;backgroundColor&quot;: &quot;rgb(255, 99, 132)&quot;,&quot;borderColor&quot;: &quot;rgb(255, 99, 132)&quot;,&quot;data&quot;: [0, 10, 5, 2, 20, 30, 45]}]},&quot;options&quot;: {&quot;responsive&quot;: true,&quot;title&quot;: {&quot;display&quot;: true,&quot;text&quot;: &quot;Chart.js Line Chart&quot;}}}</pre>                      </div><blockquote><p><strong>雷达图, 也称蜘蛛图、蛛网图.</strong></p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&#123;% chartjs %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- chart --&gt;</span><br><span class="line">&#123;</span><br><span class="line">&quot;type&quot;: &quot;radar&quot;,</span><br><span class="line">&quot;data&quot;: &#123;</span><br><span class="line">&quot;labels&quot;: [</span><br><span class="line">&quot;Eating&quot;,</span><br><span class="line">&quot;Drinking&quot;,</span><br><span class="line">&quot;Sleeping&quot;,</span><br><span class="line">&quot;Designing&quot;,</span><br><span class="line">&quot;Coding&quot;,</span><br><span class="line">&quot;Cycling&quot;,</span><br><span class="line">&quot;Running&quot;</span><br><span class="line">],</span><br><span class="line">&quot;datasets&quot;: [</span><br><span class="line">&#123;</span><br><span class="line">&quot;label&quot;: &quot;My First Dataset&quot;,</span><br><span class="line">&quot;data&quot;: [65, 59, 90, 81, 56, 55, 40],</span><br><span class="line">&quot;fill&quot;: true,</span><br><span class="line">&quot;backgroundColor&quot;: &quot;rgba(255, 99, 132, 0.2)&quot;,</span><br><span class="line">&quot;borderColor&quot;: &quot;rgb(255, 99, 132)&quot;,</span><br><span class="line">&quot;pointBackgroundColor&quot;: &quot;rgb(255, 99, 132)&quot;,</span><br><span class="line">&quot;pointBorderColor&quot;: &quot;#fff&quot;,</span><br><span class="line">&quot;pointHoverBackgroundColor&quot;: &quot;#fff&quot;,</span><br><span class="line">&quot;pointHoverBorderColor&quot;: &quot;rgb(255, 99, 132)&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">&quot;label&quot;: &quot;My Second Dataset&quot;,</span><br><span class="line">&quot;data&quot;: [28, 48, 40, 19, 96, 27, 100],</span><br><span class="line">&quot;fill&quot;: true,</span><br><span class="line">&quot;backgroundColor&quot;: &quot;rgba(54, 162, 235, 0.2)&quot;,</span><br><span class="line">&quot;borderColor&quot;: &quot;rgb(54, 162, 235)&quot;,</span><br><span class="line">&quot;pointBackgroundColor&quot;: &quot;rgb(54, 162, 235)&quot;,</span><br><span class="line">&quot;pointBorderColor&quot;: &quot;#fff&quot;,</span><br><span class="line">&quot;pointHoverBackgroundColor&quot;: &quot;#fff&quot;,</span><br><span class="line">&quot;pointHoverBorderColor&quot;: &quot;rgb(54, 162, 235)&quot;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;options&quot;: &#123;</span><br><span class="line">&quot;elements&quot;: &#123;</span><br><span class="line">&quot;line&quot;: &#123;</span><br><span class="line">&quot;borderWidth&quot;: 3</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;!-- endchart --&gt;</span><br><span class="line">&#123;% endchartjs %&#125;</span><br></pre></td></tr></table></figure><div class="chartjs-container" data-chartjs-id="" >            <pre class="chartjs-src" hidden>{&quot;type&quot;: &quot;radar&quot;,&quot;data&quot;: {&quot;labels&quot;: [&quot;Eating&quot;,&quot;Drinking&quot;,&quot;Sleeping&quot;,&quot;Designing&quot;,&quot;Coding&quot;,&quot;Cycling&quot;,&quot;Running&quot;],&quot;datasets&quot;: [{&quot;label&quot;: &quot;My First Dataset&quot;,&quot;data&quot;: [65, 59, 90, 81, 56, 55, 40],&quot;fill&quot;: true,&quot;backgroundColor&quot;: &quot;rgba(255, 99, 132, 0.2)&quot;,&quot;borderColor&quot;: &quot;rgb(255, 99, 132)&quot;,&quot;pointBackgroundColor&quot;: &quot;rgb(255, 99, 132)&quot;,&quot;pointBorderColor&quot;: &quot;#fff&quot;,&quot;pointHoverBackgroundColor&quot;: &quot;#fff&quot;,&quot;pointHoverBorderColor&quot;: &quot;rgb(255, 99, 132)&quot;},{&quot;label&quot;: &quot;My Second Dataset&quot;,&quot;data&quot;: [28, 48, 40, 19, 96, 27, 100],&quot;fill&quot;: true,&quot;backgroundColor&quot;: &quot;rgba(54, 162, 235, 0.2)&quot;,&quot;borderColor&quot;: &quot;rgb(54, 162, 235)&quot;,&quot;pointBackgroundColor&quot;: &quot;rgb(54, 162, 235)&quot;,&quot;pointBorderColor&quot;: &quot;#fff&quot;,&quot;pointHoverBackgroundColor&quot;: &quot;#fff&quot;,&quot;pointHoverBorderColor&quot;: &quot;rgb(54, 162, 235)&quot;}]},&quot;options&quot;: {&quot;elements&quot;: {&quot;line&quot;: {&quot;borderWidth&quot;: 3}}}}</pre>                      </div><blockquote><p><strong>多分类饼图</strong></p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&#123;% chartjs 40,true %&#125;</span><br><span class="line">&lt;!-- chart --&gt;</span><br><span class="line">&#123;</span><br><span class="line">&quot;type&quot;: &quot;pie&quot;,</span><br><span class="line">&quot;data&quot;: &#123;</span><br><span class="line">&quot;labels&quot;: [</span><br><span class="line">&quot;编程&quot;,</span><br><span class="line">&quot;音乐&quot;,</span><br><span class="line">&quot;阅读&quot;,</span><br><span class="line">&quot;游戏&quot;,</span><br><span class="line">&quot;健身&quot;,</span><br><span class="line">&quot;旅游&quot;</span><br><span class="line">],</span><br><span class="line">&quot;datasets&quot;: [</span><br><span class="line">&#123;</span><br><span class="line">&quot;label&quot;: &quot;喜爱指数&quot;,</span><br><span class="line">&quot;data&quot;: [</span><br><span class="line">30,</span><br><span class="line">24,</span><br><span class="line">19,</span><br><span class="line">14,</span><br><span class="line">9,</span><br><span class="line">4</span><br><span class="line">],</span><br><span class="line">&quot;backgroundColor&quot;: &#123;</span><br><span class="line">&quot;dark-mode&quot;: [</span><br><span class="line">&quot;rgba(255, 99, 132, 0.5)&quot;,</span><br><span class="line">&quot;rgba(54, 162, 235, 0.5)&quot;,</span><br><span class="line">&quot;rgba(255, 206, 86, 0.5)&quot;,</span><br><span class="line">&quot;rgba(75, 192, 192, 0.5)&quot;,</span><br><span class="line">&quot;rgba(153, 102, 255, 0.5)&quot;,</span><br><span class="line">&quot;rgba(255, 159, 64, 0.5)&quot;</span><br><span class="line">],</span><br><span class="line">&quot;light-mode&quot;: [</span><br><span class="line">&quot;rgba(255, 99, 132, 0.2)&quot;,</span><br><span class="line">&quot;rgba(54, 162, 235, 0.2)&quot;,</span><br><span class="line">&quot;rgba(255, 206, 86, 0.2)&quot;,</span><br><span class="line">&quot;rgba(75, 192, 192, 0.2)&quot;,</span><br><span class="line">&quot;rgba(153, 102, 255, 0.2)&quot;,</span><br><span class="line">&quot;rgba(255, 159, 64, 0.2)&quot;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;borderColor&quot;: &#123;</span><br><span class="line">&quot;dark-mode&quot;: [</span><br><span class="line">&quot;rgba(255, 99, 132, 1)&quot;,</span><br><span class="line">&quot;rgba(54, 162, 235, 1)&quot;,</span><br><span class="line">&quot;rgba(255, 206, 86, 1)&quot;,</span><br><span class="line">&quot;rgba(75, 192, 192, 1)&quot;,</span><br><span class="line">&quot;rgba(153, 102, 255, 1)&quot;,</span><br><span class="line">&quot;rgba(255, 159, 64, 1)&quot;</span><br><span class="line">],</span><br><span class="line">&quot;light-mode&quot;: [</span><br><span class="line">&quot;rgba(255, 99, 132, 1)&quot;,</span><br><span class="line">&quot;rgba(54, 162, 235, 1)&quot;,</span><br><span class="line">&quot;rgba(255, 206, 86, 1)&quot;,</span><br><span class="line">&quot;rgba(75, 192, 192, 1)&quot;,</span><br><span class="line">&quot;rgba(153, 102, 255, 1)&quot;,</span><br><span class="line">&quot;rgba(255, 159, 64, 1)&quot;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;options&quot;: &#123;</span><br><span class="line">&quot;plugins&quot;: &#123;</span><br><span class="line">&quot;legend&quot;: &#123;</span><br><span class="line">&quot;labels&quot;: &#123;</span><br><span class="line">&quot;color&quot;: &#123;</span><br><span class="line">&quot;dark-mode&quot;: &quot;rgba(255, 255, 255, 0.8)&quot;,</span><br><span class="line">&quot;light-mode&quot;: &quot;rgba(0, 0, 0, 0.8)&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;!-- endchart --&gt;</span><br><span class="line">&lt;!-- desc --&gt;</span><br><span class="line">除了<span class="strong">**计算机编程**</span>外，我想不出还有其他让我感兴趣的工作。</span><br><span class="line">我可以无中生有地创造出<span class="strong">**精美的范式**</span>和<span class="strong">**结构**</span>，</span><br><span class="line">在此过程中也解决了无数的小谜团。</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-size:0.8em;color: var(--sep-secondtext);&quot;</span>&gt;</span></span>I can&#x27;t think of any other job other than <span class="strong">**computer</span></span><br><span class="line"><span class="strong">programming**</span> that interests me.</span><br><span class="line">I can create <span class="strong">**beautiful paradigms**</span> and <span class="strong">**structures**</span> out of nothing,</span><br><span class="line">Countless small mysteries are also solved in the process.<span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;!-- enddesc --&gt;</span><br><span class="line">&#123;% endchartjs %&#125;</span><br></pre></td></tr></table></figure><div class="chartjs-container chartjs-abreast" data-chartjs-id="" data-width="40%">            <pre class="chartjs-src" hidden>{&quot;type&quot;: &quot;pie&quot;,&quot;data&quot;: {&quot;labels&quot;: [&quot;编程&quot;,&quot;音乐&quot;,&quot;阅读&quot;,&quot;游戏&quot;,&quot;健身&quot;,&quot;旅游&quot;],&quot;datasets&quot;: [{&quot;label&quot;: &quot;喜爱指数&quot;,&quot;data&quot;: [30,24,19,14,9,4],&quot;backgroundColor&quot;: {&quot;dark-mode&quot;: [&quot;rgba(255, 99, 132, 0.5)&quot;,&quot;rgba(54, 162, 235, 0.5)&quot;,&quot;rgba(255, 206, 86, 0.5)&quot;,&quot;rgba(75, 192, 192, 0.5)&quot;,&quot;rgba(153, 102, 255, 0.5)&quot;,&quot;rgba(255, 159, 64, 0.5)&quot;],&quot;light-mode&quot;: [&quot;rgba(255, 99, 132, 0.2)&quot;,&quot;rgba(54, 162, 235, 0.2)&quot;,&quot;rgba(255, 206, 86, 0.2)&quot;,&quot;rgba(75, 192, 192, 0.2)&quot;,&quot;rgba(153, 102, 255, 0.2)&quot;,&quot;rgba(255, 159, 64, 0.2)&quot;]},&quot;borderColor&quot;: {&quot;dark-mode&quot;: [&quot;rgba(255, 99, 132, 1)&quot;,&quot;rgba(54, 162, 235, 1)&quot;,&quot;rgba(255, 206, 86, 1)&quot;,&quot;rgba(75, 192, 192, 1)&quot;,&quot;rgba(153, 102, 255, 1)&quot;,&quot;rgba(255, 159, 64, 1)&quot;],&quot;light-mode&quot;: [&quot;rgba(255, 99, 132, 1)&quot;,&quot;rgba(54, 162, 235, 1)&quot;,&quot;rgba(255, 206, 86, 1)&quot;,&quot;rgba(75, 192, 192, 1)&quot;,&quot;rgba(153, 102, 255, 1)&quot;,&quot;rgba(255, 159, 64, 1)&quot;]}}]},&quot;options&quot;: {&quot;plugins&quot;: {&quot;legend&quot;: {&quot;labels&quot;: {&quot;color&quot;: {&quot;dark-mode&quot;: &quot;rgba(255, 255, 255, 0.8)&quot;,&quot;light-mode&quot;: &quot;rgba(0, 0, 0, 0.8)&quot;}}}}}}</pre>            <div class="chartjs-desc"><p>除了<strong>计算机编程</strong>外，我想不出还有其他让我感兴趣的工作。<br>我可以无中生有地创造出<strong>精美的范式</strong>和<strong>结构</strong>，<br>在此过程中也解决了无数的小谜团。<br><span style="font-size:0.8em;color: var(--sep-secondtext);">I can’t think of any other job other than <strong>computer<br>programming</strong> that interests me.<br>I can create <strong>beautiful paradigms</strong> and <strong>structures</strong> out of nothing,<br>Countless small mysteries are also solved in the process.</span></p></div>          </div>]]></content>
      
      
      <categories>
          
          <category> Butterfly Docs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
            <tag> Tag-Plugins </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly文档(二) 功能拓展</title>
      <link href="/posts/1568d027/"/>
      <url>/posts/1568d027/</url>
      
        <content type="html"><![CDATA[<h2 id="Front-matter参数"><a href="#Front-matter参数" class="headerlink" title="Front-matter参数"></a>Front-matter参数</h2><div class="table-container"><table><thead><tr><th style="text-align:center">Front-matter 参数</th><th>含义/功能描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>title</code></td><td>文章/页面标题（必填）</td></tr><tr><td style="text-align:center"><code>date</code></td><td>文章创建日期（影响排序与时间显示）</td></tr><tr><td style="text-align:center">updated</td><td>文章最后修改日期（不填默认等于 date）</td></tr><tr><td style="text-align:center"><code>tags</code></td><td>文章标签（支持多个, e.g. [Hexo, Butterfly, 博客]）</td></tr><tr><td style="text-align:center"><code>categories</code></td><td>文章分类（支持多级, e.g. [技术, 前端]）</td></tr><tr><td style="text-align:center"><code>description / desc</code></td><td>文章描述, e.g. 这是一篇关于Butterfly主题的介绍…</td></tr><tr><td style="text-align:center">keywords</td><td>SEO 关键词, 增强搜索引擎, 需要配置SEO搜索引擎优化</td></tr><tr><td style="text-align:center">top_img</td><td>文章页顶部大图</td></tr><tr><td style="text-align:center"><code>index_img</code></td><td>首页文章卡片缩略图（没填通常使用top_img, 功能与cover一致, 新版本推荐用index_img）</td></tr><tr><td style="text-align:center"><code>sticky</code></td><td>文章自定义排序（数值越大越靠前，依赖: <code>hexo-generator-index</code>）</td></tr><tr><td style="text-align:center">comments</td><td>是否开启评论（true/false，可覆盖全局设置）</td></tr><tr><td style="text-align:center">password</td><td>单篇文章加密（不为空即加密, <strong>依赖: <code>hexo-blog-encrypt</code></strong>)</td></tr><tr><td style="text-align:center">highlight_shrink</td><td>本文代码框默认是否折叠（true=折叠 / false=展开）</td></tr><tr><td style="text-align:center">katex</td><td>是否在本页启用 KaTeX 数学公式渲染（<strong>需主题配置按需加载</strong>）</td></tr><tr><td style="text-align:center">mathjax</td><td>是否在本页启用 MathJax 数学公式渲染（<strong>需主题配置按需加载</strong>）</td></tr><tr><td style="text-align:center">toc</td><td>是否显示本文目录（可覆盖全局设置）</td></tr><tr><td style="text-align:center">toc_number</td><td>目录是否显示编号（可覆盖全局设置）</td></tr><tr><td style="text-align:center">copyright</td><td>是否显示文章版权声明（可覆盖全局）</td></tr><tr><td style="text-align:center">reward</td><td>是否显示打赏二维码（可覆盖全局）</td></tr><tr><td style="text-align:center">hide</td><td>是否在首页/归档等列表中隐藏该文章</td></tr></tbody></table></div><blockquote><p><strong>常用组合推荐</strong></p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章标题</span><br><span class="line">date: 2025-01-11 23:00:00</span><br><span class="line">updated: 2025-01-11 23:30:00</span><br><span class="line">tags: [Butterfly, Hexo]</span><br><span class="line">categories: [博客相关]</span><br><span class="line">abbrlink: # 随机定义文章URL末尾字符串</span><br><span class="line">index<span class="emphasis">_img: https://.../cover.jpg</span></span><br><span class="line"><span class="emphasis">description: 这是一篇很棒的文章摘要，会显示在首页卡片上</span></span><br><span class="line"><span class="emphasis">sticky: 10     # 想要置顶就加这个，数字越大越靠前</span></span><br><span class="line"><span class="emphasis">password: &#x27;&#x27;   # 只要有这个字段且不为空就加密</span></span><br><span class="line"><span class="emphasis">abstract: 这篇文章已被加密，需要输入密码才能查看哦~</span></span><br><span class="line"><span class="emphasis">---</span></span><br></pre></td></tr></table></figure><h2 id="全局使用"><a href="#全局使用" class="headerlink" title="全局使用"></a>全局使用</h2><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-全局使用.png" alt="全局使用"></p><blockquote><p>通过alias将hexo命令固定</p></blockquote><ol><li><p>编辑<code>.zshrc</code>文件: <code>vi ~/.zshrc</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">自定义命令别名</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Hexo 博客快捷命令</span></span><br><span class="line">alias hexo=&#x27;cd /Users/poco/Documents/Learning/hexo-blog &amp;&amp; hexo&#x27;</span><br></pre></td></tr></table></figure></li><li><p>立即生效: <code>source ~/.zshrc</code></p></li><li><p>在任意目录下执行hexo命令都可以识别, 并自动进入到hexo-blog目录下.</p></li></ol><h2 id="导航栏自定义"><a href="#导航栏自定义" class="headerlink" title="导航栏自定义"></a>导航栏自定义</h2><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E5%AF%BC%E8%88%AA%E6%A0%8F%E8%87%AA%E5%AE%9A%E4%B9%89.png" alt="导航栏自定义"></p><ol><li><p>执行命令, e.g. 新增视频模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page video</span><br></pre></td></tr></table></figure></li><li><p>新增文件<code>source/video/index.md</code>, 编辑md文件的元信息</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 视频</span><br><span class="line">date: 2026-01-10 22:56:16</span><br><span class="line"><span class="section">type: &quot;video&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></li><li><p>在<code>_config.butterfly.yml</code>添加配置项, 将video模块加载到导航栏菜单中</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">视频:</span> <span class="string">/video/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-video</span></span><br></pre></td></tr></table></figure></li></ol><blockquote><p>P.S. 当导航栏中的模块过多时, 可以在menu中增加父级菜单, 实现导航栏下拉菜单功能.</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="comment"># 添加父级菜单, hide默认隐藏不显示</span></span><br><span class="line">  <span class="string">文章</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-book</span> <span class="string">||</span> <span class="attr">hide:</span></span><br><span class="line">    <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span></span><br><span class="line">    <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br><span class="line">    <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br></pre></td></tr></table></figure><p>效果如图:</p><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E5%AF%BC%E8%88%AA%E6%A0%8F%E4%B8%8B%E6%8B%89%E8%8F%9C%E5%8D%95.png" alt="菜单列表"></p><h2 id="文章加密功能"><a href="#文章加密功能" class="headerlink" title="文章加密功能"></a>文章加密功能</h2><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E6%96%87%E7%AB%A0%E5%8A%A0%E5%AF%86.png" alt="文章加密"></p><ol><li><p>安装插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-blog-encrypt</span><br></pre></td></tr></table></figure></li><li><p>在 <code>/blog/_config.yml</code> 文件中添加以下内容:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文章加密</span></span><br><span class="line"><span class="attr">encrypt:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 文章加密提示信息</span></span><br><span class="line"><span class="attr">hexo-blog-encrypt:</span></span><br><span class="line">  <span class="attr">abstract:</span> <span class="string">这篇文章已被加密，需要输入密码才能查看哦~</span></span><br><span class="line">  <span class="attr">message:</span> <span class="string">Hey，这篇文章被加密了，请输入密码！</span></span><br><span class="line">  <span class="attr">wrong_pass_message:</span> <span class="string">Oh，密码错了，检查一下好吗～</span></span><br></pre></td></tr></table></figure></li><li><p>在想要使用加密功能的文章头部加上对应文字（仅单篇文章加密）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">password: 123456</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><ul><li>password: 该篇文章使用的密码</li><li>abstract: 摘要文字（少量）</li></ul></li></ol><ul><li>message: 密码框上的描述性文字</li></ul><h2 id="模块嵌入"><a href="#模块嵌入" class="headerlink" title="模块嵌入"></a>模块嵌入</h2><h3 id="视频模块"><a href="#视频模块" class="headerlink" title="视频模块"></a>视频模块</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/%E8%A7%86%E9%A2%91%E9%80%82%E9%85%8D.png" alt="视频模块"></p><blockquote><p>需要视频平台支持嵌入iframe框架, e.g. Bilibili, YouTube.</p></blockquote><ol><li><p>前往Hexo博客根目录，执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page video</span><br></pre></td></tr></table></figure><p>你会找到<code>source/video/index.md</code>这个文件</p></li><li><p>在<code>[BlogRoot]\source\css\custom.css</code>自定义样式的文件中引入如下代码（这是我的，你可以自行微调）：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 哔哩哔哩视频适配 */</span></span><br><span class="line"><span class="selector-class">.aspect-ratio</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">90%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">75%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">3%</span> auto;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.aspect-ratio</span> <span class="selector-tag">iframe</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">86%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>直接复制插入你的 <code>source/video/index.md</code> 文章就行，修改里面的 aid 为你视频的 AV号(<br>AV号获取方法，在网页版B站分享按钮最后一个选项，有个嵌入代码，复制插入md文件即可)：<img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/b%E9%93%BE%E6%8E%A5%E5%88%86%E4%BA%AB.png" alt="image-20260110230050461"></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 视频</span><br><span class="line">date: 2026-01-10 22:56:16</span><br><span class="line"><span class="section">type: &quot;video&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">center</span> <span class="attr">class</span>=<span class="string">&quot;aspect-ratio&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;//player.bilibili.com/player.html?isOutside=true&amp;aid=298622138&amp;bvid=BV17F411T7Ao&amp;cid=25761288170&amp;p=1&quot;</span> <span class="attr">scrolling</span>=<span class="string">&quot;no&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;no&quot;</span> <span class="attr">framespacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">allowfullscreen</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span>    scrolling=&quot;no&quot; </span><br><span class="line"><span class="code">    border=&quot;0&quot; </span></span><br><span class="line"><span class="code">    frameborder=&quot;no&quot; </span></span><br><span class="line"><span class="code">    framespacing=&quot;0&quot; </span></span><br><span class="line"><span class="code">    high_quality=1</span></span><br><span class="line"><span class="code">    danmaku=1 </span></span><br><span class="line"><span class="code">    allowfullscreen=&quot;true&quot;&gt; </span></span><br><span class="line"><span class="code">    &lt;/iframe&gt;</span></span><br><span class="line"><span class="code">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>导航栏菜单中添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">视频:</span> <span class="string">/video/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-video</span></span><br></pre></td></tr></table></figure></li><li><p>重启Hexo</p></li></ol><h3 id="音乐模块"><a href="#音乐模块" class="headerlink" title="音乐模块"></a>音乐模块</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E9%9F%B3%E4%B9%90%E6%A8%A1%E5%9D%97%E5%B5%8C%E5%85%A5.png" alt="音乐模块"></p><ol><li><p>创建音乐模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page music</span><br></pre></td></tr></table></figure></li><li><p>安装<code>hexo-tag-aplayer</code>插件</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-tag-aplayer</span><br></pre></td></tr></table></figure></li><li><p>找到项目文件夹根目录下的 <code>_config.yml</code>文件，添加如下代码：</p> <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">meting:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></li><li><p>之后打开<code>_config.butterfly.yml</code>文件，添加模块并启用插件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导航菜单设置</span></span><br><span class="line"><span class="comment"># 说明：配置顶部导航栏的菜单项，格式为 名称: 路径 || 图标</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">音乐:</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-music</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># Inject the css and script (aplayer/meting)</span></span><br><span class="line"><span class="attr">aplayerInject:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>编辑<code>source/music/index.md</code>文件</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 音乐</span><br><span class="line">date: 2026-01-10 16:03:52</span><br><span class="line"><span class="section">type: &quot;music&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line">&#123;% meting &quot;17375390739&quot; &quot;netease&quot; &quot;playlist&quot; &quot;autoplay&quot; &quot;mutex:false&quot; &quot;listmaxheight:400px&quot; &quot;preload:none&quot; &quot;theme: #ad7a86&quot; %&#125;</span><br></pre></td></tr></table></figure></li></ol><blockquote><p><a href="https://github.com/metowolf/MetingJS">MetingJS</a> 是基于<a href="https://github.com/metowolf/Meting">Meting API</a> 的 APlayer<br>衍生播放器，引入 MetingJS 后，播放器将支持对于 QQ音乐、网易云音乐、虾米、酷狗、百度等平台的音乐播放。</p></blockquote><ul><li><code>server</code>：netease（网易云音乐），tencent（QQ音乐），kugou（酷狗音乐），xiami（虾米音乐），baidu（百度音乐）。</li><li><code>type</code>：song（歌曲），playlist（歌单），album（专辑），search（搜索关键字），artist（歌手）。添加单曲选的歌曲，歌单选择playlist，可以自行尝试。</li><li>id：就是在网页版上自己歌单的ID号，但是需要注意的是歌单中不能包含VIP音乐，不然无法播放。建议使用网易云音乐。</li></ul><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/%E7%BD%91%E6%98%93%E4%BA%91%E6%AD%8C%E5%8D%95%E5%8F%B7.png" alt="image-20251031150929690"></p><blockquote><p>有关 <code>&#123;% meting %&#125;</code> 的选项列表如下:</p></blockquote><div class="table-container"><table><thead><tr><th style="text-align:center">选项</th><th style="text-align:center">默认值</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">id</td><td style="text-align:center"><strong>必填</strong></td><td>歌曲 id / 播放列表 id / 相册 id / 搜索关键字</td></tr><tr><td style="text-align:center">server</td><td style="text-align:center"><strong>必填</strong></td><td>音乐平台: <code>netease</code>, <code>tencent</code>, <code>kugou</code>, <code>xiami</code>, <code>baidu</code></td></tr><tr><td style="text-align:center">type</td><td style="text-align:center"><strong>必填</strong></td><td><code>song</code>, <code>playlist</code>, <code>album</code>, <code>search</code>, <code>artist</code></td></tr><tr><td style="text-align:center">fixed</td><td style="text-align:center"><code>false</code></td><td>开启固定模式</td></tr><tr><td style="text-align:center">mini</td><td style="text-align:center"><code>false</code></td><td>开启迷你模式</td></tr><tr><td style="text-align:center">loop</td><td style="text-align:center"><code>all</code></td><td>列表循环模式：<code>all</code>, <code>one</code>,<code>none</code></td></tr><tr><td style="text-align:center">order</td><td style="text-align:center"><code>list</code></td><td>列表播放模式： <code>list</code>, <code>random</code></td></tr><tr><td style="text-align:center">volume</td><td style="text-align:center">0.7</td><td>播放器音量</td></tr><tr><td style="text-align:center">lrctype</td><td style="text-align:center">0</td><td>歌词格式类型</td></tr><tr><td style="text-align:center">listfolded</td><td style="text-align:center"><code>false</code></td><td>指定音乐播放列表是否折叠</td></tr><tr><td style="text-align:center">storagename</td><td style="text-align:center"><code>metingjs</code></td><td>LocalStorage 中存储播放器设定的键名</td></tr><tr><td style="text-align:center">autoplay</td><td style="text-align:center"><code>true</code></td><td>自动播放，移动端浏览器暂时不支持此功能</td></tr><tr><td style="text-align:center">mutex</td><td style="text-align:center"><code>true</code></td><td>该选项开启时，如果同页面有其他 aplayer 播放，该播放器会暂停</td></tr><tr><td style="text-align:center">listmaxheight</td><td style="text-align:center"><code>340px</code></td><td>播放列表的最大长度</td></tr><tr><td style="text-align:center">preload</td><td style="text-align:center"><code>auto</code></td><td>音乐文件预载入模式，可选项： <code>none</code>, <code>metadata</code>, <code>auto</code></td></tr><tr><td style="text-align:center">theme</td><td style="text-align:center"><code>#ad7a86</code></td><td>播放器风格色彩设置</td></tr></tbody></table></div><blockquote><p>全局吸底Aplayer模式</p></blockquote><ol><li><p>在 <code>_config.butterfly.yml</code>文件中修改如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;17375390739&quot;</span> <span class="string">data-server=&quot;netease&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-autoplay=&quot;true&quot;</span> <span class="string">data-lrcType=&quot;-1&quot;&gt;</span> <span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>如果想切换页面时，音乐不会中断，就在<code>_config.butterfly.yml</code>文件中 pjax修改为true</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pjax:</span></span><br><span class="line"> <span class="attr">enable:</span> <span class="string">ture</span></span><br><span class="line"> <span class="attr">exclude:</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="照片模块"><a href="#照片模块" class="headerlink" title="照片模块"></a>照片模块</h3><blockquote><p>照片模块整理为两部分: 照片主页面, 照片详情页</p></blockquote><ol><li><p>创建照片主页面模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page wallpaper</span><br></pre></td></tr></table></figure></li><li><p>之后打开<code>_config.butterfly.yml</code>文件，添加照片模块</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">照片:</span> <span class="string">/wallpaper/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-image</span></span><br></pre></td></tr></table></figure></li><li><p>编辑<code>/wallpaper/index.md</code>文件</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 照片</span><br><span class="line">date: 2026-01-11 21:56:59</span><br><span class="line"><span class="section">type: &quot;wallpaper&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup &#x27;自然｜风景&#x27; &#x27;绝美的自然风景桌面壁纸~&#x27; &#x27;/wallpaper/nature&#x27; https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面03.png %&#125;     </span><br><span class="line"></span><br><span class="line">&#123;% galleryGroup &#x27;动漫｜二次元&#x27; &#x27;动漫高清桌面壁纸~&#x27; &#x27;/wallpaper/anime&#x27; https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物07.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><blockquote><p>外挂标签 <code>&#123;% galleryGroup %&#125;</code> 的模版: <code>&#123;% galleryGroup name description link img-url %&#125;</code>, 参数解释如下:</p></blockquote><ul><li>name：照片名称</li><li>description：描述信息</li><li>link：链接到对应相册的子页面地址</li><li>img-url：分类封面地址</li></ul><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E7%85%A7%E7%89%87%E6%A8%A1%E5%9D%97.png" alt="image-20260111225539596"></p></li><li><p>创建照片模块子页面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new page nature</span><br><span class="line">hexo new page anime</span><br></pre></td></tr></table></figure></li><li><p>但是现在<code>/source/wallpaper/index.md</code>与<code>/source/nature/index.md</code> 是平级的，所以要将<code>/nature 和 /anime</code>整个文件夹复制到<br><code>/wallpaper</code>，这样就可以实现跳转了。(注: 不需要在<code>_config.butterfly.yml</code> 的menu中添加子页面模块)</p></li><li><p>编辑子页面的index.md文件</p><ul><li><p><code>/nature</code></p>  <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 自然｜风景</span><br><span class="line">date: 2026-01-11 22:20:11</span><br><span class="line"><span class="section">type: &quot;nature&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="code">     </span></span><br><span class="line"><span class="code">&#123;% gallery %&#125;</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面01.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面02.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面03.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面04.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面05.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面06.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面07.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面08.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面09.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面10.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面11.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面12.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面13.png)</span></span><br><span class="line"><span class="code">![](https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/文章随机封面14.png)</span></span><br><span class="line"><span class="code">&#123;% endgallery %&#125;</span></span><br></pre></td></tr></table></figure></li><li><p><code>/anime</code></p>  <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 动漫｜二次元</span><br><span class="line">date: 2026-01-11 22:20:21</span><br><span class="line"><span class="section">type: &quot;anime&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物01.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物02.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物03.jpeg</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物04.jpeg</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物05.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物06.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物07.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物08.jpeg</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物09.png</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物10.jpeg</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物11.webp</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物12.jpeg</span>)</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/二次元人物13.png</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="信笺样式留言板"><a href="#信笺样式留言板" class="headerlink" title="信笺样式留言板"></a>信笺样式留言板</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%25E7%2595%2599%25E8%25A8%2580%25E6%259D%25BF.png" alt="image-20260111145408897"></p><blockquote><p>⚠️ <code>不需要执行命令: hexo new page comments</code></p></blockquote><ol><li><p>在<code>[Blogroot]</code>运行指令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-envelope --save</span><br></pre></td></tr></table></figure></li><li><p>在<code>_config.butterfly.yml</code>添加配置项（两者任选其一）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># envelope_comment</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/e2d3c450/</span></span><br><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制开关</span></span><br><span class="line">  <span class="attr">custom_pic:</span>      </span><br><span class="line">    <span class="attr">cover:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/violet.jpg</span> <span class="comment">#信笺头部图片</span></span><br><span class="line">    <span class="attr">line:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/line.png</span> <span class="comment">#信笺底部图片</span></span><br><span class="line">    <span class="attr">beforeimg:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/before.png</span> <span class="comment"># 信封前半部分</span></span><br><span class="line">    <span class="attr">afterimg:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/after.png</span> <span class="comment"># 信封后半部分</span></span><br><span class="line">  <span class="attr">message:</span> <span class="comment">#信笺正文，多行文本，写法如下</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span> <span class="comment">#仅支持单行文本</span></span><br><span class="line">  <span class="attr">height:</span> <span class="comment">#1050px，信封划出的高度</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment">#【可选】comments 的路径名称。默认为 comments，生成的页面为 comments/index.html</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment">#【可选】comments页面的 front_matter 配置</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">留言板</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>添加到导航栏菜单</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">留言板:</span> <span class="string">/comments/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-comments</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="Twikoo评论系统"><a href="#Twikoo评论系统" class="headerlink" title="Twikoo评论系统"></a>Twikoo评论系统</h2><blockquote><p>在Butterfly主题中, 集成Twikoo评论系统, 实现评论功能.</p></blockquote><ul><li><p>有自己的服务器, 使用docker部署,<br>Ref. <a href="https://tech.yemengstar.com/docker-twikoo-for-hexo/">【docker】为 Hexo 添加评论系统 | Twikoo 的部署与使用</a></p></li><li><p>没有服务器, 使用免费的 Vercel 部署,<br>Ref. <a href="https://tech.yemengstar.com/?p=10456&amp;preview=true">【Vercel】Twikoo | 为你的 HEXO 加入评论系统</a></p></li></ul><h2 id="CDN替换"><a href="#CDN替换" class="headerlink" title="CDN替换"></a>CDN替换</h2><blockquote><p>主题默认的CDN有：local、cdnjs、jsdelivr、unpkg等，但是速度比较一般，要想提高部分标准静态资源的响应速度，走CDN是最好的办法，最好是在国内的CDN。</p></blockquote><p>参考教程：</p><ol><li><a href="https://blog.csdn.net/VariatioZbw/article/details/107822562">CSDN：Web前端常用CDN网站汇总</a></li><li><a href="https://blog.zhheo.com/p/790087d9.html">洪哥：Butterfly CDN链接更改指南，替换jsdelivr提升访问速度</a></li><li><a href="https://anzhiy.cn/posts/fe76.html">安知鱼：目前可用cdn整理</a></li></ol><p>修改主题配置文件<code>_config.butterfly.yml</code>的<code>CDN</code>配置项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CDN</span></span><br><span class="line"><span class="comment"># Don&#x27;t modify the following settings unless you know how they work</span></span><br><span class="line"><span class="comment"># 非必要請不要修改</span></span><br><span class="line"><span class="attr">CDN:</span></span><br><span class="line">  <span class="comment"># The CDN provider of internal scripts (主題內部 js 的 cdn 配置)</span></span><br><span class="line">  <span class="comment"># option: local/jsdelivr/unpkg/cdnjs/custom</span></span><br><span class="line">  <span class="comment"># Dev version can only choose. ( dev版的主題只能設置為 local )</span></span><br><span class="line">  <span class="attr">internal_provider:</span> <span class="string">local</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># The CDN provider of third party scripts (第三方 js 的 cdn 配置)</span></span><br><span class="line">  <span class="comment"># option: local/jsdelivr/unpkg/cdnjs/custom</span></span><br><span class="line">  <span class="comment"># when set it to local, you need to install hexo-butterfly-extjs</span></span><br><span class="line">  <span class="attr">third_party_provider:</span> <span class="string">cdnjs</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Add version number to CDN, true or false</span></span><br><span class="line">  <span class="attr">version:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Custom format</span></span><br><span class="line">  <span class="comment"># For example: https://cdn.staticfile.org/$&#123;cdnjs_name&#125;/$&#123;version&#125;/$&#123;min_cdnjs_file&#125;</span></span><br><span class="line">  <span class="attr">custom_format:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="comment"># main_css:</span></span><br><span class="line">    <span class="comment"># main:</span></span><br><span class="line">    <span class="comment"># utils:</span></span><br><span class="line">    <span class="comment"># translate: https://cdn1.tianli0.top/npm/js-heo@1.0.6/translate/tw_cn.js</span></span><br><span class="line">    <span class="comment"># local_search:</span></span><br><span class="line">    <span class="comment"># algolia_js: </span></span><br><span class="line">    <span class="attr">algolia_search_v4:</span> <span class="string">https://cdn.staticfile.org/algoliasearch/4.14.3/algoliasearch-lite.umd.min.js</span></span><br><span class="line">    <span class="attr">instantsearch_v4:</span> <span class="string">https://cdn.staticfile.org/instantsearch.js/4.49.2/instantsearch.production.min.js</span></span><br><span class="line">    <span class="attr">pjax:</span> <span class="string">https://lib.baomitu.com/pjax/0.2.8/pjax.min.js</span></span><br><span class="line">    <span class="comment"># gitalk: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js</span></span><br><span class="line">    <span class="comment"># gitalk_css: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css</span></span><br><span class="line">    <span class="comment"># blueimp_md5:</span></span><br><span class="line">    <span class="comment"># valine: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.16/Valine.min.js</span></span><br><span class="line">    <span class="comment"># disqusjs: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/disqusjs/1.3.0/disqus.js</span></span><br><span class="line">    <span class="comment"># disqusjs_css: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/disqusjs/1.3.0/disqusjs.css</span></span><br><span class="line">    <span class="attr">twikoo:</span> <span class="string">https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js</span></span><br><span class="line">    <span class="comment"># waline_js: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/waline/1.5.4/Waline.min.js</span></span><br><span class="line">    <span class="comment"># waline_css:</span></span><br><span class="line">    <span class="attr">sharejs:</span> <span class="string">https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js</span></span><br><span class="line">    <span class="attr">sharejs_css:</span> <span class="string">https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css</span></span><br><span class="line">    <span class="comment"># mathjax: https://cdn.staticfile.org/mathjax/3.2.2/es5/mml-chtml.min.js</span></span><br><span class="line">    <span class="comment"># katex: https://lib.baomitu.com/KaTeX/latest/katex.min.css</span></span><br><span class="line">    <span class="comment"># katex_copytex:</span></span><br><span class="line">    <span class="comment"># mermaid:</span></span><br><span class="line">    <span class="comment"># canvas_ribbon:</span></span><br><span class="line">    <span class="comment"># canvas_fluttering_ribbon:</span></span><br><span class="line">    <span class="comment"># canvas_nest:</span></span><br><span class="line">    <span class="attr">lazyload:</span> <span class="string">https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js</span></span><br><span class="line">    <span class="attr">instantpage:</span> <span class="string">https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js</span></span><br><span class="line">    <span class="attr">typed:</span> <span class="string">https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/typed.js/2.0.12/typed.min.js</span></span><br><span class="line">    <span class="comment"># pangu:</span></span><br><span class="line">    <span class="attr">fancybox_css_v4:</span> <span class="string">https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css</span></span><br><span class="line">    <span class="attr">fancybox_v4:</span> <span class="string">https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js</span></span><br><span class="line">    <span class="comment"># medium_zoom: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/medium-zoom/1.0.6/medium-zoom.min.js</span></span><br><span class="line">    <span class="comment"># snackbar_css: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css</span></span><br><span class="line">    <span class="comment"># snackbar: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js</span></span><br><span class="line">    <span class="comment"># activate_power_mode:</span></span><br><span class="line">    <span class="comment"># fireworks:</span></span><br><span class="line">    <span class="comment"># click_heart:</span></span><br><span class="line">    <span class="comment"># ClickShowText:</span></span><br><span class="line">    <span class="attr">fontawesomeV6:</span> <span class="string">https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css</span></span><br><span class="line">    <span class="comment"># flickr_justified_gallery_js: https://cdn.staticfile.org/flickr-justified-gallery/2.1.2/fjGallery.min.js</span></span><br><span class="line">    <span class="comment"># flickr_justified_gallery_css: https://cdn.staticfile.org/flickr-justified-gallery/2.1.2/fjGallery.min.css</span></span><br><span class="line">    <span class="attr">aplayer_css:</span> <span class="string">https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css</span></span><br><span class="line">    <span class="attr">aplayer_js:</span> <span class="string">https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js</span></span><br><span class="line">    <span class="attr">meting_js:</span> <span class="string">https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js</span></span><br><span class="line">    <span class="comment"># prismjs_js: https://cdn1.tianli0.top/npm/prismjs@1.1.0/prism.js</span></span><br><span class="line">    <span class="comment"># prismjs_lineNumber_js: https://cdn1.tianli0.top/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js</span></span><br><span class="line">    <span class="comment"># prismjs_autoloader: https://cdn1.tianli0.top/npm/prismjs/plugins/autoloader/prism-autoloader.min.js</span></span><br></pre></td></tr></table></figure><p>修改完成后可以 <code>f12</code>-&gt;<code>源代码</code>-&gt;<code>网页</code> 看看是否已经加载到对应的资源</p><h2 id="SEO搜索引擎优化"><a href="#SEO搜索引擎优化" class="headerlink" title="SEO搜索引擎优化"></a>SEO搜索引擎优化</h2><blockquote><p>SEO 是由英文 Search Engine Optimization 缩写而来，中文意译为“搜索引擎优化”。SEO 是指通过站内优化比如网站结构调整、网站内容建设、网站代码优化等以及站外优化。</p></blockquote><h3 id="Google"><a href="#Google" class="headerlink" title="Google"></a>Google</h3><blockquote><p>登录<a href="https://search.google.com/search-console/about">谷歌搜索控制台</a>，添加网站</p></blockquote><ol><li><p>有两种登录方式，推荐使用第一种</p><ul><li><p>第一种验证方式，选择右边网址前缀，添加域名 <code>https://koco-co.github.io</code>，选择html文件验证，将下载文件放在<br><code>themes/butterfly/source</code> 下。在 <code>_config.yml</code> 中，添加忽略编译的文件，如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">baidu_verify_codexxxxxxxxxxxx.html</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">googlexxxxxxx.html</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">BingSitexxxxxxx.xml</span></span><br></pre></td></tr></table></figure></li><li><p>第二种验证方式，选择左边通过域名的dns解析，按照网页提示即可完成.</p></li></ul></li><li><p>点击左侧 <code>站点地图</code>，添加文件 <code>https://koco-co.github.io/baidusitemap.xml</code>，点击提交，然后看状态为 <code>成功</code> 即可。</p></li></ol><h3 id="Bing"><a href="#Bing" class="headerlink" title="Bing"></a>Bing</h3><blockquote><p>进入<a href="https://www.bing.com/webmasters/about">必应搜索控制台</a>，网站验证、添加站点地图，与google收录一致。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Butterfly Docs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly文档(一) 主题美化</title>
      <link href="/posts/fed949a3/"/>
      <url>/posts/fed949a3/</url>
      
        <content type="html"><![CDATA[<h2 id="全局美化"><a href="#全局美化" class="headerlink" title="全局美化"></a>全局美化</h2><h3 id="背景一图流"><a href="#背景一图流" class="headerlink" title="背景一图流"></a>背景一图流</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E8%83%8C%E6%99%AF%E4%B8%80%E5%9B%BE%E6%B5%81.png" alt="image-20260111121836208"></p><ol><li><p>在<code>[BlogRoot]\source</code>文件夹下新建一个文件夹<code>css</code>，该文件夹用于存放自定义的<code>css样式</code>，再新建一个名为<code>custom.css</code>，在里面写入以下代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页脚与头图透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#page-header</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 白天模式遮罩透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式遮罩透明 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#footer</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>[BlogRoot]\_config.butterfly.yml</code>文件中的<code>inject</code>配置项的<code>head</code>子项加入以下代码，代表引入刚刚创建的<code>custom.css</code>文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>[BlogRoot]\_config.butterfly.yml</code>文件中的<code>index_img</code>和<code>footer_bg</code>配置项取消头图与页脚图的加载项避免冗余加载</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The banner image of home page</span></span><br><span class="line"><span class="attr">index_img:</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># Footer Background</span></span><br><span class="line"><span class="attr">footer_img:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>[BlogRoot]\_config.butterfly.yml</code>文件中的<code>background</code>配置项设置背景图</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">background:</span> <span class="string">url(https://source.fomal.cc/img/home_bg.webp)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 首页设置全部置空</span></span><br><span class="line"><span class="attr">index_site_info_top:</span></span><br><span class="line"><span class="attr">index_top_img_height:</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="霓虹灯特效"><a href="#霓虹灯特效" class="headerlink" title="霓虹灯特效"></a>霓虹灯特效</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E9%BB%91%E5%A4%9C%E9%9C%93%E8%99%B9%E7%81%AF.png" alt="image-20260111122019783"></p><blockquote><p>用js计时器实现的霓虹灯性能比较低，于是弄了一个纯css关键帧实现，推荐都用这个，实测性能高挺多，Pjax适配也比较友好。</p></blockquote><ol><li><p>在自定义的<code>custom.css</code>中添加如下代码，实现的原理就是关键帧线性插值，然后一直循环，这里默认是左上角标题、中间标题和副标题，还有文章页头的标题和信息有循环霓虹灯.</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 日间模式不生效 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#site-name</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#site-title</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#site-subtitle</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#post-info</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 夜间模式生效 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#site-name</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#site-title</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: light_15px <span class="number">10s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#site-subtitle</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: light_10px <span class="number">10s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#post-info</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: light_5px <span class="number">10s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 关键帧描述 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> light_15px &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#5636ed</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">12.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#11ee5e</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">25%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f14747</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">37.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f1a247</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f1ee47</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#b347f1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">62.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#002afa</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">75%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#ed709b</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">87.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#39c5bb</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#5636ed</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> light_10px &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#5636ed</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">12.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#11ee5e</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">25%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f14747</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">37.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f1a247</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f1ee47</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#b347f1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">62.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#002afa</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">75%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#ed709b</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">87.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#39c5bb</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#5636ed</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> light_5px &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#5636ed</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">12.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#11ee5e</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">25%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f14747</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">37.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f1a247</span> <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#f1ee47</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#b347f1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">62.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#002afa</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">75%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#ed709b</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">87.5%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#39c5bb</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">#5636ed</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>刷新页面即可看到效果，默认是夜间模式才开启的，因为白天模式开启霓虹灯会显得很奇怪</p></li></ol><h3 id="流星特效"><a href="#流星特效" class="headerlink" title="流星特效"></a>流星特效</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E6%98%9F%E7%A9%BA%E8%83%8C%E6%99%AF%E5%92%8C%E6%B5%81%E6%98%9F%E7%89%B9%E6%95%88.png" alt="image-20260111122102326"></p><ol><li><p>在<code>[BlogRoot]/source/js</code>目录下新建<code>universe.js</code>，输入以下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dark</span>(<span class="params"></span>) &#123;<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>=<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span>;<span class="keyword">var</span> n,e,i,h,t=<span class="number">.05</span>,s=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;universe&quot;</span>),o=!<span class="number">0</span>,a=<span class="string">&quot;180,184,240&quot;</span>,r=<span class="string">&quot;226,225,142&quot;</span>,d=<span class="string">&quot;226,225,224&quot;</span>,c=[];<span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>)&#123;n=<span class="variable language_">window</span>.<span class="property">innerWidth</span>,e=<span class="variable language_">window</span>.<span class="property">innerHeight</span>,i=<span class="number">.216</span>*n,s.<span class="title function_">setAttribute</span>(<span class="string">&quot;width&quot;</span>,n),s.<span class="title function_">setAttribute</span>(<span class="string">&quot;height&quot;</span>,e)&#125;<span class="keyword">function</span> <span class="title function_">u</span>(<span class="params"></span>)&#123;h.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,n,e);<span class="keyword">for</span>(<span class="keyword">var</span> t=c.<span class="property">length</span>,i=<span class="number">0</span>;i&lt;t;i++)&#123;<span class="keyword">var</span> s=c[i];s.<span class="title function_">move</span>(),s.<span class="title function_">fadeIn</span>(),s.<span class="title function_">fadeOut</span>(),s.<span class="title function_">draw</span>()&#125;&#125;<span class="keyword">function</span> <span class="title function_">y</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">reset</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">giant</span>=<span class="title function_">m</span>(<span class="number">3</span>),<span class="variable language_">this</span>.<span class="property">comet</span>=!<span class="variable language_">this</span>.<span class="property">giant</span>&amp;&amp;!o&amp;&amp;<span class="title function_">m</span>(<span class="number">10</span>),<span class="variable language_">this</span>.<span class="property">x</span>=<span class="title function_">l</span>(<span class="number">0</span>,n-<span class="number">10</span>),<span class="variable language_">this</span>.<span class="property">y</span>=<span class="title function_">l</span>(<span class="number">0</span>,e),<span class="variable language_">this</span>.<span class="property">r</span>=<span class="title function_">l</span>(<span class="number">1.1</span>,<span class="number">2.6</span>),<span class="variable language_">this</span>.<span class="property">dx</span>=<span class="title function_">l</span>(t,<span class="number">6</span>*t)+(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)*t*<span class="title function_">l</span>(<span class="number">50</span>,<span class="number">120</span>)+<span class="number">2</span>*t,<span class="variable language_">this</span>.<span class="property">dy</span>=-<span class="title function_">l</span>(t,<span class="number">6</span>*t)-(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)*t*<span class="title function_">l</span>(<span class="number">50</span>,<span class="number">120</span>),<span class="variable language_">this</span>.<span class="property">fadingOut</span>=<span class="literal">null</span>,<span class="variable language_">this</span>.<span class="property">fadingIn</span>=!<span class="number">0</span>,<span class="variable language_">this</span>.<span class="property">opacity</span>=<span class="number">0</span>,<span class="variable language_">this</span>.<span class="property">opacityTresh</span>=<span class="title function_">l</span>(<span class="number">.2</span>,<span class="number">1</span>-<span class="number">.4</span>*(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)),<span class="variable language_">this</span>.<span class="property">do</span>=<span class="title function_">l</span>(<span class="number">5e-4</span>,<span class="number">.002</span>)+<span class="number">.001</span>*(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)&#125;,<span class="variable language_">this</span>.<span class="property">fadeIn</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">fadingIn</span>&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingIn</span>=!(<span class="variable language_">this</span>.<span class="property">opacity</span>&gt;<span class="variable language_">this</span>.<span class="property">opacityTresh</span>),<span class="variable language_">this</span>.<span class="property">opacity</span>+=<span class="variable language_">this</span>.<span class="property">do</span>)&#125;,<span class="variable language_">this</span>.<span class="property">fadeOut</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">fadingOut</span>&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!(<span class="variable language_">this</span>.<span class="property">opacity</span>&lt;<span class="number">0</span>),<span class="variable language_">this</span>.<span class="property">opacity</span>-=<span class="variable language_">this</span>.<span class="property">do</span>/<span class="number">2</span>,(<span class="variable language_">this</span>.<span class="property">x</span>&gt;n||<span class="variable language_">this</span>.<span class="property">y</span>&lt;<span class="number">0</span>)&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!<span class="number">1</span>,<span class="variable language_">this</span>.<span class="title function_">reset</span>()))&#125;,<span class="variable language_">this</span>.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(h.<span class="title function_">beginPath</span>(),<span class="variable language_">this</span>.<span class="property">giant</span>)h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+a+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">arc</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">1</span>);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">comet</span>)&#123;h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+d+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">arc</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="number">1.5</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">1</span>);<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;<span class="number">30</span>;t++)h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+d+<span class="string">&quot;,&quot;</span>+(<span class="variable language_">this</span>.<span class="property">opacity</span>-<span class="variable language_">this</span>.<span class="property">opacity</span>/<span class="number">20</span>*t)+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">rect</span>(<span class="variable language_">this</span>.<span class="property">x</span>-<span class="variable language_">this</span>.<span class="property">dx</span>/<span class="number">4</span>*t,<span class="variable language_">this</span>.<span class="property">y</span>-<span class="variable language_">this</span>.<span class="property">dy</span>/<span class="number">4</span>*t-<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>),h.<span class="title function_">fill</span>()&#125;<span class="keyword">else</span> h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">rect</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="variable language_">this</span>.<span class="property">r</span>,<span class="variable language_">this</span>.<span class="property">r</span>);h.<span class="title function_">closePath</span>(),h.<span class="title function_">fill</span>()&#125;,<span class="variable language_">this</span>.<span class="property">move</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">x</span>+=<span class="variable language_">this</span>.<span class="property">dx</span>,<span class="variable language_">this</span>.<span class="property">y</span>+=<span class="variable language_">this</span>.<span class="property">dy</span>,!<span class="number">1</span>===<span class="variable language_">this</span>.<span class="property">fadingOut</span>&amp;&amp;<span class="variable language_">this</span>.<span class="title function_">reset</span>(),(<span class="variable language_">this</span>.<span class="property">x</span>&gt;n-n/<span class="number">4</span>||<span class="variable language_">this</span>.<span class="property">y</span>&lt;<span class="number">0</span>)&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!<span class="number">0</span>)&#125;,<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;o=!<span class="number">1</span>&#125;,<span class="number">50</span>)&#125;<span class="keyword">function</span> <span class="title function_">m</span>(<span class="params">t</span>)&#123;<span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">1e3</span>*<span class="title class_">Math</span>.<span class="title function_">random</span>())+<span class="number">1</span>&lt;<span class="number">10</span>*t&#125;<span class="keyword">function</span> <span class="title function_">l</span>(<span class="params">t,i</span>)&#123;<span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">random</span>()*(i-t)+t&#125;<span class="title function_">f</span>(),<span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>,f,!<span class="number">1</span>),<span class="keyword">function</span>(<span class="params"></span>)&#123;h=s.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;i;t++)c[t]=<span class="keyword">new</span> y,c[t].<span class="title function_">reset</span>();<span class="title function_">u</span>()&#125;(),<span class="keyword">function</span> <span class="title function_">t</span>(<span class="params"></span>)&#123;<span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;html&#x27;</span>)[<span class="number">0</span>].<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>)==<span class="string">&#x27;dark&#x27;</span>&amp;&amp;<span class="title function_">u</span>(),<span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(t)&#125;()&#125;;</span><br><span class="line"><span class="title function_">dark</span>()</span><br></pre></td></tr></table></figure></li><li><p>在<code>[BlogRoot]/source/css</code>目录下新建<code>universe.css</code>，输入以下代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 背景宇宙星光  */</span></span><br><span class="line"><span class="selector-id">#universe</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="comment">/* 这个是调置顶的优先级的，-1在文章页下面，背景上面，个人推荐这种 */</span></span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>_config.butterfly.yml</code>的<code>inject</code>配置项中<code>bottom</code>下填入：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;canvas</span> <span class="string">id=&quot;universe&quot;&gt;&lt;/canvas&gt;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;/js/universe.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>_config.butterfly.yml</code>的<code>inject</code>配置项中<code>head</code>下填入：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  - &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/universe.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="雪花特效"><a href="#雪花特效" class="headerlink" title="雪花特效"></a>雪花特效</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E9%9B%AA%E8%8A%B1%E7%89%B9%E6%95%88.png" alt="image-20260111124409925"></p><ol><li><p>新建<code>[BlogRoot]\source\js\snow.js</code>，并写入以下代码，其中雪花的参数是可以自行调节的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((navigator.<span class="property">userAgent</span>.<span class="title function_">match</span>(<span class="regexp">/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>))) &#123;</span><br><span class="line">    <span class="comment">// 移动端不显示</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// document.write(&#x27;&lt;canvas id=&quot;snow&quot; style=&quot;position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;pointer-events:none&quot;&gt;&lt;/canvas&gt;&#x27;);</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span> &amp;&amp; (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> e = &#123;</span><br><span class="line">            <span class="attr">flakeCount</span>: <span class="number">50</span>, <span class="comment">// 雪花数目</span></span><br><span class="line">            <span class="attr">minDist</span>: <span class="number">150</span>,   <span class="comment">// 最小距离</span></span><br><span class="line">            <span class="attr">color</span>: <span class="string">&quot;255, 255, 255&quot;</span>, <span class="comment">// 雪花颜色</span></span><br><span class="line">            <span class="attr">size</span>: <span class="number">1.5</span>,  <span class="comment">// 雪花大小</span></span><br><span class="line">            <span class="attr">speed</span>: <span class="number">.5</span>,  <span class="comment">// 雪花速度</span></span><br><span class="line">            <span class="attr">opacity</span>: <span class="number">.7</span>,    <span class="comment">// 雪花透明度</span></span><br><span class="line">            <span class="attr">stepsize</span>: <span class="number">.5</span>    <span class="comment">// 步距</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> t = <span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span> || <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(e, <span class="number">1e3</span> / <span class="number">60</span>)</span><br><span class="line">        &#125;</span><br><span class="line">            ;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span> = t;</span><br><span class="line">        <span class="keyword">const</span> i = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;snow&quot;</span>),</span><br><span class="line">            n = i.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>),</span><br><span class="line">            o = e.<span class="property">flakeCount</span>;</span><br><span class="line">        <span class="keyword">let</span> a = -<span class="number">100</span>,</span><br><span class="line">            d = -<span class="number">100</span>,</span><br><span class="line">            s = [];</span><br><span class="line">        i.<span class="property">width</span> = <span class="variable language_">window</span>.<span class="property">innerWidth</span>,</span><br><span class="line">            i.<span class="property">height</span> = <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">h</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            n.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, i.<span class="property">width</span>, i.<span class="property">height</span>);</span><br><span class="line">            <span class="keyword">const</span> r = e.<span class="property">minDist</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> t = <span class="number">0</span>; t &lt; o; t++) &#123;</span><br><span class="line">                <span class="keyword">let</span> o = s[t];</span><br><span class="line">                <span class="keyword">const</span> h = a,</span><br><span class="line">                    w = d,</span><br><span class="line">                    m = o.<span class="property">x</span>,</span><br><span class="line">                    c = o.<span class="property">y</span>,</span><br><span class="line">                    p = <span class="title class_">Math</span>.<span class="title function_">sqrt</span>((h - m) * (h - m) + (w - c) * (w - c));</span><br><span class="line">                <span class="keyword">if</span> (p &lt; r) &#123;</span><br><span class="line">                    <span class="keyword">const</span> e = (h - m) / p,</span><br><span class="line">                        t = (w - c) / p,</span><br><span class="line">                        i = r / (p * p) / <span class="number">2</span>;</span><br><span class="line">                    o.<span class="property">velX</span> -= i * e,</span><br><span class="line">                        o.<span class="property">velY</span> -= i * t</span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                    o.<span class="property">velX</span> *= <span class="number">.98</span>,</span><br><span class="line">                        o.<span class="property">velY</span> &lt; o.<span class="property">speed</span> &amp;&amp; o.<span class="property">speed</span> - o.<span class="property">velY</span> &gt; <span class="number">.01</span> &amp;&amp; (o.<span class="property">velY</span> += <span class="number">.01</span> * (o.<span class="property">speed</span> - o.<span class="property">velY</span>)),</span><br><span class="line">                        o.<span class="property">velX</span> += <span class="title class_">Math</span>.<span class="title function_">cos</span>(o.<span class="property">step</span> += <span class="number">.05</span>) * o.<span class="property">stepSize</span>;</span><br><span class="line">                n.<span class="property">fillStyle</span> = <span class="string">&quot;rgba(&quot;</span> + e.<span class="property">color</span> + <span class="string">&quot;, &quot;</span> + o.<span class="property">opacity</span> + <span class="string">&quot;)&quot;</span>,</span><br><span class="line">                    o.<span class="property">y</span> += o.<span class="property">velY</span>,</span><br><span class="line">                    o.<span class="property">x</span> += o.<span class="property">velX</span>,</span><br><span class="line">                    (o.<span class="property">y</span> &gt;= i.<span class="property">height</span> || o.<span class="property">y</span> &lt;= <span class="number">0</span>) &amp;&amp; <span class="title function_">l</span>(o),</span><br><span class="line">                    (o.<span class="property">x</span> &gt;= i.<span class="property">width</span> || o.<span class="property">x</span> &lt;= <span class="number">0</span>) &amp;&amp; <span class="title function_">l</span>(o),</span><br><span class="line">                    n.<span class="title function_">beginPath</span>(),</span><br><span class="line">                    n.<span class="title function_">arc</span>(o.<span class="property">x</span>, o.<span class="property">y</span>, o.<span class="property">size</span>, <span class="number">0</span>, <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span>),</span><br><span class="line">                    n.<span class="title function_">fill</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">t</span>(h)</span><br><span class="line">        &#125;</span><br><span class="line">            , l = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">                e.<span class="property">x</span> = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * i.<span class="property">width</span>),</span><br><span class="line">                    e.<span class="property">y</span> = <span class="number">0</span>,</span><br><span class="line">                    e.<span class="property">size</span> = <span class="number">3</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>() + <span class="number">2</span>,</span><br><span class="line">                    e.<span class="property">speed</span> = <span class="number">1</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>() + <span class="number">.5</span>,</span><br><span class="line">                    e.<span class="property">velY</span> = e.<span class="property">speed</span>,</span><br><span class="line">                    e.<span class="property">velX</span> = <span class="number">0</span>,</span><br><span class="line">                    e.<span class="property">opacity</span> = <span class="number">.5</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>() + <span class="number">.3</span></span><br><span class="line">            &#125;</span><br><span class="line">            ;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, (<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">            a = e.<span class="property">clientX</span>,</span><br><span class="line">                d = e.<span class="property">clientY</span></span><br><span class="line">        &#125;</span><br><span class="line">        )),</span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>, (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                i.<span class="property">width</span> = <span class="variable language_">window</span>.<span class="property">innerWidth</span>,</span><br><span class="line">                    i.<span class="property">height</span> = <span class="variable language_">window</span>.<span class="property">innerHeight</span></span><br><span class="line">            &#125;</span><br><span class="line">            )),</span><br><span class="line">            (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">let</span> t = <span class="number">0</span>; t &lt; o; t++) &#123;</span><br><span class="line">                    <span class="keyword">const</span> t = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * i.<span class="property">width</span>)</span><br><span class="line">                        , n = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * i.<span class="property">height</span>)</span><br><span class="line">                        , o = <span class="number">3</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>() + e.<span class="property">size</span></span><br><span class="line">                        , a = <span class="number">1</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>() + e.<span class="property">speed</span></span><br><span class="line">                        , d = <span class="number">.5</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>() + e.<span class="property">opacity</span>;</span><br><span class="line">                    s.<span class="title function_">push</span>(&#123;</span><br><span class="line">                        <span class="attr">speed</span>: a,</span><br><span class="line">                        <span class="attr">velX</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">velY</span>: a,</span><br><span class="line">                        <span class="attr">x</span>: t,</span><br><span class="line">                        <span class="attr">y</span>: n,</span><br><span class="line">                        <span class="attr">size</span>: o,</span><br><span class="line">                        <span class="attr">stepSize</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>() / <span class="number">30</span> * e.<span class="property">stepsize</span>,</span><br><span class="line">                        <span class="attr">step</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">angle</span>: <span class="number">180</span>,</span><br><span class="line">                        <span class="attr">opacity</span>: d</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">h</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            )()</span><br><span class="line">    &#125;</span><br><span class="line">    )();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在自定义css文件<code>custom.css</code>写入如下代码，我这里设置只在白天模式显示，你可以自行设置，这里比较简单，本质就是调节画布的显示参数：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 雪花特效 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#snow</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 雪花黑夜模式不显示 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#snow</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>引入画布元素：在主题配置文件<code>_config.butterfly.yml</code>文件的引入js文件和一个<code>canvas</code>画布：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span> </span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">&lt;canvas</span> <span class="string">id=&quot;snow&quot;&gt;&lt;/canvas&gt;</span> <span class="comment"># 雪花画布</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/snow.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># 雪花特效</span></span><br></pre></td></tr></table></figure></li><li><p>重启项目即可看到效果，注意：只在白天模式显示.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol><h3 id="节日特效"><a href="#节日特效" class="headerlink" title="节日特效"></a>节日特效</h3><blockquote><p>本质就是用的<code>sessionStorage</code>这个本地存储对象去确定是不是同一个会话，如果是同一个的话，就弹窗一次，如果下次进来了就不是同一个会话了，又会弹窗一次</p></blockquote><ol><li><p>新建<code>[BlogRoot]\source\js\day.js</code>，并写入以下代码，这里公祭日灰度我设置的为<code>60%</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">m = d.<span class="title function_">getMonth</span>() + <span class="number">1</span>;</span><br><span class="line">dd = d.<span class="title function_">getDate</span>();</span><br><span class="line">y = d.<span class="title function_">getFullYear</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 公祭日</span></span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">9</span> &amp;&amp; dd == <span class="number">18</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;html&quot;</span>)[<span class="number">0</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;filter: grayscale(60%);&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;今天是九一八事变&quot;</span> + (y - <span class="number">1931</span>).<span class="title function_">toString</span>() + <span class="string">&quot;周年纪念日\n🪔勿忘国耻，振兴中华🪔&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">7</span> &amp;&amp; dd == <span class="number">7</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;html&quot;</span>)[<span class="number">0</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;filter: grayscale(60%);&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;今天是卢沟桥事变&quot;</span> + (y - <span class="number">1937</span>).<span class="title function_">toString</span>() + <span class="string">&quot;周年纪念日\n🪔勿忘国耻，振兴中华🪔&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">12</span> &amp;&amp; dd == <span class="number">13</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;html&quot;</span>)[<span class="number">0</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;filter: grayscale(60%);&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;今天是南京大屠杀&quot;</span> + (y - <span class="number">1937</span>).<span class="title function_">toString</span>() + <span class="string">&quot;周年纪念日\n🪔勿忘国耻，振兴中华🪔&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">8</span> &amp;&amp; dd == <span class="number">14</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;html&quot;</span>)[<span class="number">0</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;filter: grayscale(60%);&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;今天是世界慰安妇纪念日\n🪔勿忘国耻，振兴中华🪔&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 节假日</span></span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">10</span> &amp;&amp; dd &lt;= <span class="number">3</span>) &#123;<span class="comment">//国庆节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;祝祖国&quot;</span> + (y - <span class="number">1949</span>).<span class="title function_">toString</span>() + <span class="string">&quot;岁生日快乐！&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">8</span> &amp;&amp; dd == <span class="number">15</span>) &#123;<span class="comment">//搞来玩的，小日子投降</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;小日子已经投降&quot;</span> + (y - <span class="number">1945</span>).<span class="title function_">toString</span>() + <span class="string">&quot;年了😃&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">1</span> &amp;&amp; dd == <span class="number">1</span>) &#123;<span class="comment">//元旦节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(y.<span class="title function_">toString</span>() + <span class="string">&quot;年元旦快乐！🎉&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">3</span> &amp;&amp; dd == <span class="number">8</span>) &#123;<span class="comment">//妇女节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;各位女神们，妇女节快乐！👩&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">l = [<span class="string">&quot;非常抱歉，因为不可控原因，博客将于明天停止运营！&quot;</span>, <span class="string">&quot;好消息，日本没了！&quot;</span>, <span class="string">&quot;美国垮了，原因竟然是川普！&quot;</span>, <span class="string">&quot;微软垮了！&quot;</span>, <span class="string">&quot;你的电脑已经过载，建议立即关机！&quot;</span>, <span class="string">&quot;你知道吗？站长很喜欢你哦！&quot;</span>, <span class="string">&quot;一分钟有61秒哦&quot;</span>, <span class="string">&quot;你喜欢的人跟别人跑了！&quot;</span>]</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">4</span> &amp;&amp; dd == <span class="number">1</span>) &#123;<span class="comment">//愚人节，随机谎话</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(l[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * l.<span class="property">length</span>)]);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">5</span> &amp;&amp; dd == <span class="number">1</span>) &#123;<span class="comment">//劳动节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;劳动节快乐\n为各行各业辛勤工作的人们致敬！&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">5</span> &amp;&amp; dd == <span class="number">4</span>) &#123;<span class="comment">//青年节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;青年节快乐\n青春不是回忆逝去,而是把握现在！&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">5</span> &amp;&amp; dd == <span class="number">20</span>) &#123;<span class="comment">//520</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;今年是520情人节\n快和你喜欢的人一起过吧！💑&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">7</span> &amp;&amp; dd == <span class="number">1</span>) &#123;<span class="comment">//建党节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;祝中国共产党&quot;</span> + (y - <span class="number">1921</span>).<span class="title function_">toString</span>() + <span class="string">&quot;岁生日快乐！&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">9</span> &amp;&amp; dd == <span class="number">10</span>) &#123;<span class="comment">//教师节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;各位老师们教师节快乐！👩‍🏫&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">12</span> &amp;&amp; dd == <span class="number">25</span>) &#123;<span class="comment">//圣诞节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;圣诞节快乐！🎄&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//传统节日部分</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((y == <span class="number">2023</span> &amp;&amp; m == <span class="number">4</span> &amp;&amp; dd == <span class="number">5</span>) || (y == <span class="number">2024</span> &amp;&amp; m == <span class="number">4</span> &amp;&amp; dd == <span class="number">4</span>) || (y == <span class="number">2025</span> &amp;&amp; m == <span class="number">4</span> &amp;&amp; dd == <span class="number">4</span>)) &#123;<span class="comment">//清明节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;清明时节雨纷纷,一束鲜花祭故人💐&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((y == <span class="number">2023</span> &amp;&amp; m == <span class="number">12</span> &amp;&amp; dd == <span class="number">22</span>) || (y == <span class="number">2024</span> &amp;&amp; m == <span class="number">12</span> &amp;&amp; dd == <span class="number">21</span>) || (y == <span class="number">2025</span> &amp;&amp; m == <span class="number">12</span> &amp;&amp; dd == <span class="number">21</span>)) &#123;<span class="comment">//冬至</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;冬至快乐\n快吃上一碗热热的汤圆和饺子吧🧆&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lunar = calendarFormatter.<span class="title function_">solar2lunar</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//农历采用汉字计算，防止出现闰月导致问题</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初六&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初五&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初四&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初三&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初二&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初一&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;腊月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;三十&quot;</span>) || (lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;腊月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;廿九&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//春节，本来只有大年三十到初六，但是有时候除夕是大年二十九，所以也加上了</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(y.<span class="title function_">toString</span>() + <span class="string">&quot;年新年快乐\n🎊祝你心想事成，诸事顺利🎊&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;正月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;十五&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//元宵节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;元宵节快乐\n送你一个大大的灯笼🧅&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;五月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初五&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//端午节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;端午节快乐\n请你吃一条粽子🍙&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;七月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初七&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//七夕节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;七夕节快乐\n黄昏后,柳梢头,牛郎织女来碰头&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;八月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;十五&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//中秋节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;中秋节快乐\n请你吃一块月饼🍪&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((lunar[<span class="string">&quot;IMonthCn&quot;</span>] == <span class="string">&quot;九月&quot;</span> &amp;&amp; lunar[<span class="string">&quot;IDayCn&quot;</span>] == <span class="string">&quot;初九&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//重阳节</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>) != <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="title class_">Swal</span>.<span class="title function_">fire</span>(<span class="string">&quot;重阳节快乐\n独在异乡为异客，每逢佳节倍思亲&quot;</span>);</span><br><span class="line">        <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isPopupWindow&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切换主题提醒</span></span><br><span class="line"><span class="comment">// if (y == 2022 &amp;&amp; m == 12 &amp;&amp; (dd &gt;= 18 &amp;&amp; dd &lt;= 20)) &#123;</span></span><br><span class="line"><span class="comment">//     if (sessionStorage.getItem(&quot;isPopupWindow&quot;) != &quot;1&quot;) &#123;</span></span><br><span class="line"><span class="comment">//         Swal.fire(&quot;网站换成冬日限定主题啦⛄&quot;);</span></span><br><span class="line"><span class="comment">//         sessionStorage.setItem(&quot;isPopupWindow&quot;, &quot;1&quot;);</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure></li><li><p>由于有的节日是农历的，因此还要引入一个计算农历的代码，新建<code>[BlogRoot]\source\js\lunar.js</code>，并写入以下代码，太长了压缩了一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lunarInfo=[<span class="number">19416</span>,<span class="number">19168</span>,<span class="number">42352</span>,<span class="number">21717</span>,<span class="number">53856</span>,<span class="number">55632</span>,<span class="number">91476</span>,<span class="number">22176</span>,<span class="number">39632</span>,<span class="number">21970</span>,<span class="number">19168</span>,<span class="number">42422</span>,<span class="number">42192</span>,<span class="number">53840</span>,<span class="number">119381</span>,<span class="number">46400</span>,<span class="number">54944</span>,<span class="number">44450</span>,<span class="number">38320</span>,<span class="number">84343</span>,<span class="number">18800</span>,<span class="number">42160</span>,<span class="number">46261</span>,<span class="number">27216</span>,<span class="number">27968</span>,<span class="number">109396</span>,<span class="number">11104</span>,<span class="number">38256</span>,<span class="number">21234</span>,<span class="number">18800</span>,<span class="number">25958</span>,<span class="number">54432</span>,<span class="number">59984</span>,<span class="number">28309</span>,<span class="number">23248</span>,<span class="number">11104</span>,<span class="number">100067</span>,<span class="number">37600</span>,<span class="number">116951</span>,<span class="number">51536</span>,<span class="number">54432</span>,<span class="number">120998</span>,<span class="number">46416</span>,<span class="number">22176</span>,<span class="number">107956</span>,<span class="number">9680</span>,<span class="number">37584</span>,<span class="number">53938</span>,<span class="number">43344</span>,<span class="number">46423</span>,<span class="number">27808</span>,<span class="number">46416</span>,<span class="number">86869</span>,<span class="number">19872</span>,<span class="number">42416</span>,<span class="number">83315</span>,<span class="number">21168</span>,<span class="number">43432</span>,<span class="number">59728</span>,<span class="number">27296</span>,<span class="number">44710</span>,<span class="number">43856</span>,<span class="number">19296</span>,<span class="number">43748</span>,<span class="number">42352</span>,<span class="number">21088</span>,<span class="number">62051</span>,<span class="number">55632</span>,<span class="number">23383</span>,<span class="number">22176</span>,<span class="number">38608</span>,<span class="number">19925</span>,<span class="number">19152</span>,<span class="number">42192</span>,<span class="number">54484</span>,<span class="number">53840</span>,<span class="number">54616</span>,<span class="number">46400</span>,<span class="number">46752</span>,<span class="number">103846</span>,<span class="number">38320</span>,<span class="number">18864</span>,<span class="number">43380</span>,<span class="number">42160</span>,<span class="number">45690</span>,<span class="number">27216</span>,<span class="number">27968</span>,<span class="number">44870</span>,<span class="number">43872</span>,<span class="number">38256</span>,<span class="number">19189</span>,<span class="number">18800</span>,<span class="number">25776</span>,<span class="number">29859</span>,<span class="number">59984</span>,<span class="number">27480</span>,<span class="number">23232</span>,<span class="number">43872</span>,<span class="number">38613</span>,<span class="number">37600</span>,<span class="number">51552</span>,<span class="number">55636</span>,<span class="number">54432</span>,<span class="number">55888</span>,<span class="number">30034</span>,<span class="number">22176</span>,<span class="number">43959</span>,<span class="number">9680</span>,<span class="number">37584</span>,<span class="number">51893</span>,<span class="number">43344</span>,<span class="number">46240</span>,<span class="number">47780</span>,<span class="number">44368</span>,<span class="number">21977</span>,<span class="number">19360</span>,<span class="number">42416</span>,<span class="number">86390</span>,<span class="number">21168</span>,<span class="number">43312</span>,<span class="number">31060</span>,<span class="number">27296</span>,<span class="number">44368</span>,<span class="number">23378</span>,<span class="number">19296</span>,<span class="number">42726</span>,<span class="number">42208</span>,<span class="number">53856</span>,<span class="number">60005</span>,<span class="number">54576</span>,<span class="number">23200</span>,<span class="number">30371</span>,<span class="number">38608</span>,<span class="number">19195</span>,<span class="number">19152</span>,<span class="number">42192</span>,<span class="number">118966</span>,<span class="number">53840</span>,<span class="number">54560</span>,<span class="number">56645</span>,<span class="number">46496</span>,<span class="number">22224</span>,<span class="number">21938</span>,<span class="number">18864</span>,<span class="number">42359</span>,<span class="number">42160</span>,<span class="number">43600</span>,<span class="number">111189</span>,<span class="number">27936</span>,<span class="number">44448</span>,<span class="number">84835</span>,<span class="number">37744</span>,<span class="number">18936</span>,<span class="number">18800</span>,<span class="number">25776</span>,<span class="number">92326</span>,<span class="number">59984</span>,<span class="number">27424</span>,<span class="number">108228</span>,<span class="number">43744</span>,<span class="number">41696</span>,<span class="number">53987</span>,<span class="number">51552</span>,<span class="number">54615</span>,<span class="number">54432</span>,<span class="number">55888</span>,<span class="number">23893</span>,<span class="number">22176</span>,<span class="number">42704</span>,<span class="number">21972</span>,<span class="number">21200</span>,<span class="number">43448</span>,<span class="number">43344</span>,<span class="number">46240</span>,<span class="number">46758</span>,<span class="number">44368</span>,<span class="number">21920</span>,<span class="number">43940</span>,<span class="number">42416</span>,<span class="number">21168</span>,<span class="number">45683</span>,<span class="number">26928</span>,<span class="number">29495</span>,<span class="number">27296</span>,<span class="number">44368</span>,<span class="number">84821</span>,<span class="number">19296</span>,<span class="number">42352</span>,<span class="number">21732</span>,<span class="number">53600</span>,<span class="number">59752</span>,<span class="number">54560</span>,<span class="number">55968</span>,<span class="number">92838</span>,<span class="number">22224</span>,<span class="number">19168</span>,<span class="number">43476</span>,<span class="number">41680</span>,<span class="number">53584</span>,<span class="number">62034</span>,<span class="number">54560</span>],solarMonth=[<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>],<span class="title class_">Gan</span>=[<span class="string">&quot;甲&quot;</span>,<span class="string">&quot;乙&quot;</span>,<span class="string">&quot;丙&quot;</span>,<span class="string">&quot;丁&quot;</span>,<span class="string">&quot;戊&quot;</span>,<span class="string">&quot;己&quot;</span>,<span class="string">&quot;庚&quot;</span>,<span class="string">&quot;辛&quot;</span>,<span class="string">&quot;壬&quot;</span>,<span class="string">&quot;癸&quot;</span>],<span class="title class_">Zhi</span>=[<span class="string">&quot;子&quot;</span>,<span class="string">&quot;丑&quot;</span>,<span class="string">&quot;寅&quot;</span>,<span class="string">&quot;卯&quot;</span>,<span class="string">&quot;辰&quot;</span>,<span class="string">&quot;巳&quot;</span>,<span class="string">&quot;午&quot;</span>,<span class="string">&quot;未&quot;</span>,<span class="string">&quot;申&quot;</span>,<span class="string">&quot;酉&quot;</span>,<span class="string">&quot;戌&quot;</span>,<span class="string">&quot;亥&quot;</span>],<span class="title class_">Animals</span>=[<span class="string">&quot;鼠&quot;</span>,<span class="string">&quot;牛&quot;</span>,<span class="string">&quot;虎&quot;</span>,<span class="string">&quot;兔&quot;</span>,<span class="string">&quot;龙&quot;</span>,<span class="string">&quot;蛇&quot;</span>,<span class="string">&quot;马&quot;</span>,<span class="string">&quot;羊&quot;</span>,<span class="string">&quot;猴&quot;</span>,<span class="string">&quot;鸡&quot;</span>,<span class="string">&quot;狗&quot;</span>,<span class="string">&quot;猪&quot;</span>],solarTerm=[<span class="string">&quot;小寒&quot;</span>,<span class="string">&quot;大寒&quot;</span>,<span class="string">&quot;立春&quot;</span>,<span class="string">&quot;雨水&quot;</span>,<span class="string">&quot;惊蛰&quot;</span>,<span class="string">&quot;春分&quot;</span>,<span class="string">&quot;清明&quot;</span>,<span class="string">&quot;谷雨&quot;</span>,<span class="string">&quot;立夏&quot;</span>,<span class="string">&quot;小满&quot;</span>,<span class="string">&quot;芒种&quot;</span>,<span class="string">&quot;夏至&quot;</span>,<span class="string">&quot;小暑&quot;</span>,<span class="string">&quot;大暑&quot;</span>,<span class="string">&quot;立秋&quot;</span>,<span class="string">&quot;处暑&quot;</span>,<span class="string">&quot;白露&quot;</span>,<span class="string">&quot;秋分&quot;</span>,<span class="string">&quot;寒露&quot;</span>,<span class="string">&quot;霜降&quot;</span>,<span class="string">&quot;立冬&quot;</span>,<span class="string">&quot;小雪&quot;</span>,<span class="string">&quot;大雪&quot;</span>,<span class="string">&quot;冬至&quot;</span>],sTermInfo=[<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c3598082c95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd0b06bdb0722c965ce1cfcc920f&quot;</span>,<span class="string">&quot;b027097bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c359801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd0b06bdb0722c965ce1cfcc920f&quot;</span>,<span class="string">&quot;b027097bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c359801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd0b06bdb0722c965ce1cfcc920f&quot;</span>,<span class="string">&quot;b027097bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;9778397bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97b6b97bd19801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd09801d98082c95f8e1cfcc920f&quot;</span>,<span class="string">&quot;97bd097bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd197c36c9210c9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec95f8c965cc920e&quot;</span>,<span class="string">&quot;97bd09801d98082c95f8e1cfcc920f&quot;</span>,<span class="string">&quot;97bd097bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36c9210c9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec95f8c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c3598082c95f8e1cfcc920f&quot;</span>,<span class="string">&quot;97bd097bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36c9210c9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c3598082c95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd097bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c3598082c95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd097bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c359801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd097bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c359801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd097bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf97c359801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd097bd07f595b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd19801ec9210c9274c920e&quot;</span>,<span class="string">&quot;97b6b97bd19801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd07f5307f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36c9210c9274c920e&quot;</span>,<span class="string">&quot;97b6b97bd19801ec95f8c965cc920f&quot;</span>,<span class="string">&quot;97bd07f5307f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36c9210c9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bd07f1487f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf7f1487f595b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf7f1487f595b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf7f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c965cc920e&quot;</span>,<span class="string">&quot;97bcf7f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b97bd19801ec9210c9274c920e&quot;</span>,<span class="string">&quot;97bcf7f0e47f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9210c91aa&quot;</span>,<span class="string">&quot;97b6b97bd197c36c9210c9274c920e&quot;</span>,<span class="string">&quot;97bcf7f0e47f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36c9210c9274c920e&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f5307f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36b0b70c9274c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e37f1487f595b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f595b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9274c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f531b0723b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f0e47f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9210c91aa&quot;</span>,<span class="string">&quot;97b6b7f0e47f149b0723b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;9778397bd097c36b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;977837f0e37f149b0723b0787b0721&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f5307f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0787b0721&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e37f1487f595b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc9210c8dc2&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd097c35b0b6fc920fb0722&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f149b0723b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f0e47f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;977837f0e37f14998082b0723b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e37f149b0723b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e397bd07f595b0b0bc920fb0722&quot;</span>,<span class="string">&quot;977837f0e37f14898082b0723b02d5&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b0721&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f1487f595b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e37f14898082b0723b02d5&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b0721&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e37f14898082b0723b02d5&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e37f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e37f14898082b072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e37f14898082b072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e366aa89801eb072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f149b0723b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e366aa89801eb072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0723b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f149b0723b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e366aa89801eb072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0723b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e37f14998083b0787b0721&quot;</span>,<span class="string">&quot;7f0e27f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e37f0e366aa89801eb072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14898082b0723b02d5&quot;</span>,<span class="string">&quot;7f07e7f0e37f14998082b0787b0721&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e36665b66aa89801e9808297c35&quot;</span>,<span class="string">&quot;665f67f0e37f14898082b0723b02d5&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b0721&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0722&quot;</span>,<span class="string">&quot;7f0e36665b66a449801e9808297c35&quot;</span>,<span class="string">&quot;665f67f0e37f14898082b0723b02d5&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e36665b66a449801e9808297c35&quot;</span>,<span class="string">&quot;665f67f0e37f14898082b072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e26665b66a449801e9808297c35&quot;</span>,<span class="string">&quot;665f67f0e37f1489801eb072297c35&quot;</span>,<span class="string">&quot;7ec967f0e37f14998082b0787b06bd&quot;</span>,<span class="string">&quot;7f07e7f0e47f531b0723b0b6fb0721&quot;</span>,<span class="string">&quot;7f0e27f1487f531b0b0bb0b6fb0722&quot;</span>],nStr1=[<span class="string">&quot;日&quot;</span>,<span class="string">&quot;一&quot;</span>,<span class="string">&quot;二&quot;</span>,<span class="string">&quot;三&quot;</span>,<span class="string">&quot;四&quot;</span>,<span class="string">&quot;五&quot;</span>,<span class="string">&quot;六&quot;</span>,<span class="string">&quot;七&quot;</span>,<span class="string">&quot;八&quot;</span>,<span class="string">&quot;九&quot;</span>,<span class="string">&quot;十&quot;</span>],nStr2=[<span class="string">&quot;初&quot;</span>,<span class="string">&quot;十&quot;</span>,<span class="string">&quot;廿&quot;</span>,<span class="string">&quot;卅&quot;</span>],nStr3=[<span class="string">&quot;正&quot;</span>,<span class="string">&quot;二&quot;</span>,<span class="string">&quot;三&quot;</span>,<span class="string">&quot;四&quot;</span>,<span class="string">&quot;五&quot;</span>,<span class="string">&quot;六&quot;</span>,<span class="string">&quot;七&quot;</span>,<span class="string">&quot;八&quot;</span>,<span class="string">&quot;九&quot;</span>,<span class="string">&quot;十&quot;</span>,<span class="string">&quot;冬&quot;</span>,<span class="string">&quot;腊&quot;</span>];<span class="keyword">function</span> <span class="title function_">lYearDays</span>(<span class="params">b</span>)&#123;<span class="keyword">var</span> f,c=<span class="number">348</span>;<span class="keyword">for</span>(f=<span class="number">32768</span>;f&gt;<span class="number">8</span>;f&gt;&gt;=<span class="number">1</span>)c+=lunarInfo[b-<span class="number">1900</span>]&amp;f?<span class="number">1</span>:<span class="number">0</span>;<span class="keyword">return</span> c+<span class="title function_">leapDays</span>(b)&#125;<span class="keyword">function</span> <span class="title function_">leapMonth</span>(<span class="params">b</span>)&#123;<span class="keyword">return</span> <span class="number">15</span>&amp;lunarInfo[b-<span class="number">1900</span>]&#125;<span class="keyword">function</span> <span class="title function_">leapDays</span>(<span class="params">b</span>)&#123;<span class="keyword">return</span> <span class="title function_">leapMonth</span>(b)?<span class="number">65536</span>&amp;lunarInfo[b-<span class="number">1900</span>]?<span class="number">30</span>:<span class="number">29</span>:<span class="number">0</span>&#125;<span class="keyword">function</span> <span class="title function_">monthDays</span>(<span class="params">b,f</span>)&#123;<span class="keyword">return</span> f&gt;<span class="number">12</span>||f&lt;<span class="number">1</span>?-<span class="number">1</span>:lunarInfo[b-<span class="number">1900</span>]&amp;<span class="number">65536</span>&gt;&gt;f?<span class="number">30</span>:<span class="number">29</span>&#125;<span class="keyword">function</span> <span class="title function_">solarDays</span>(<span class="params">b,f</span>)&#123;<span class="keyword">if</span>(f&gt;<span class="number">12</span>||f&lt;<span class="number">1</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">var</span> c=f-<span class="number">1</span>;<span class="keyword">return</span> <span class="number">1</span>===c?b%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;b%<span class="number">100</span>!=<span class="number">0</span>||b%<span class="number">400</span>==<span class="number">0</span>?<span class="number">29</span>:<span class="number">28</span>:solarMonth[c]&#125;<span class="keyword">function</span> <span class="title function_">toGanZhiYear</span>(<span class="params">b</span>)&#123;<span class="keyword">var</span> f=(b-<span class="number">3</span>)%<span class="number">10</span>,c=(b-<span class="number">3</span>)%<span class="number">12</span>;<span class="keyword">return</span> <span class="number">0</span>===f&amp;&amp;(f=<span class="number">10</span>),<span class="number">0</span>===c&amp;&amp;(c=<span class="number">12</span>),<span class="title class_">Gan</span>[f-<span class="number">1</span>]+<span class="title class_">Zhi</span>[c-<span class="number">1</span>]&#125;<span class="keyword">function</span> <span class="title function_">toAstro</span>(<span class="params">b,f</span>)&#123;<span class="keyword">return</span><span class="string">&quot;魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯&quot;</span>.<span class="title function_">substr</span>(<span class="number">2</span>*b-(f&lt;[<span class="number">20</span>,<span class="number">19</span>,<span class="number">21</span>,<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">23</span>,<span class="number">23</span>,<span class="number">23</span>,<span class="number">22</span>,<span class="number">22</span>][b-<span class="number">1</span>]?<span class="number">2</span>:<span class="number">0</span>),<span class="number">2</span>)+<span class="string">&quot;座&quot;</span>&#125;<span class="keyword">function</span> <span class="title function_">toGanZhi</span>(<span class="params">b</span>)&#123;<span class="keyword">return</span> <span class="title class_">Gan</span>[b%<span class="number">10</span>]+<span class="title class_">Zhi</span>[b%<span class="number">12</span>]&#125;<span class="keyword">function</span> <span class="title function_">getTerm</span>(<span class="params">b,f</span>)&#123;<span class="keyword">if</span>(b&lt;<span class="number">1900</span>||b&gt;<span class="number">2100</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">if</span>(f&lt;<span class="number">1</span>||f&gt;<span class="number">24</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">var</span> c=sTermInfo[b-<span class="number">1900</span>],e=[<span class="built_in">parseInt</span>(<span class="string">&quot;0x&quot;</span>+c.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">5</span>)).<span class="title function_">toString</span>(),<span class="built_in">parseInt</span>(<span class="string">&quot;0x&quot;</span>+c.<span class="title function_">substr</span>(<span class="number">5</span>,<span class="number">5</span>)).<span class="title function_">toString</span>(),<span class="built_in">parseInt</span>(<span class="string">&quot;0x&quot;</span>+c.<span class="title function_">substr</span>(<span class="number">10</span>,<span class="number">5</span>)).<span class="title function_">toString</span>(),<span class="built_in">parseInt</span>(<span class="string">&quot;0x&quot;</span>+c.<span class="title function_">substr</span>(<span class="number">15</span>,<span class="number">5</span>)).<span class="title function_">toString</span>(),<span class="built_in">parseInt</span>(<span class="string">&quot;0x&quot;</span>+c.<span class="title function_">substr</span>(<span class="number">20</span>,<span class="number">5</span>)).<span class="title function_">toString</span>(),<span class="built_in">parseInt</span>(<span class="string">&quot;0x&quot;</span>+c.<span class="title function_">substr</span>(<span class="number">25</span>,<span class="number">5</span>)).<span class="title function_">toString</span>()],a=[e[<span class="number">0</span>].<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),e[<span class="number">0</span>].<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">2</span>),e[<span class="number">0</span>].<span class="title function_">substr</span>(<span class="number">3</span>,<span class="number">1</span>),e[<span class="number">0</span>].<span class="title function_">substr</span>(<span class="number">4</span>,<span class="number">2</span>),e[<span class="number">1</span>].<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),e[<span class="number">1</span>].<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">2</span>),e[<span class="number">1</span>].<span class="title function_">substr</span>(<span class="number">3</span>,<span class="number">1</span>),e[<span class="number">1</span>].<span class="title function_">substr</span>(<span class="number">4</span>,<span class="number">2</span>),e[<span class="number">2</span>].<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),e[<span class="number">2</span>].<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">2</span>),e[<span class="number">2</span>].<span class="title function_">substr</span>(<span class="number">3</span>,<span class="number">1</span>),e[<span class="number">2</span>].<span class="title function_">substr</span>(<span class="number">4</span>,<span class="number">2</span>),e[<span class="number">3</span>].<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),e[<span class="number">3</span>].<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">2</span>),e[<span class="number">3</span>].<span class="title function_">substr</span>(<span class="number">3</span>,<span class="number">1</span>),e[<span class="number">3</span>].<span class="title function_">substr</span>(<span class="number">4</span>,<span class="number">2</span>),e[<span class="number">4</span>].<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),e[<span class="number">4</span>].<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">2</span>),e[<span class="number">4</span>].<span class="title function_">substr</span>(<span class="number">3</span>,<span class="number">1</span>),e[<span class="number">4</span>].<span class="title function_">substr</span>(<span class="number">4</span>,<span class="number">2</span>),e[<span class="number">5</span>].<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),e[<span class="number">5</span>].<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">2</span>),e[<span class="number">5</span>].<span class="title function_">substr</span>(<span class="number">3</span>,<span class="number">1</span>),e[<span class="number">5</span>].<span class="title function_">substr</span>(<span class="number">4</span>,<span class="number">2</span>)];<span class="keyword">return</span> <span class="built_in">parseInt</span>(a[f-<span class="number">1</span>])&#125;<span class="keyword">function</span> <span class="title function_">toChinaMonth</span>(<span class="params">b</span>)&#123;<span class="keyword">if</span>(b&gt;<span class="number">12</span>||b&lt;<span class="number">1</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">var</span> f=nStr3[b-<span class="number">1</span>];<span class="keyword">return</span> f+=<span class="string">&quot;月&quot;</span>&#125;<span class="keyword">function</span> <span class="title function_">toChinaDay</span>(<span class="params">b</span>)&#123;<span class="keyword">var</span> f;<span class="keyword">switch</span>(b)&#123;<span class="keyword">case</span> <span class="number">10</span>:f=<span class="string">&quot;初十&quot;</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">20</span>:f=<span class="string">&quot;二十&quot;</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">30</span>:f=<span class="string">&quot;三十&quot;</span>;<span class="keyword">break</span>;<span class="attr">default</span>:f=nStr2[<span class="title class_">Math</span>.<span class="title function_">floor</span>(b/<span class="number">10</span>)],f+=nStr1[b%<span class="number">10</span>]&#125;<span class="keyword">return</span> f&#125;<span class="keyword">function</span> <span class="title function_">getAnimal</span>(<span class="params">b</span>)&#123;<span class="keyword">return</span> <span class="title class_">Animals</span>[(b-<span class="number">4</span>)%<span class="number">12</span>]&#125;<span class="keyword">function</span> <span class="title function_">solar2lunar</span>(<span class="params">b,f,c</span>)&#123;<span class="keyword">if</span>(b&lt;<span class="number">1900</span>||b&gt;<span class="number">2100</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">if</span>(<span class="number">1900</span>===b&amp;&amp;<span class="number">1</span>===f&amp;&amp;c&lt;<span class="number">31</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">var</span> e,a,r=<span class="literal">null</span>,t=<span class="number">0</span>;b=(r=b?<span class="keyword">new</span> <span class="title class_">Date</span>(b,<span class="built_in">parseInt</span>(f)-<span class="number">1</span>,c):<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getFullYear</span>(),f=r.<span class="title function_">getMonth</span>()+<span class="number">1</span>,c=r.<span class="title function_">getDate</span>();<span class="keyword">var</span> d=(<span class="title class_">Date</span>.<span class="title function_">UTC</span>(r.<span class="title function_">getFullYear</span>(),r.<span class="title function_">getMonth</span>(),r.<span class="title function_">getDate</span>())-<span class="title class_">Date</span>.<span class="title function_">UTC</span>(<span class="number">1900</span>,<span class="number">0</span>,<span class="number">31</span>))/<span class="number">864e5</span>;<span class="keyword">for</span>(e=<span class="number">1900</span>;e&lt;<span class="number">2101</span>&amp;&amp;d&gt;<span class="number">0</span>;e++)d-=t=<span class="title function_">lYearDays</span>(e);d&lt;<span class="number">0</span>&amp;&amp;(d+=t,e--);<span class="keyword">var</span> n=<span class="keyword">new</span> <span class="title class_">Date</span>,s=!<span class="number">1</span>;n.<span class="title function_">getFullYear</span>()===b&amp;&amp;n.<span class="title function_">getMonth</span>()+<span class="number">1</span>===f&amp;&amp;n.<span class="title function_">getDate</span>()===c&amp;&amp;(s=!<span class="number">0</span>);<span class="keyword">var</span> u=r.<span class="title function_">getDay</span>(),o=nStr1[u];<span class="number">0</span>===u&amp;&amp;(u=<span class="number">7</span>);<span class="keyword">var</span> l=e;a=<span class="title function_">leapMonth</span>(e);<span class="keyword">var</span> i=!<span class="number">1</span>;<span class="keyword">for</span>(e=<span class="number">1</span>;e&lt;<span class="number">13</span>&amp;&amp;d&gt;<span class="number">0</span>;e++)a&gt;<span class="number">0</span>&amp;&amp;e===a+<span class="number">1</span>&amp;&amp;!<span class="number">1</span>===i?(--e,i=!<span class="number">0</span>,t=<span class="title function_">leapDays</span>(l)):t=<span class="title function_">monthDays</span>(l,e),!<span class="number">0</span>===i&amp;&amp;e===a+<span class="number">1</span>&amp;&amp;(i=!<span class="number">1</span>),d-=t;<span class="number">0</span>===d&amp;&amp;a&gt;<span class="number">0</span>&amp;&amp;e===a+<span class="number">1</span>&amp;&amp;(i?i=!<span class="number">1</span>:(i=!<span class="number">0</span>,--e)),d&lt;<span class="number">0</span>&amp;&amp;(d+=t,--e);<span class="keyword">var</span> h=e,D=d+<span class="number">1</span>,g=f-<span class="number">1</span>,v=<span class="title function_">toGanZhiYear</span>(l),y=<span class="title function_">getTerm</span>(b,<span class="number">2</span>*f-<span class="number">1</span>),m=<span class="title function_">getTerm</span>(b,<span class="number">2</span>*f),p=<span class="title function_">toGanZhi</span>(<span class="number">12</span>*(b-<span class="number">1900</span>)+f+<span class="number">11</span>);c&gt;=y&amp;&amp;(p=<span class="title function_">toGanZhi</span>(<span class="number">12</span>*(b-<span class="number">1900</span>)+f+<span class="number">12</span>));<span class="keyword">var</span> M=!<span class="number">1</span>,T=<span class="literal">null</span>;y===c&amp;&amp;(M=!<span class="number">0</span>,T=solarTerm[<span class="number">2</span>*f-<span class="number">2</span>]),m===c&amp;&amp;(M=!<span class="number">0</span>,T=solarTerm[<span class="number">2</span>*f-<span class="number">1</span>]);<span class="keyword">var</span> I=<span class="title function_">toGanZhi</span>(<span class="title class_">Date</span>.<span class="title function_">UTC</span>(b,g,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)/<span class="number">864e5</span>+<span class="number">25567</span>+<span class="number">10</span>+c-<span class="number">1</span>),C=<span class="title function_">toAstro</span>(f,c);<span class="keyword">return</span>&#123;<span class="attr">lYear</span>:l,<span class="attr">lMonth</span>:h,<span class="attr">lDay</span>:D,<span class="title class_">Animal</span>:<span class="title function_">getAnimal</span>(l),<span class="title class_">IMonthCn</span>:(i?<span class="string">&quot;闰&quot;</span>:<span class="string">&quot;&quot;</span>)+<span class="title function_">toChinaMonth</span>(h),<span class="title class_">IDayCn</span>:<span class="title function_">toChinaDay</span>(D),<span class="attr">cYear</span>:b,<span class="attr">cMonth</span>:f,<span class="attr">cDay</span>:c,<span class="attr">gzYear</span>:v,<span class="attr">gzMonth</span>:p,<span class="attr">gzDay</span>:I,<span class="attr">isToday</span>:s,<span class="attr">isLeap</span>:i,<span class="attr">nWeek</span>:u,<span class="attr">ncWeek</span>:<span class="string">&quot;星期&quot;</span>+o,<span class="attr">isTerm</span>:M,<span class="title class_">Term</span>:T,<span class="attr">astro</span>:C&#125;&#125;<span class="keyword">var</span> calendarFormatter=&#123;<span class="attr">solar2lunar</span>:<span class="keyword">function</span>(<span class="params">b,f,c</span>)&#123;<span class="keyword">return</span> <span class="title function_">solar2lunar</span>(b,f,c)&#125;,<span class="attr">lunar2solar</span>:<span class="keyword">function</span>(<span class="params">b,f,c,e</span>)&#123;<span class="keyword">if</span>((e=!!e)&amp;&amp;leapMonth!==f)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">if</span>(<span class="number">2100</span>===b&amp;&amp;<span class="number">12</span>===f&amp;&amp;c&gt;<span class="number">1</span>||<span class="number">1900</span>===b&amp;&amp;<span class="number">1</span>===f&amp;&amp;c&lt;<span class="number">31</span>)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">var</span> a=<span class="title function_">monthDays</span>(b,f),r=a;<span class="keyword">if</span>(e&amp;&amp;(r=<span class="title function_">leapDays</span>(b,f)),b&lt;<span class="number">1900</span>||b&gt;<span class="number">2100</span>||c&gt;r)<span class="keyword">return</span>-<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>,d=<span class="number">1900</span>;d&lt;b;d++)t+=<span class="title function_">lYearDays</span>(d);<span class="keyword">var</span> n=<span class="number">0</span>,s=!<span class="number">1</span>;<span class="keyword">for</span>(d=<span class="number">1</span>;d&lt;f;d++)n=<span class="title function_">leapMonth</span>(b),s||n&lt;=d&amp;&amp;n&gt;<span class="number">0</span>&amp;&amp;(t+=<span class="title function_">leapDays</span>(b),s=!<span class="number">0</span>),t+=<span class="title function_">monthDays</span>(b,d);e&amp;&amp;(t+=a);<span class="keyword">var</span> u=<span class="title class_">Date</span>.<span class="title function_">UTC</span>(<span class="number">1900</span>,<span class="number">1</span>,<span class="number">30</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>),o=<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">864e5</span>*(t+c-<span class="number">31</span>)+u);<span class="keyword">return</span> <span class="title function_">solar2lunar</span>(o.<span class="title function_">getUTCFullYear</span>(),o.<span class="title function_">getUTCMonth</span>()+<span class="number">1</span>,o.<span class="title function_">getUTCDate</span>())&#125;&#125;;</span><br></pre></td></tr></table></figure></li><li><p>引入以下以上两个js文件和一个弹窗依赖（注意顺序不能颠倒）：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span> </span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">type=&quot;text/javascript&quot;</span> <span class="string">src=&quot;https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># 节日弹窗依赖</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;/js/lunar.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># 农历计算</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;/js/day.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># 节日弹窗</span></span><br></pre></td></tr></table></figure></li><li><p>重启项目，如果是日子对了自动会有弹窗的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol><h3 id="全局卡片"><a href="#全局卡片" class="headerlink" title="全局卡片"></a>全局卡片</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/%E9%A1%B5%E9%9D%A2%E4%BA%9A%E5%85%8B%E5%8A%9B%E6%95%88%E6%9E%9C" alt="image-20260110180843760"></p><blockquote><p>通过css样式调节各个页面<code>透明度、模糊度（亚克力效果）、圆角、边框样式</code>等，看起来会更加舒适。</p></blockquote><ol><li><p>复制以下代码进去自定义的<code>custom.css</code>文件</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">   <span class="comment">/* ⚠️ 第四个参数0.8 就是调整全局卡片透明度的参数 */</span></span><br><span class="line">  <span class="attr">--trans-light</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>);</span><br><span class="line">  <span class="attr">--trans-dark</span>: <span class="built_in">rgba</span>(<span class="number">25</span>, <span class="number">25</span>, <span class="number">25</span>, <span class="number">0.8</span>);</span><br><span class="line">  <span class="attr">--border-style</span>: <span class="number">1px</span> solid <span class="built_in">rgb</span>(<span class="number">169</span>, <span class="number">169</span>, <span class="number">169</span>);</span><br><span class="line">  <span class="attr">--backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">5px</span>) <span class="built_in">saturate</span>(<span class="number">150%</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 首页文章卡片 */</span></span><br><span class="line"><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--border-style);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 首页侧栏卡片 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--border-style);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 文章页、归档页、普通页面 */</span></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#post</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#page</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#archive</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--border-style);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 导航栏 */</span></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.nav-fixed</span> <span class="selector-id">#nav</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.75</span>);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#page-header</span><span class="selector-class">.nav-fixed</span> <span class="selector-id">#nav</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式遮罩 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#post</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#archive</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#page</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--trans-dark);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式页脚页头遮罩透明 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#footer</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 阅读模式 */</span></span><br><span class="line"><span class="selector-class">.read-mode</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">158</span>, <span class="number">204</span>, <span class="number">171</span>, <span class="number">0.5</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.read-mode</span> <span class="selector-tag">div</span><span class="selector-id">#post</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">158</span>, <span class="number">204</span>, <span class="number">171</span>, <span class="number">0.5</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式下的阅读模式 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.read-mode</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">25</span>, <span class="number">25</span>, <span class="number">25</span>, <span class="number">0.9</span>) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.read-mode</span> <span class="selector-tag">div</span><span class="selector-id">#post</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">25</span>, <span class="number">25</span>, <span class="number">25</span>, <span class="number">0.9</span>) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>参数说明：</p><ul><li><p><code>--trans-light</code>：白天模式带透明度的背景色，如<code>rgba(255, 255, 255, 0.88)</code>底色是纯白色，其中0.88就透明度，在0-1之间调节，值越大越不透明；</p></li><li><p><code>--trans-dark</code>: 夜间模式带透明度的背景色，如<code>rgba(25, 25, 25, 0.88)</code>底色是柔和黑色，其中0.88就透明度，在0-1之间调节，值越大越不透明;</p></li><li><p><code>--border-style</code>: 边框样式，<code>1px solid rgb(169, 169, 169)</code>指宽度为1px的灰色实体边框;</p></li><li><p><code>--backdrop-filter</code>: 背景过滤器，如<code>blur(5px) saturate(150%)</code>表示饱和度为150%的、高斯模糊半径为5px的过滤器，这是亚克力效果的一种实现方法;</p></li></ul></li><li><p>记住在主题配置文件<code>_config.butterfly.yml</code>的<code>inject</code>配置项中引入该css文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inject: </span><br><span class="line">  head: </span><br><span class="line">- &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/custom.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure></li><li><p>重启项目即可看见效果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol><h3 id="文章三栏自适应-新版本失效"><a href="#文章三栏自适应-新版本失效" class="headerlink" title="文章三栏自适应(新版本失效)"></a><del>文章三栏自适应(新版本失效)</del></h3><blockquote><p>Ref. <a href="https://akilar.top/posts/d6b69c49/">https://akilar.top/posts/d6b69c49/</a></p><p>本网站采用的是三栏+响应式布局的方案，也就是<code>slidecard</code>的方案，但是为了可拓展性，我还是把两种都搬了过来，方便大家阅读！</p></blockquote><p>效果预览</p><ol><li><p>修改<code>[BlogRoot]\themes\butterfly\layout\includes\mixins\post-ui.pug</code>,整个替换为下面的代码，注意，我这里用的是彩色的图标，每个<code>//- i.fas</code>那里表示我注释了黑白的额图标并换上彩色图标，彩色图标引入的具体方法见之前的教程，这里只需要替换成你自己的<code>图标名字</code>和调节相应的<code>大小</code>即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">mixin postUI(posts)</span><br><span class="line">  each article , index in page.posts.data</span><br><span class="line">    .recent-post-item</span><br><span class="line">      -</span><br><span class="line">        let link = article.link || article.path</span><br><span class="line">        let title = article.title || _p(&#x27;no_title&#x27;)</span><br><span class="line">        const position = theme.cover.position</span><br><span class="line">        let leftOrRight = position === &#x27;both&#x27;</span><br><span class="line">          ? index%2 == 0 ? &#x27;left&#x27; : &#x27;right&#x27;</span><br><span class="line">          : position === &#x27;left&#x27; ? &#x27;left&#x27; : &#x27;right&#x27;</span><br><span class="line">        let post_cover = article.cover</span><br><span class="line">        let no_cover = article.cover === false || !theme.cover.index_enable ? &#x27;no-cover&#x27; : &#x27;&#x27;</span><br><span class="line">      -</span><br><span class="line">      .recent-post-content(class=leftOrRight)</span><br><span class="line">        .recent-post-cover</span><br><span class="line">          img.article-cover(src=url_for(post_cover) onerror=`this.onerror=null;this.src=&#x27;`+ url_for(theme.error_img.post_page) + `&#x27;` alt=title)</span><br><span class="line">        .recent-post-info</span><br><span class="line">          a.article-title(href=url_for(link) title=title)</span><br><span class="line">            .article-title-link= title</span><br><span class="line">          .recent-post-meta                </span><br><span class="line">            .article-meta-wrap</span><br><span class="line">              if (is_home() &amp;&amp; (article.top || article.sticky &gt; 0))</span><br><span class="line">                span.article-meta</span><br><span class="line">                  //- i.fas.fa-thumbtack.sticky</span><br><span class="line">                  svg.meta_icon(style=&quot;width:16px;height:16px;position:relative;top:3px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-tuding&#x27;)</span><br><span class="line">                  span.sticky= _p(&#x27;sticky&#x27;)</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">              if (theme.post_meta.page.date_type)</span><br><span class="line">                span.post-meta-date</span><br><span class="line">                  if (theme.post_meta.page.date_type === &#x27;both&#x27;)</span><br><span class="line">                    //- i.far.fa-calendar-alt</span><br><span class="line">                    svg.meta_icon(style=&quot;width:21px;height:21px;position:relative;top:6px&quot;).post-ui-icon</span><br><span class="line">                      use(xlink:href=&#x27;#icon-rili&#x27;)</span><br><span class="line">                    span.article-meta-label=_p(&#x27;post.created&#x27;)</span><br><span class="line">                    time.post-meta-date-created(datetime=date_xml(article.date) title=_p(&#x27;post.created&#x27;) + &#x27; &#x27; + full_date(article.date))=date(article.date, config.date_format)</span><br><span class="line">                    span.article-meta-separator  | </span><br><span class="line">                    //- i.fas.fa-history</span><br><span class="line">                    svg.meta_icon(style=&quot;width:13px;height:13px;position:relative;top:2px&quot;).post-ui-icon</span><br><span class="line">                      use(xlink:href=&#x27;#icon-gengxin1&#x27;)                    </span><br><span class="line">                    span.article-meta-label=_p(&#x27;post.updated&#x27;) + &quot; &quot;</span><br><span class="line">                    time.post-meta-date-updated(datetime=date_xml(article.updated) title=_p(&#x27;post.updated&#x27;) + &#x27; &#x27; + full_date(article.updated))=date(article.updated, config.date_format)</span><br><span class="line">                  else</span><br><span class="line">                    - let data_type_updated = theme.post_meta.page.date_type === &#x27;updated&#x27;</span><br><span class="line">                    - let date_type = data_type_updated ? &#x27;updated&#x27; : &#x27;date&#x27;</span><br><span class="line">                    - let date_icon = data_type_updated ? &#x27;fas fa-history&#x27; :&#x27;far fa-calendar-alt&#x27;</span><br><span class="line">                    - let date_title = data_type_updated ? _p(&#x27;post.updated&#x27;) : _p(&#x27;post.created&#x27;)</span><br><span class="line">                    i(class=date_icon)</span><br><span class="line">                    span.article-meta-label=date_title</span><br><span class="line">                    time(datetime=date_xml(article[date_type]) title=date_title + &#x27; &#x27; + full_date(article[date_type]))=date(article[date_type], config.date_format)</span><br><span class="line">              if (theme.post_meta.page.categories &amp;&amp; article.categories.data.length &gt; 0)</span><br><span class="line">                span.article-meta</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">                  //- i.fas.fa-inbox</span><br><span class="line">                  svg.meta_icon(style=&quot;width:12px;height:12px;position:relative;top:1px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-fenlei&#x27;)</span><br><span class="line">                  each item, index in article.categories.data</span><br><span class="line">                    a(href=url_for(item.path)).article-meta__categories #[=item.name]</span><br><span class="line">                    if (index &lt; article.categories.data.length - 1)</span><br><span class="line">                      i.fas.fa-angle-right.article-meta-link</span><br><span class="line">              if (theme.post_meta.page.tags &amp;&amp; article.tags.data.length &gt; 0)</span><br><span class="line">                span.article-meta.tags</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">                  //- i.fas.fa-tag</span><br><span class="line">                  svg.meta_icon(style=&quot;width:13px;height:13px;position:relative;top:2px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-biaoqian&#x27;)</span><br><span class="line">                  each item, index in article.tags.data</span><br><span class="line">                    a(href=url_for(item.path)).article-meta__tags #[=item.name]</span><br><span class="line">                    if (index &lt; article.tags.data.length - 1)</span><br><span class="line">                      span.article-meta-link #[=&#x27; • &#x27;]</span><br><span class="line">              </span><br><span class="line">              mixin countBlockInIndex</span><br><span class="line">                - needLoadCountJs = true</span><br><span class="line">                span.article-meta</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">                  //- i.fas.fa-comments</span><br><span class="line">                  svg.meta_icon(style=&quot;width:13px;height:13px;position:relative;top:2px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-pinglun1&#x27;)</span><br><span class="line">                  if block</span><br><span class="line">                    block</span><br><span class="line">                  span.article-meta-label= &#x27; &#x27; + _p(&#x27;card_post_count&#x27;)</span><br><span class="line">              </span><br><span class="line">              if theme.comments.card_post_count</span><br><span class="line">                case theme.comments.use[0]</span><br><span class="line">                  when &#x27;Disqus&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=full_url_for(link) + &#x27;#disqus_thread&#x27;)</span><br><span class="line">                        i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Disqusjs&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=full_url_for(link) + &#x27;#disqusjs&#x27;)</span><br><span class="line">                        span.disqus-comment-count(data-disqus-url=full_url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Valine&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.valine-comment-count(data-xid=url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Waline&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.waline-comment-count(id=url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Twikoo&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a.twikoo-count(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Facebook Comments&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.fb-comments-count(data-href=urlNoIndex(article.permalink))</span><br><span class="line">                  when &#x27;Remark42&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.remark42__counter(data-url=urlNoIndex(article.permalink))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Artalk&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.artalk-count(data-page-key=url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin      </span><br><span class="line">        a.article-content(href=url_for(link) title=title)</span><br><span class="line">          //- Display the article introduction on homepage</span><br><span class="line">          case theme.index_post_content.method</span><br><span class="line">            when false</span><br><span class="line">              - break</span><br><span class="line">            when 1</span><br><span class="line">              .article-content-text!= article.description</span><br><span class="line">            when 2</span><br><span class="line">              if article.description</span><br><span class="line">                .article-content-text!= article.description</span><br><span class="line">              else</span><br><span class="line">                - const content = strip_html(article.content)</span><br><span class="line">                - let expert = content.substring(0, theme.index_post_content.length) </span><br><span class="line">                - content.length &gt; theme.index_post_content.length ? expert += &#x27; ...&#x27; : &#x27;&#x27;</span><br><span class="line">                .article-content-text!= expert</span><br><span class="line">            default</span><br><span class="line">              - const content = strip_html(article.content)</span><br><span class="line">              - let expert = content.substring(0, theme.index_post_content.length) </span><br><span class="line">              - content.length &gt; theme.index_post_content.length ? expert += &#x27; ...&#x27; : &#x27;&#x27;</span><br><span class="line">              .article-content-text!= expert      </span><br><span class="line">        .recent-post-arrow</span><br><span class="line"></span><br><span class="line">    if theme.ad &amp;&amp; theme.ad.index</span><br><span class="line">      if (index + 1) % 3 == 0</span><br><span class="line">        .recent-post-item.ads-wrap!=theme.ad.index</span><br></pre></td></tr></table></figure></li><li><p>样式方案提供两种：</p><ul><li>样式一：电脑端宽屏采用滑动卡片，平板宽度采用双栏布局，手机宽度采用单栏卡片</li><li>样式二：移除滑动卡片，按屏幕宽度依次应用三栏、双栏、单栏</li></ul><p>新建目录<code>[BlogRoot]\themes\butterfly\source\css\_index_card_style\</code>,并在下面新建对应的文件<code>slidecard.styl</code>和<code>multicard.styl</code>并分别填入以下内容：</p><ul><li>样式一:slidecard</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//default color:</span></span><br><span class="line"><span class="selector-pseudo">:root</span></span><br><span class="line">  <span class="attr">--recent-post-bgcolor</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span>)  <span class="comment">//默认背景</span></span><br><span class="line">  <span class="attr">--article-content-bgcolor</span>: <span class="number">#49b1f5</span> <span class="comment">//描述版块背景</span></span><br><span class="line">  <span class="attr">--recent-post-arrow</span>: <span class="number">#ffffff</span> <span class="comment">//箭头配色</span></span><br><span class="line">  <span class="attr">--recent-post-cover-shadow</span>: <span class="number">#ffffff</span> <span class="comment">//封面遮罩层配色，建议和默认值的颜色相对应。</span></span><br><span class="line">  <span class="attr">--recent-post-transition</span>: <span class="attribute">all</span> <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)  //动画效果。不了解的不要改动</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="attr">--recent-post-bgcolor</span>: <span class="built_in">rgba</span>(<span class="number">35</span>,<span class="number">35</span>,<span class="number">35</span>,<span class="number">0.5</span>)</span><br><span class="line">  <span class="attr">--article-content-bgcolor</span>: <span class="number">#99999a</span></span><br><span class="line">  <span class="attr">--recent-post-arrow</span>: <span class="number">#37e2dd</span></span><br><span class="line">  <span class="attr">--recent-post-cover-shadow</span>: <span class="number">#232323</span></span><br><span class="line"><span class="comment">// 默认的首页卡片容器布局</span></span><br><span class="line"><span class="selector-class">.recent-posts</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">0</span> <span class="number">15px</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">  <span class="attribute">height</span> fit-content</span><br><span class="line">  <span class="selector-class">.recent-post-item</span></span><br><span class="line">    <span class="attribute">margin-bottom</span> <span class="number">15px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">var</span>(--recent-post-bgcolor)</span><br><span class="line">    <span class="attribute">overflow</span> hidden</span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">15px</span></span><br><span class="line">    <span class="selector-class">.recent-post-content</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">background</span> <span class="built_in">var</span>(--recent-post-bgcolor)</span><br><span class="line">      <span class="attribute">position</span> relative</span><br><span class="line">      <span class="selector-class">.recent-post-cover</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">background</span> transparent</span><br><span class="line">      <span class="selector-class">.recent-post-info</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">background</span> transparent</span><br><span class="line">        <span class="attribute">flex-direction</span> column</span><br><span class="line">        <span class="attribute">justify-content</span> center</span><br><span class="line">        <span class="attribute">align-items</span> center</span><br><span class="line">        <span class="selector-class">.article-title</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">50%</span></span><br><span class="line">          <span class="attribute">display</span>: flex</span><br><span class="line">          <span class="attribute">text-align</span>: center</span><br><span class="line">          <span class="attribute">align-items</span>: center</span><br><span class="line">          <span class="attribute">justify-content</span>: flex-end</span><br><span class="line">          <span class="attribute">flex-direction</span>: column</span><br><span class="line">          <span class="selector-class">.article-title-link</span></span><br><span class="line">            <span class="attribute">color</span>: <span class="built_in">var</span>(--text-highlight-color)</span><br><span class="line">            <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line">            <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">            -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br><span class="line">            <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="variable">$text</span>-hover</span><br><span class="line">        <span class="selector-class">.recent-post-meta</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">50%</span></span><br><span class="line">          <span class="attribute">display</span>: flex</span><br><span class="line">          <span class="attribute">text-align</span>: center</span><br><span class="line">          <span class="attribute">align-items</span>: center</span><br><span class="line">          <span class="attribute">justify-content</span>: flex-start</span><br><span class="line">          <span class="attribute">flex-direction</span>: column</span><br><span class="line">          <span class="selector-class">.article-meta-wrap</span></span><br><span class="line">            <span class="attribute">color</span> <span class="number">#969797</span></span><br><span class="line">            <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">            -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br><span class="line">            <span class="selector-tag">a</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="built_in">var</span>(--text-highlight-color)</span><br><span class="line">              <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line">              <span class="attribute">color</span> <span class="number">#969797</span></span><br><span class="line">              <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">                <span class="attribute">color</span>: <span class="variable">$text</span>-hover</span><br><span class="line">      <span class="selector-class">.article-content</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">text-align</span>: center</span><br><span class="line">        <span class="attribute">flex-direction</span> row</span><br><span class="line">        <span class="attribute">align-items</span> center</span><br><span class="line">        <span class="attribute">justify-content</span> center</span><br><span class="line">        <span class="selector-class">.article-content-text</span></span><br><span class="line">          <span class="attribute">display</span> -webkit-box</span><br><span class="line">          -webkit-<span class="attribute">box-orient</span> vertical</span><br><span class="line">          <span class="attribute">text-overflow</span>: ellipsis</span><br><span class="line">          <span class="attribute">overflow</span> hidden</span><br><span class="line">          <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line">          <span class="attribute">text-shadow</span> <span class="number">1px</span> <span class="number">2px</span> <span class="number">3px</span> <span class="number">#000</span></span><br><span class="line">          <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">            <span class="attribute">content</span> <span class="string">&quot;❝&quot;</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">20px</span></span><br><span class="line">          <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">            <span class="attribute">content</span> <span class="string">&quot;❞&quot;</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">20px</span></span><br><span class="line">    &amp;<span class="selector-class">.ads-wrap</span></span><br><span class="line">      <span class="attribute">display</span>: block <span class="meta">!important</span></span><br><span class="line">      <span class="attribute">height</span>: auto <span class="meta">!important</span></span><br><span class="line"><span class="comment">// PC端滑动卡片样式</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>:<span class="number">1069px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    padding <span class="number">0</span> <span class="number">15px</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">    .recent-post-item</span><br><span class="line">      .recent-post-content</span><br><span class="line">        position relative</span><br><span class="line">        <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        transition var(--recent-post-transition)</span><br><span class="line">        &amp;:<span class="attribute">hover</span></span><br><span class="line">          .recent-post-cover-shadow</span><br><span class="line">            <span class="attribute">width</span> <span class="number">10.1%</span></span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">          .recent-post-cover</span><br><span class="line">            <span class="attribute">width</span> <span class="number">10%</span></span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">          .article-content</span><br><span class="line">            <span class="attribute">width</span> calc(<span class="number">30%</span> + <span class="number">80px</span>)</span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">            .article-content-text</span><br><span class="line">              opacity <span class="number">1</span></span><br><span class="line">          .recent-post-arrow</span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">        .recent-post-cover-shadow</span><br><span class="line">          z-index: <span class="number">1</span></span><br><span class="line">          transition var(--recent-post-transition)</span><br><span class="line">          position: absolute</span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">40%</span></span><br><span class="line">        .recent-post-cover</span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">40%</span></span><br><span class="line">          transition var(--recent-post-transition)</span><br><span class="line">          img</span><br><span class="line">            <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">            <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">            object-fit cover</span><br><span class="line"></span><br><span class="line">        .recent-post-info</span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          <span class="attribute">width</span> calc(<span class="number">60%</span> - <span class="number">80px</span>)</span><br><span class="line">          .article-title</span><br><span class="line">            margin: <span class="number">0px</span> <span class="number">40px</span></span><br><span class="line">            font-size <span class="number">24px</span></span><br><span class="line">            .article-title-link</span><br><span class="line">              -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line">          <span class="selector-class">.recent-post-meta</span></span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">20px</span></span><br><span class="line">            <span class="selector-class">.article-meta-wrap</span></span><br><span class="line">              <span class="attribute">font-size</span> <span class="number">12px</span></span><br><span class="line">              -webkit-line-clamp: <span class="number">3</span>;</span><br><span class="line">        <span class="selector-class">.article-content</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">90px</span></span><br><span class="line">          <span class="attribute">background</span> <span class="built_in">var</span>(--article-content-bgcolor)</span><br><span class="line">          <span class="attribute">transition</span> <span class="built_in">var</span>(--recent-post-transition)</span><br><span class="line">          <span class="selector-class">.article-content-text</span></span><br><span class="line">            -webkit-line-clamp <span class="number">4</span></span><br><span class="line">            <span class="attribute">transition</span>: <span class="built_in">var</span>(--recent-post-transition)</span><br><span class="line">            <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">        <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">          <span class="attribute">transition</span> <span class="built_in">var</span>(--recent-post-transition)</span><br><span class="line">          <span class="attribute">display</span> block</span><br><span class="line">          <span class="attribute">position</span> absolute</span><br><span class="line">          <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">8px</span></span><br><span class="line">          <span class="attribute">background</span> <span class="built_in">var</span>(--recent-post-arrow)</span><br><span class="line">        &amp;<span class="selector-class">.both</span>,</span><br><span class="line">        &amp;<span class="selector-class">.right</span></span><br><span class="line">          <span class="selector-class">.recent-post-cover-shadow</span></span><br><span class="line">            <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">            <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(to left, <span class="built_in">var</span>(--recent-post-cover-shadow), transparent)</span><br><span class="line">          <span class="selector-class">.recent-post-cover</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">1</span></span><br><span class="line">          <span class="selector-class">.recent-post-info</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">2</span></span><br><span class="line">          <span class="selector-class">.article-content</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">3</span></span><br><span class="line">            <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">50%</span>, <span class="number">80px</span> <span class="number">0</span>, <span class="number">100%</span> <span class="number">0</span>, <span class="number">100%</span> <span class="number">100%</span>, <span class="number">80px</span> <span class="number">100%</span>)</span><br><span class="line">            <span class="selector-class">.article-content-text</span></span><br><span class="line">              <span class="attribute">margin</span> <span class="number">20px</span> <span class="number">40px</span> <span class="number">20px</span> <span class="number">80px</span></span><br><span class="line">          <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">4</span></span><br><span class="line">            <span class="attribute">left</span> <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">80px</span>)</span><br><span class="line">            <span class="attribute">top</span> <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">10px</span>)</span><br><span class="line">            <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">10px</span>, <span class="number">8px</span> <span class="number">0</span>, <span class="number">8px</span> <span class="number">20px</span>)</span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">              <span class="attribute">left</span> <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">40px</span>)</span><br><span class="line">        &amp;<span class="selector-class">.left</span></span><br><span class="line">          <span class="selector-class">.recent-post-cover-shadow</span></span><br><span class="line">            <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">            <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(to right, <span class="built_in">var</span>(--recent-post-cover-shadow), transparent)</span><br><span class="line">          <span class="selector-class">.recent-post-cover</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">4</span></span><br><span class="line">          <span class="selector-class">.recent-post-info</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">3</span></span><br><span class="line">          <span class="selector-class">.article-content</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">2</span></span><br><span class="line">            <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">100%</span> <span class="number">50%</span>,<span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">80px</span>) <span class="number">100%</span>,<span class="number">0</span> <span class="number">100%</span>,<span class="number">0</span> <span class="number">0</span>,<span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">80px</span>) <span class="number">0</span>)</span><br><span class="line">            <span class="selector-class">.article-content-text</span></span><br><span class="line">              <span class="attribute">margin</span> <span class="number">20px</span> <span class="number">80px</span> <span class="number">20px</span> <span class="number">40px</span></span><br><span class="line">          <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">            <span class="attribute">order</span>: <span class="number">1</span></span><br><span class="line">            <span class="attribute">left</span> <span class="number">72px</span></span><br><span class="line">            <span class="attribute">top</span> <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">10px</span>)</span><br><span class="line">            <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">0</span>, <span class="number">8px</span> <span class="number">10px</span>, <span class="number">0</span> <span class="number">20px</span>)</span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">              <span class="attribute">left</span> <span class="number">32px</span></span><br><span class="line"><span class="comment">// 双栏布局卡片自适应适配</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>:<span class="number">572px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">1068px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    padding <span class="number">0</span> <span class="number">15px</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">    display flex</span><br><span class="line">    flex-direction row</span><br><span class="line">    flex-wrap wrap</span><br><span class="line">    .recent-post-item</span><br><span class="line">      border-radius <span class="number">15px</span></span><br><span class="line">      overflow hidden</span><br><span class="line">      <span class="attribute">width</span> <span class="number">47%</span></span><br><span class="line">      margin <span class="number">0px</span> <span class="number">3%</span> <span class="number">20px</span> <span class="number">0px</span></span><br><span class="line">    nav#pagination</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">// 手机端单栏布局自适应适配</span><br><span class="line">@media screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">572px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    padding <span class="number">0</span> <span class="number">15px</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">    .recent-post-item</span><br><span class="line">      border-radius <span class="number">15px</span></span><br><span class="line">      overflow hidden</span><br><span class="line">        </span><br><span class="line">// 手机端及双栏卡片样式</span><br><span class="line">@media screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">1068px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      .recent-post-content</span><br><span class="line">        flex-direction column</span><br><span class="line">        flex-wrap nowrap</span><br><span class="line">        align-items center</span><br><span class="line">        <span class="attribute">max-height</span> <span class="number">350px</span></span><br><span class="line">        <span class="attribute">height</span>: auto </span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        .recent-post-cover</span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          clip-path polygon(<span class="number">0</span> <span class="number">130px</span>,<span class="number">0</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">130px</span>,<span class="number">50%</span> <span class="number">100%</span>)</span><br><span class="line">          img</span><br><span class="line">            <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">            <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">            object-fit cover</span><br><span class="line">        .recent-post-info</span><br><span class="line">          <span class="attribute">height</span> <span class="number">150px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          padding <span class="number">0px</span> <span class="number">25px</span> <span class="number">5px</span> <span class="number">25px</span></span><br><span class="line">          .article-title</span><br><span class="line">            margin: <span class="number">0px</span> <span class="number">40px</span></span><br><span class="line">            font-size <span class="number">18px</span></span><br><span class="line">            .article-title-link</span><br><span class="line">              -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line">          <span class="selector-class">.recent-post-meta</span></span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">20px</span></span><br><span class="line">            <span class="selector-class">.article-meta-wrap</span></span><br><span class="line">              <span class="attribute">font-size</span> <span class="number">12px</span></span><br><span class="line">              -webkit-line-clamp: <span class="number">3</span>;</span><br><span class="line">        <span class="selector-class">.article-content</span></span><br><span class="line">          <span class="attribute">position</span> absolute</span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          <span class="attribute">background</span> <span class="built_in">rgba</span>(<span class="number">25</span>,<span class="number">25</span>,<span class="number">25</span>,<span class="number">0.5</span>)</span><br><span class="line">          <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">130px</span>,<span class="number">0</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">130px</span>,<span class="number">50%</span> <span class="number">100%</span>)</span><br><span class="line">          <span class="selector-class">.article-content-text</span></span><br><span class="line">            -webkit-line-clamp <span class="number">3</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">16px</span></span><br><span class="line">            <span class="attribute">margin</span> <span class="number">0px</span> <span class="number">25px</span> <span class="number">30px</span> <span class="number">25px</span></span><br><span class="line">        <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">          <span class="attribute">display</span> block</span><br><span class="line">          <span class="attribute">background</span> <span class="built_in">var</span>(--article-content-bgcolor)</span><br><span class="line">          <span class="attribute">position</span> absolute</span><br><span class="line">          <span class="attribute">height</span> <span class="number">10px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">20px</span></span><br><span class="line">          <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">0</span>,<span class="number">50%</span> <span class="number">100%</span>)</span><br><span class="line">          <span class="attribute">top</span> <span class="number">20px</span></span><br></pre></td></tr></table></figure><ul><li>样式二:multicard</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//default color:</span></span><br><span class="line"><span class="selector-pseudo">:root</span></span><br><span class="line">  <span class="attr">--recent-post-bgcolor</span>: <span class="built_in">rgba</span>(<span class="number">200</span>, <span class="number">200</span>, <span class="number">200</span>, <span class="number">0.5</span>)  <span class="comment">//默认背景</span></span><br><span class="line">  <span class="attr">--article-content-bgcolor</span>: <span class="number">#49b1f5</span> <span class="comment">//描述版块背景</span></span><br><span class="line">  <span class="attr">--recent-post-arrow</span>: <span class="number">#ffffff</span> <span class="comment">//箭头配色</span></span><br><span class="line">  <span class="attr">--recent-post-cover-shadow</span>: <span class="number">#ffffff</span> <span class="comment">//封面遮罩层配色，建议和默认值的颜色相对应。</span></span><br><span class="line">  <span class="attr">--recent-post-transition</span>: <span class="attribute">all</span> <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)  //动画效果。不了解的不要改动</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="attr">--recent-post-bgcolor</span>: <span class="built_in">rgba</span>(<span class="number">35</span>,<span class="number">35</span>,<span class="number">35</span>,<span class="number">0.5</span>)</span><br><span class="line">  <span class="attr">--article-content-bgcolor</span>: <span class="number">#99999a</span></span><br><span class="line">  <span class="attr">--recent-post-arrow</span>: <span class="number">#37e2dd</span></span><br><span class="line">  <span class="attr">--recent-post-cover-shadow</span>: <span class="number">#232323</span></span><br><span class="line"><span class="comment">// 默认的首页卡片容器布局</span></span><br><span class="line"><span class="selector-class">.recent-posts</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">0</span> <span class="number">15px</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">  <span class="attribute">height</span> fit-content</span><br><span class="line">  <span class="selector-class">.recent-post-item</span></span><br><span class="line">    <span class="attribute">margin-bottom</span> <span class="number">15px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">var</span>(--recent-post-bgcolor)</span><br><span class="line">    <span class="attribute">overflow</span> hidden</span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">15px</span></span><br><span class="line">    <span class="selector-class">.recent-post-content</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">background</span> <span class="built_in">var</span>(--recent-post-bgcolor)</span><br><span class="line">      <span class="attribute">position</span> relative</span><br><span class="line">      <span class="selector-class">.recent-post-cover</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">background</span> transparent</span><br><span class="line">      <span class="selector-class">.recent-post-info</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">background</span> transparent</span><br><span class="line">        <span class="attribute">flex-direction</span> column</span><br><span class="line">        <span class="attribute">justify-content</span> center</span><br><span class="line">        <span class="attribute">align-items</span> center</span><br><span class="line">        <span class="selector-class">.article-title</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">50%</span></span><br><span class="line">          <span class="attribute">display</span>: flex</span><br><span class="line">          <span class="attribute">text-align</span>: center</span><br><span class="line">          <span class="attribute">align-items</span>: center</span><br><span class="line">          <span class="attribute">justify-content</span>: flex-end</span><br><span class="line">          <span class="attribute">flex-direction</span>: column</span><br><span class="line">          <span class="selector-class">.article-title-link</span></span><br><span class="line">            <span class="attribute">color</span>: <span class="built_in">var</span>(--text-highlight-color)</span><br><span class="line">            <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line">            <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">            -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br><span class="line">            <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="variable">$text</span>-hover</span><br><span class="line">        <span class="selector-class">.recent-post-meta</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">50%</span></span><br><span class="line">          <span class="attribute">display</span>: flex</span><br><span class="line">          <span class="attribute">text-align</span>: center</span><br><span class="line">          <span class="attribute">align-items</span>: center</span><br><span class="line">          <span class="attribute">justify-content</span>: flex-start</span><br><span class="line">          <span class="attribute">flex-direction</span>: column</span><br><span class="line">          <span class="selector-class">.article-meta-wrap</span></span><br><span class="line">            <span class="attribute">color</span> <span class="number">#969797</span></span><br><span class="line">            <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">            -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br><span class="line">            <span class="selector-tag">a</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="built_in">var</span>(--text-highlight-color)</span><br><span class="line">              <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line">              <span class="attribute">color</span> <span class="number">#969797</span></span><br><span class="line">              <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">                <span class="attribute">color</span>: <span class="variable">$text</span>-hover</span><br><span class="line">      <span class="selector-class">.article-content</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">text-align</span>: center</span><br><span class="line">        <span class="attribute">flex-direction</span> row</span><br><span class="line">        <span class="attribute">align-items</span> center</span><br><span class="line">        <span class="attribute">justify-content</span> center</span><br><span class="line">        <span class="selector-class">.article-content-text</span></span><br><span class="line">          <span class="attribute">display</span> -webkit-box</span><br><span class="line">          -webkit-<span class="attribute">box-orient</span> vertical</span><br><span class="line">          <span class="attribute">text-overflow</span>: ellipsis</span><br><span class="line">          <span class="attribute">overflow</span> hidden</span><br><span class="line">          <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line">          <span class="attribute">text-shadow</span> <span class="number">1px</span> <span class="number">2px</span> <span class="number">3px</span> <span class="number">#000</span></span><br><span class="line">    &amp;<span class="selector-class">.ads-wrap</span></span><br><span class="line">      <span class="attribute">display</span>: block <span class="meta">!important</span></span><br><span class="line">      <span class="attribute">height</span>: auto <span class="meta">!important</span></span><br><span class="line">  nav<span class="selector-id">#pagination</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line"><span class="comment">// 卡片单元布局样式</span></span><br><span class="line"><span class="selector-class">.recent-posts</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">0</span> <span class="number">15px</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">  <span class="attribute">display</span> flex</span><br><span class="line">  <span class="attribute">flex-direction</span> row</span><br><span class="line">  <span class="attribute">flex-wrap</span> wrap</span><br><span class="line">  <span class="selector-class">.recent-post-item</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">15px</span></span><br><span class="line">    <span class="attribute">overflow</span> hidden</span><br><span class="line">    <span class="selector-class">.recent-post-content</span></span><br><span class="line">      <span class="attribute">flex-direction</span> column</span><br><span class="line">      <span class="attribute">flex-wrap</span> nowrap</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line">      <span class="attribute">max-height</span> <span class="number">350px</span></span><br><span class="line">      <span class="attribute">height</span>: auto</span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="selector-class">.recent-post-cover</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">        <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">130px</span>,<span class="number">0</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">130px</span>,<span class="number">50%</span> <span class="number">100%</span>)</span><br><span class="line">        <span class="selector-tag">img</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          <span class="attribute">object-fit</span> cover</span><br><span class="line">      <span class="selector-class">.recent-post-info</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">150px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        <span class="attribute">padding</span> <span class="number">0px</span> <span class="number">25px</span> <span class="number">5px</span> <span class="number">25px</span></span><br><span class="line">        <span class="selector-class">.article-title</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">40px</span></span><br><span class="line">          <span class="attribute">font-size</span> <span class="number">18px</span></span><br><span class="line">          <span class="selector-class">.article-title-link</span></span><br><span class="line">            -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line">        <span class="selector-class">.recent-post-meta</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">20px</span></span><br><span class="line">          <span class="selector-class">.article-meta-wrap</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">12px</span></span><br><span class="line">            -webkit-line-clamp: <span class="number">3</span>;</span><br><span class="line">      <span class="selector-class">.article-content</span></span><br><span class="line">        <span class="attribute">position</span> absolute</span><br><span class="line">        <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        <span class="attribute">background</span> <span class="built_in">rgba</span>(<span class="number">25</span>,<span class="number">25</span>,<span class="number">25</span>,<span class="number">0.5</span>)</span><br><span class="line">        <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">130px</span>,<span class="number">0</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">130px</span>,<span class="number">50%</span> <span class="number">100%</span>)</span><br><span class="line">        <span class="selector-class">.article-content-text</span></span><br><span class="line">          -webkit-line-clamp <span class="number">3</span></span><br><span class="line">          <span class="attribute">font-size</span> <span class="number">16px</span></span><br><span class="line">          <span class="attribute">margin</span> <span class="number">0px</span> <span class="number">25px</span> <span class="number">30px</span> <span class="number">25px</span></span><br><span class="line">          <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">            <span class="attribute">content</span> <span class="string">&quot;❝&quot;</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">20px</span></span><br><span class="line">          <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">            <span class="attribute">content</span> <span class="string">&quot;❞&quot;</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">20px</span></span><br><span class="line">      <span class="selector-class">.recent-post-arrow</span></span><br><span class="line">        <span class="attribute">display</span> block</span><br><span class="line">        <span class="attribute">background</span> <span class="built_in">var</span>(--article-content-bgcolor)</span><br><span class="line">        <span class="attribute">position</span> absolute</span><br><span class="line">        <span class="attribute">height</span> <span class="number">10px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">20px</span></span><br><span class="line">        <span class="attribute">clip-path</span> <span class="built_in">polygon</span>(<span class="number">0</span> <span class="number">0</span>,<span class="number">100%</span> <span class="number">0</span>,<span class="number">50%</span> <span class="number">100%</span>)</span><br><span class="line">        <span class="attribute">top</span> <span class="number">20px</span></span><br><span class="line"><span class="comment">// 三栏布局滑动卡片样式</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>:<span class="number">1069px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      <span class="attribute">width</span> <span class="number">32.3%</span></span><br><span class="line">      margin <span class="number">0px</span> <span class="number">1%</span> <span class="number">20px</span> <span class="number">0px</span></span><br><span class="line">      .recent-post-content</span><br><span class="line">        .recent-post-info</span><br><span class="line">          .article-title</span><br><span class="line">            margin: <span class="number">0px</span> <span class="number">5px</span></span><br><span class="line">            .article-title-link</span><br><span class="line">              -webkit-line-clamp: <span class="number">1</span>;</span><br><span class="line">          <span class="selector-class">.recent-post-meta</span></span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">5px</span></span><br><span class="line">            <span class="selector-class">.article-meta-wrap</span></span><br><span class="line">              -webkit-line-clamp: <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 双栏布局卡片自适应适配</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>:<span class="number">572px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">1068px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      <span class="attribute">width</span> <span class="number">47%</span></span><br><span class="line">      margin <span class="number">0px</span> <span class="number">3%</span> <span class="number">20px</span> <span class="number">0px</span></span><br><span class="line">// 单栏布局卡片自适应适配</span><br><span class="line">@media screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">572px</span>)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br></pre></td></tr></table></figure></li><li><p>修改<code>[BlogRoot]\themes\butterfly\source\css\_page\homepage.styl</code>,将整文件内容替换为以下代码：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;index_card_style&#x27;</span>) == <span class="string">&#x27;slidecard&#x27;</span></span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;./_index_card_style/slidecard&#x27;</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;index_card_style&#x27;</span>) == <span class="string">&#x27;multicard&#x27;</span></span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;./_index_card_style/multicard&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>然后在主题配置文件<code>[BlogRoot]\_config.butterfly.yml</code>里新增配置项，这样我们就可以通过配置项自由切换使用哪款了：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主页卡片样式</span></span><br><span class="line"><span class="comment"># Docs: https://akilar.top/posts/d6b69c49/</span></span><br><span class="line"><span class="attr">index_card_style:</span> <span class="string">multicard</span> <span class="comment"># slidecard | multicard</span></span><br></pre></td></tr></table></figure></li><li><p>考虑到不管是样式一还是样式二都存在一个布局突变的情况。为了不至于让首页的文章出现空缺，建议将首页生成的文章数量控制为1,2,3的公倍数。修改站点配置文件<code>[BlogRoot]\_config.yml</code>。找到以下配置项进行调整，注意这是站点配置文件本就有的配置项，不是新增配置项。建议是调整为12篇。如果你的侧边栏魔改内容特别多，那么建议改成18、24、30。务必确保文章卡片栏比侧栏完全展开要长，这样展示效果最好</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># path: Root path for your blogs index page. (default = &#x27;&#x27;)</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">12</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br></pre></td></tr></table></figure></li><li><p>本教程讨论的卡片都是考虑有封面和有描述的。所以需要保证你已经开启了相应的配置，查看主题配置文件<code>[BlogRoot]\_config.butterfly.yml</code>,找到配置项开启描述栏，建议选择2模式</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Display the article introduction on homepage</span></span><br><span class="line"><span class="comment"># 1: description</span></span><br><span class="line"><span class="comment"># 2: both (if the description exists, it will show description, or show the auto_excerpt)</span></span><br><span class="line"><span class="comment"># 3: auto_excerpt (default)</span></span><br><span class="line"><span class="comment"># false: do not show the article introduction</span></span><br><span class="line"><span class="attr">index_post_content:</span></span><br><span class="line">  <span class="attr">method:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">500</span> <span class="comment"># if you set method to 2 or 3, the length need to config</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="局部美化"><a href="#局部美化" class="headerlink" title="局部美化"></a>局部美化</h2><h3 id="个人卡片"><a href="#个人卡片" class="headerlink" title="个人卡片"></a>个人卡片</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/%E4%B8%AA%E4%BA%BA%E5%8D%A1%E7%89%87%E5%8F%98%E8%89%B2%E6%95%88%E6%9E%9C%E5%9B%BE" alt="image-20260110174908177"></p><blockquote><p>个人信息卡片渐变色调整:</p></blockquote><ol><li><p>在<code>[BlogRoot]\source\css\custom.css</code>自定义样式的文件中引入如下代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 侧边栏个人信息卡片动态渐变色 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> &gt; <span class="selector-class">.card-widget</span><span class="selector-class">.card-info</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(</span><br><span class="line">    -<span class="number">45deg</span>,</span><br><span class="line">    <span class="number">#e8d8b9</span>,</span><br><span class="line">    <span class="number">#eccec5</span>,</span><br><span class="line">    <span class="number">#a3e9eb</span>,</span><br><span class="line">    <span class="number">#bdbdf0</span>,</span><br><span class="line">    <span class="number">#eec1ea</span></span><br><span class="line">  );</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgb</span>(<span class="number">66</span>, <span class="number">68</span>, <span class="number">68</span>);</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">400%</span> <span class="number">400%</span>;</span><br><span class="line">  -webkit-<span class="attribute">animation</span>: Gradient <span class="number">10s</span> ease infinite;</span><br><span class="line">  -moz-<span class="attribute">animation</span>: Gradient <span class="number">10s</span> ease infinite;</span><br><span class="line">  <span class="attribute">animation</span>: Gradient <span class="number">10s</span> ease infinite <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> Gradient &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-moz-keyframes</span> Gradient &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> Gradient &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 黑夜模式适配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#aside-content</span> &gt; <span class="selector-class">.card-widget</span><span class="selector-class">.card-info</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#191919ee</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 个人信息Follow me按钮 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> &gt; <span class="selector-class">.card-widget</span><span class="selector-class">.card-info</span> &gt; <span class="selector-id">#card-info-btn</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#3eb8be</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>最后记得在<code>inject</code>配置项引入</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="图标自定义"><a href="#图标自定义" class="headerlink" title="图标自定义"></a>图标自定义</h3><h4 id="前置条件1——外挂标签引入"><a href="#前置条件1——外挂标签引入" class="headerlink" title="前置条件1——外挂标签引入"></a>前置条件1——外挂标签引入</h4><ol><li><p>安装插件,在博客根目录<code>[BlogRoot]</code>下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-tag-plugins-plus --save</span><br></pre></td></tr></table></figure></li><li><p>考虑到hexo自带的markdown渲染插件<code>hexo-renderer-marked</code>与外挂标签语法的兼容性较差，建议您将其替换成<a href="https://www.npmjs.com/package/hexo-renderer-kramed">hexo-renderer-kramed</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-kramed --save</span><br></pre></td></tr></table></figure></li><li><p>添加配置信息，以下为写法示例, 在站点配置文件<code>_config.yml</code>或者主题配置文件<code>_config.butterfly.yml</code>中添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tag-plugins-plus</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/615e2dec/</span></span><br><span class="line"><span class="attr">tag_plugins:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">issues:</span> <span class="literal">false</span> <span class="comment">#issues标签依赖注入开关</span></span><br><span class="line">  <span class="attr">link:</span></span><br><span class="line">    <span class="attr">placeholder:</span> <span class="string">/img/link.png</span> <span class="comment">#link_card标签默认的图标图片</span></span><br><span class="line">  <span class="attr">CDN:</span></span><br><span class="line">    <span class="attr">anima:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css</span> <span class="comment">#动画标签anima的依赖</span></span><br><span class="line">    <span class="attr">jquery:</span> <span class="string">https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js</span> <span class="comment">#issues标签依赖</span></span><br><span class="line">    <span class="attr">issues:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/issues.js</span> <span class="comment">#issues标签依赖</span></span><br><span class="line">    <span class="attr">iconfont:</span> <span class="string">//at.alicdn.com/t/font_2032782_8d5kxvn09md.js</span> <span class="comment">#参看https://akilar.top/posts/d2ebecef/</span></span><br><span class="line">    <span class="attr">carousel:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js</span></span><br><span class="line">    <span class="attr">tag_plugins_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="前置条件2——iconfont引入"><a href="#前置条件2——iconfont引入" class="headerlink" title="前置条件2——iconfont引入"></a>前置条件2——iconfont引入</h4><ol><li><p>访问<a href="https://www.iconfont.cn/">阿里巴巴矢量图标库</a>,注册登录。</p></li><li><p>搜索自己心仪的图标，然后选择<strong>添加入库</strong>，加到购物车。</p></li><li><p>选择完毕后点击右上角的购物车图标，打开侧栏，选择添加到项目，如果没有项目就新建一个。</p><p><a href="https://s1.vika.cn/space/2022/10/29/91ec7f6432274b42b50698ef554a2b91"><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/p" alt="p4"></a></p></li><li><p>可以通过上方顶栏菜单-&gt;资源管理-&gt;我的项目，找到之前添加的图标项目。(现在的iconfont可以在图标库的项目设置里直接打开彩色设置，然后采用fontclass的引用方式即可使用多彩图标。但是<strong>单一项目彩色图标上限是40个图标</strong>，酌情采用。)</p><p> <img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/iconfont%E5%BC%95%E5%85%A5" alt="image-20260110202114606"></p></li></ol><blockquote><p>最新版本的iconfont支持直接在项目设置中开启彩色图标，从而实现直接用class添加多彩色图标。（推荐直接用这个即可）</p></blockquote><ol><li><p>在主题配置文件<code>inject</code>配置项进行全局引入：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/font_2264842_b004iy0kk2b.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;//at.alicdn.com/t/font_2264842_b004iy0kk2b.js&quot;&gt;&lt;/script&gt;</span> </span><br></pre></td></tr></table></figure></li><li><p>可以通过自己的阿里图标库的font-class方案查询复制相应的<code>icon-xxxx</code></p></li></ol><h4 id="导航栏图标自定义-新版本失效"><a href="#导航栏图标自定义-新版本失效" class="headerlink" title="导航栏图标自定义(新版本失效)"></a><del>导航栏图标自定义(新版本失效)</del></h4><blockquote><p>前置教程：<a href="https://akilar.top/posts/d2ebecef/">Hexo引入阿里矢量图标库-iconfont inject</a>和<a href="https://akilar.top/posts/615e2dec/#动态标签-anima">基于Butterfly的外挂标签引入-Tag Plugins Plus</a>中关于<code>动态标签anima</code>的内容。请确保您已经完成了前置教程，并实现了在文章中使用<code>symbol</code>写法来引入<code>iconfont</code>图标。同时引入了<code>fontawesome_animation</code>的前置依赖。</p></blockquote><ol><li><p>主要检查您的<code>inject</code>配置项中是否有这两个依赖</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment">#动画标签anima的依赖</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css&quot;</span>  <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># 阿里矢量图标,这串是我的图标库，你的链接会有所不同。</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;//at.alicdn.com/t/font_2032782_ev6ytrh30f.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>本方案默认使用观感最佳的悬停父元素触发子元素动画效果，默认动画为<code>faa-tada</code>。以下是填写示例，在<code>[BlogRoot]\_config.butterfly.yml</code>中修改。<code>icon-xxx</code>字样的为<code>iconfont</code>的<code>symbol</code>引入方案的<code>id</code>值，可以在你的<code>iconfont</code>图标库内查询，其中hide属性也是可以用的。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">首页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">icon-home</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="string">文章</span> <span class="string">||</span> <span class="string">icon--article</span> <span class="string">||</span> <span class="string">faa-tada</span> <span class="string">||</span> <span class="attr">hide:</span></span><br><span class="line">    <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">icon-guidang1</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">    <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">icon-sekuaibiaoqian</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">    <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">icon-fenlei</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">    <span class="string">随便逛逛:</span> <span class="string">javascript:randomPost();</span> <span class="string">||</span> <span class="string">icon-zuji1</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br></pre></td></tr></table></figure></li><li><p>要注意的是，这里的动态图标是<code>svg.icon</code>的标签，因此上面调节<code>.iconfont</code>的css并不使用，我们需要在自定义样式文件<code>custom.css</code>里加上一些样式来限制图标的大小和颜色等，具体大小自行调节。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">svg</span><span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1.28em</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1.28em</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">  <span class="attribute">fill</span>: currentColor;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>重启项目即可看到效果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol><h4 id="Social图标自定义"><a href="#Social图标自定义" class="headerlink" title="Social图标自定义"></a>Social图标自定义</h4><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/Social%E5%9B%BE%E6%A0%87%E5%B1%95%E7%A4%BA" alt="image-20260110204032847"></p><blockquote><p>代码原理和上面的菜单栏基本一致，所以各个前置教程都不再重复，这里只提供代码魔改内容和配置项编写方案。</p></blockquote><ol><li><p>重写<code>[BlogRoot]\themes\butterfly\layout\includes\header\social.pug</code>,替换为以下代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">each value, title in theme.social</span><br><span class="line">  a.social-icon.faa-parent.animated-hover(href=url_for(trim(value.split(&#x27;||&#x27;)[0])) target=&quot;_blank&quot; title=title === undefined ? &#x27;&#x27; : trim(title))</span><br><span class="line">    if value.split(&#x27;||&#x27;)[1]</span><br><span class="line">      - var icon_value = trim(value.split(&#x27;||&#x27;)[1])</span><br><span class="line">      - var anima_value = value.split(&#x27;||&#x27;)[2] ? trim(value.split(&#x27;||&#x27;)[2]) : &#x27;faa-tada&#x27;</span><br><span class="line">      if icon_value.substring(0,2)==&quot;fa&quot;      </span><br><span class="line">        i.fa-fw(class=icon_value + &#x27; &#x27; + anima_value)</span><br><span class="line">      else if icon_value.substring(0,4)==&quot;icon&quot;          </span><br><span class="line">        svg.social_icon(aria-hidden=&quot;true&quot; class=anima_value)</span><br><span class="line">          use(xlink:href=`#`+ icon_value)</span><br></pre></td></tr></table></figure></li><li><p>以下为对应的<code>social</code>配置项。写法沿用<code>menu_item</code>的写法示例，修改<code>[BlogRoot]\_config.butterfly.yml</code>的<code>social</code>配置项，具体的链接改为自己的。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">GitHub:</span> <span class="string">https://github.com/koco-co</span> <span class="string">||</span> <span class="string">icon-Githubzhanghao</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">Email:</span> <span class="string">mailto:kopohub@gmail.com</span> <span class="string">||</span> <span class="string">icon-pailietubiao-30</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">Bilibili:</span> <span class="string">https://space.bilibili.com/3546823172033014</span> <span class="string">||</span> <span class="string">icon-bilibili2</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">Twitter:</span> <span class="string">https://x.com/SugerQvQ</span> <span class="string">||</span> <span class="string">icon-tuite</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">Telegram:</span> <span class="string">https://t.me/sugerovo</span> <span class="string">||</span> <span class="string">icon-Telegramzhanghao</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="comment"># QQ: https://res.abeim.cn/api/qq/?qq=1174008660 || icon-QQ || faa-tada</span></span><br><span class="line">  <span class="comment"># 力扣: https://leetcode.cn/u/fomalhaut1998 || icon-likou || faa-tada</span></span><br></pre></td></tr></table></figure></li><li><p>要注意的是，这里的动态图标是<code>svg.icon</code>的标签，因此上面调节<code>.iconfont</code>的css并不使用，我们需要在自定义样式文件<code>custom.css</code>里加上一些样式来限制图标的大小和颜色等，具体大小自行调节（如果上面弄过菜单栏的图标大小，这里也就不需要再重复写了）。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">svg</span><span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1.28em</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1.28em</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">  <span class="attribute">fill</span>: currentColor;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>调节社交图标的大小就用以下的css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">svg</span><span class="selector-class">.social_icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1.20em</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1.20em</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">  <span class="attribute">fill</span>: currentColor;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>重启项目即可看到效果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol><h4 id="侧边栏图标自定义"><a href="#侧边栏图标自定义" class="headerlink" title="侧边栏图标自定义"></a>侧边栏图标自定义</h4><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E5%9B%BE%E6%A0%87%E8%87%AA%E5%AE%9A%E4%B9%89.png" alt="image-20260111134454655"></p><blockquote><p>这里的图标也是用的iconfont的，请完成前面的图标引入教程！由于侧边栏比较多，这里就演示改网站信息，剩下的侧边栏改法几乎一样的！</p></blockquote><ol><li><p>进入<code>[BlogRoot]\themes\butterfly\layout\includes\widget\card_webinfo.pug</code>，进行以下修改，因为默认的图标是<code>font-awesome</code>的黑白图标，就是<code>i.fas.fa-chart-line</code>那一行，删除，然后引入新的图标标签，其中图标的样式、名称等参考自己的需要进行更改，样式主要是<code>width</code>、<code>height</code>、<code>position</code>、<code>top</code>这几个属性，这里的<code>animated-hover</code>和<code>faa-tada</code>是给对应的元素套上对应的class，如果装了动画依赖，扫描到这些class的元素会自动挂载动画样式，如果不想要可以去除。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">if theme.aside.card_webinfo.enable</span><br><span class="line">  .card-widget.card-webinfo</span><br><span class="line">    .item-headline</span><br><span class="line">-      i.fas.fa-chart-line</span><br><span class="line">+      a.faa-parent.animated-hover</span><br><span class="line">+       svg.faa-tada.icon(style=&quot;height:25px;width:25px;fill:currentColor;position:relative;top:5px&quot; aria-hidden=&quot;true&quot;)</span><br><span class="line">+        use(xlink:href=&#x27;#icon-shujutongji2&#x27;)</span><br><span class="line">      span= _p(&#x27;aside.card_webinfo.headline&#x27;)</span><br><span class="line">    .webinfo</span><br><span class="line">      if theme.aside.card_webinfo.post_count</span><br><span class="line">        .webinfo-item</span><br><span class="line">          .item-name= _p(&#x27;aside.card_webinfo.article_name&#x27;) + &quot; :&quot;</span><br><span class="line">          .item-count= site.posts.length</span><br><span class="line">      if theme.runtimeshow.enable</span><br><span class="line">        .webinfo-item</span><br><span class="line">          .item-name= _p(&#x27;aside.card_webinfo.runtime.name&#x27;) + &quot; :&quot;</span><br><span class="line">          .item-count#runtimeshow(data-publishDate=date_xml(theme.runtimeshow.publish_date))</span><br><span class="line">            i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">      if theme.wordcount.enable &amp;&amp; theme.wordcount.total_wordcount</span><br><span class="line">        .webinfo-item</span><br><span class="line">          .item-name=_p(&#x27;aside.card_webinfo.site_wordcount&#x27;) + &quot; :&quot;</span><br><span class="line">          .item-count=totalcount(site)</span><br><span class="line">      if theme.busuanzi.site_uv</span><br><span class="line">        .webinfo-item</span><br><span class="line">          .item-name= _p(&#x27;aside.card_webinfo.site_uv_name&#x27;) + &quot; :&quot;</span><br><span class="line">          .item-count#busuanzi_value_site_uv</span><br><span class="line">            i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">      if theme.busuanzi.site_pv</span><br><span class="line">        .webinfo-item</span><br><span class="line">          .item-name= _p(&#x27;aside.card_webinfo.site_pv_name&#x27;) + &quot; :&quot;</span><br><span class="line">          .item-count#busuanzi_value_site_pv</span><br><span class="line">            i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">      if theme.aside.card_webinfo.last_push_date</span><br><span class="line">        .webinfo-item</span><br><span class="line">          .item-name= _p(&#x27;aside.card_webinfo.last_push_date.name&#x27;) + &quot; :&quot;</span><br><span class="line">          .item-count#last-push-date(data-lastPushDate=date_xml(Date.now()))</span><br><span class="line">            i.fa-solid.fa-spinner.fa-spin</span><br></pre></td></tr></table></figure></li><li><p>如果我们设置了语言为<code>zh-CN</code>那么就到<code>[BlogRoot]\themes\butterfly\languages\zh-CN.yml</code>进行修改。<code>yml</code>文件是以缩进区分层级的，我们只需要寻找<code>aside</code>-&gt;<code>card_webinfo</code>-&gt;<code>headline</code>这一项修改为自己喜欢的内容即可</p></li><li>重新编译看效果</li></ol><h4 id="底部直达按钮"><a href="#底部直达按钮" class="headerlink" title="底部直达按钮"></a>底部直达按钮</h4><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/%2525E7%25259B%2525B4%2525E8%2525BE%2525BE%2525E5%2525BA%252595%2525E9%252583%2525A8%2525E6%25258C%252589%2525E9%252592%2525AE.png" alt="image-20260110213107117"></p><p>在<code>[BlogRoot]\themes\butterfly\layout\includes\rightside.pug</code>做以下修改:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">button#go-up(type=&quot;button&quot; title=_p(&quot;rightside.back_to_top&quot;))</span><br><span class="line">  i.fas.fa-arrow-up</span><br><span class="line"></span><br><span class="line">// 在文件末尾新增以下两行代码</span><br><span class="line">button#go-down(type=&quot;button&quot; title=&quot;直达底部&quot; onclick=&quot;btf.scrollToDest(document.body.scrollHeight, 500)&quot;)</span><br><span class="line">  i.fas.fa-arrow-down</span><br></pre></td></tr></table></figure><h3 id="文章摘要"><a href="#文章摘要" class="headerlink" title="文章摘要"></a>文章摘要</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E6%96%87%E7%AB%A0%E6%91%98%E8%A6%81.png" alt="image-20260113001844774"></p><blockquote><p>因为主题 UI 的关係，主页文章节选只支持自动节选和文章页<code>description</code>.</p></blockquote><ol><li><p>修改配置项: <code>_config.butterfly.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ======================================</span></span><br><span class="line"><span class="comment"># 首页文章卡片布局方式（index_layout）</span></span><br><span class="line"><span class="comment"># ======================================</span></span><br><span class="line"><span class="comment"># 1：封面在左，文章信息在右</span></span><br><span class="line"><span class="comment"># 2：封面在右，文章信息在左</span></span><br><span class="line"><span class="comment"># 3：封面与文章信息左右交替显示</span></span><br><span class="line"><span class="comment"># 4：封面在上，文章信息在下</span></span><br><span class="line"><span class="comment"># 5：文章信息直接显示在封面图上</span></span><br><span class="line"><span class="comment"># 6：瀑布流布局 - 封面在上，信息在下</span></span><br><span class="line"><span class="comment"># 7：瀑布流布局 - 信息直接显示在封面图上</span></span><br><span class="line"><span class="comment"># ======================================</span></span><br><span class="line"></span><br><span class="line"><span class="attr">index_layout:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================================</span></span><br><span class="line"><span class="comment"># 首页文章简介显示规则（index_post_content）</span></span><br><span class="line"><span class="comment"># ======================================</span></span><br><span class="line"><span class="comment"># method 说明：</span></span><br><span class="line"><span class="comment"># 1：仅显示文章 front-matter 中的 description 字段</span></span><br><span class="line"><span class="comment">#    - 若文章未配置 description，则首页不显示任何简介</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2：优先显示 description</span></span><br><span class="line"><span class="comment">#    - 若存在 description，则显示 description</span></span><br><span class="line"><span class="comment">#    - 若不存在，则从正文中自动截取指定长度作为简介</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 3：始终从正文中自动截取摘要作为简介(默认)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># length 说明：</span></span><br><span class="line"><span class="comment"># - 当 method 为 2 或 3 时必须配置</span></span><br><span class="line"><span class="comment"># - 控制从正文中截取的字符长度</span></span><br><span class="line"><span class="comment"># ======================================</span></span><br><span class="line"></span><br><span class="line"><span class="attr">index_post_content:</span></span><br><span class="line">  <span class="attr">method:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">200</span></span><br></pre></td></tr></table></figure></li><li><p>description在 front-matter 裡添加</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">description: 这是一段文章摘要</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="文章链接"><a href="#文章链接" class="headerlink" title="文章链接"></a>文章链接</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%25E6%2596%2587%25E7%25AB%25A0%25E9%2593%25BE%25E6%258E%25A5%25E4%25BC%2598%25E5%258C%2596.png" alt="image-20260110230238740"></p><blockquote><p>在Hexo的默认设定中，你的博客文章链接是由:<code>year/:month/:day/:title/</code>构成的，即按照年：月：日：标题的格式来生成链接，如果你的文章标题中还含有中文的话，复制URL链接就会有一大串编码字符。</p></blockquote><ol><li><p>安装<code>hexo-abbrlink</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure></li><li><p>打开站点配置文件<code>_config.yml</code>,修改permalink为：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># abbrlink config</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line">  <span class="attr">alg:</span> <span class="string">crc32</span>      <span class="comment"># support crc16(default) and crc32</span></span><br><span class="line">  <span class="attr">rep:</span> <span class="string">hex</span>        <span class="comment"># support dec(default) and hex</span></span><br></pre></td></tr></table></figure></li><li><p>在文章顶部的metadata中，添加如下字段，可以自定义，如 <code>abbrlink: gongnengtuozhan</code>，否则会生成<code>随机数字</code>。生成访问链接使用的就是这段文字，可自定义。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">abbrlink: function-expansion</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></li><li><p>hexo 三连即可</p></li></ol><h3 id="文章版权"><a href="#文章版权" class="headerlink" title="文章版权"></a>文章版权</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/%E6%B8%90%E5%8F%98%E8%89%B2%E7%89%88%E6%9D%83%E7%BE%8E%E5%8C%96%E5%B1%95%E7%A4%BA" alt="image-20260110210035473"></p><ol><li><p>修改<code>[BlogRoot]\themes\butterfly\layout\includes\post\post-copyright.pug</code>,直接复制以下内容替换原文件内容。此处多次用到了三元运算符作为默认项设置，在确保有主题配置文件的默认项的情况下，也可以在相应文章的<code>front-matter</code>中重新定义作者，原文链接，开源许可协议等内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">if theme.post_copyright.enable &amp;&amp; page.copyright !== false</span><br><span class="line">  - let author = page.copyright_author ? page.copyright_author : config.author</span><br><span class="line">  - let url = page.copyright_url ? page.copyright_url : page.permalink</span><br><span class="line">  - let license = page.license ? page.license : theme.post_copyright.license</span><br><span class="line">  - let license_url = page.license_url ? page.license_url : theme.post_copyright.license_url</span><br><span class="line">  .post-copyright</span><br><span class="line">    .post-copyright__title</span><br><span class="line">      span.post-copyright-info</span><br><span class="line">        h #[=page.title]</span><br><span class="line">    .post-copyright__type</span><br><span class="line">      span.post-copyright-info</span><br><span class="line">        a(href=url_for(url))= theme.post_copyright.decode ? decodeURI(url) : url</span><br><span class="line">    .post-copyright-m</span><br><span class="line">      .post-copyright-m-info</span><br><span class="line">        .post-copyright-a</span><br><span class="line">            h 作者</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=author</span><br><span class="line">        .post-copyright-c</span><br><span class="line">            h 发布于</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=date(page.date, config.date_format)</span><br><span class="line">        .post-copyright-u</span><br><span class="line">            h 更新于</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=date(page.updated, config.date_format)</span><br><span class="line">        .post-copyright-c</span><br><span class="line">            h 许可协议</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                a.icon(rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27; title=&#x27;Creative Commons&#x27; href=&#x27;https://creativecommons.org/&#x27;)</span><br><span class="line">                  i.fab.fa-creative-commons</span><br><span class="line">                a(rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27; title=license href=url_for(license_url))=license</span><br></pre></td></tr></table></figure></li><li><p>修改<code>[BlogRoot]\themes\butterfly\source\css\_layout\post.styl</code>,直接复制以下内容，替换原文件，这个文件就是自己调节样式的。其中，<code>184</code>行是白天模式的背景色，这里默认是我网站的渐变色，大家可以根据自己的喜好调节；<code>253</code>行是夜间模式的发光光圈颜色，大家也可以自行替换成自己喜欢的颜色：</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">beautify</span><span class="params">()</span></span></span><br><span class="line">  <span class="built_in">headStyle</span>(fontsize)</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="built_in">unit</span>(fontsize + <span class="number">12</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">margin-left</span>: <span class="built_in">unit</span>((<span class="built_in">-</span>(fontsize + <span class="number">6</span>)), <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">unit</span>(fontsize, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="built_in">unit</span>(fontsize + <span class="number">18</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span>,</span><br><span class="line">  <span class="selector-tag">h2</span>,</span><br><span class="line">  <span class="selector-tag">h3</span>,</span><br><span class="line">  <span class="selector-tag">h4</span>,</span><br><span class="line">  <span class="selector-tag">h5</span>,</span><br><span class="line">  <span class="selector-tag">h6</span></span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-out</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">top</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">7px</span>)</span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$title</span>-prefix-icon-color</span><br><span class="line">      <span class="attribute">content</span>: <span class="variable">$title</span>-prefix-icon</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">1</span></span><br><span class="line">      <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-out</span><br><span class="line">      <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h2</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h3</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h4</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h5</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h6</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  <span class="selector-tag">ul</span></span><br><span class="line">    <span class="selector-tag">p</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">li</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::marker</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">600</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">1.05em</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="selector-pseudo">&amp;::marker</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--pseudo-hover)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span></span><br><span class="line">    <span class="attribute">list-style-type</span>: circle</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#article-container</span></span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word</span><br><span class="line">  <span class="attribute">overflow-wrap</span>: break-word</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$theme</span>-link-color</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">text-decoration</span>: underline</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">img</span></span><br><span class="line">    <span class="attribute">display</span>: block</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">20px</span></span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span></span><br><span class="line">    <span class="attribute">transition</span>: filter <span class="number">375ms</span> ease-in .<span class="number">2s</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">p</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">iframe</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;anchor&#x27;</span>)</span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-class">.headerlink</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">        <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line">        <span class="attribute">float</span>: right</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--headline-presudo)</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;\f0c1&#x27;</span></span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">95em</span></span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">3s</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--pseudo-hover)</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">h1</span>,</span><br><span class="line">    <span class="selector-tag">h2</span>,</span><br><span class="line">    <span class="selector-tag">h3</span>,</span><br><span class="line">    <span class="selector-tag">h4</span>,</span><br><span class="line">    <span class="selector-tag">h5</span>,</span><br><span class="line">    <span class="selector-tag">h6</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-tag">a</span><span class="selector-class">.headerlink</span></span><br><span class="line">          <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">            <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  <span class="selector-tag">ul</span></span><br><span class="line">    <span class="selector-tag">ol</span>,</span><br><span class="line">    <span class="selector-tag">ul</span></span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">li</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">4px</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">p</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.enable&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.field&#x27;</span>) == <span class="string">&#x27;site&#x27;</span></span><br><span class="line">      <span class="built_in">beautify</span>()</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.field&#x27;</span>) == <span class="string">&#x27;post&#x27;</span></span><br><span class="line">      &amp;<span class="selector-class">.post-content</span></span><br><span class="line">        <span class="built_in">beautify</span>()</span><br><span class="line"></span><br><span class="line">  &gt; <span class="selector-pseudo">:last-child</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0</span> <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#post</span></span><br><span class="line">  <span class="selector-class">.tag_share</span></span><br><span class="line">    <span class="selector-class">.post-meta</span></span><br><span class="line">      &amp;__tag-list</span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line"></span><br><span class="line">      &amp;__tags</span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">8px</span> <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span></span><br><span class="line">        <span class="attribute">width</span>: fit-content</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">12px</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">85em</span></span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">background</span>: <span class="variable">$light</span>-blue</span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--white)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post_share</span></span><br><span class="line">      <span class="attribute">display</span>: inline-block</span><br><span class="line">      <span class="attribute">float</span>: right</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span>: fit-content</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.social-share</span></span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">85em</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.social-share-icon</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span></span><br><span class="line">          <span class="attribute">width</span>: w = <span class="number">1.85em</span></span><br><span class="line">          <span class="attribute">height</span>: w</span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">1.2em</span></span><br><span class="line">          <span class="attribute">line-height</span>: w</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-copyright</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">40px</span> <span class="number">0</span> <span class="number">10px</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">16px</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--light-grey)</span><br><span class="line">    <span class="attribute">transition</span>: box-shadow .<span class="number">3s</span> ease-in-out</span><br><span class="line">    <span class="attribute">overflow</span>: hidden</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span><span class="meta">!important</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, <span class="number">#f6d8f5</span>, <span class="number">#c2f1f0</span>, <span class="number">#f0debf</span>);</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">background</span> <span class="built_in">var</span>(--heo-post-blockquote-bg)</span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">right</span> -<span class="number">26px</span></span><br><span class="line">      <span class="attribute">top</span> -<span class="number">120px</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&#x27;\f25e&#x27;</span></span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">200px</span></span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Font Awesome 5 Brands&#x27;</span></span><br><span class="line">      <span class="attribute">opacity</span> .<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">232</span>, <span class="number">237</span>, <span class="number">250</span>, .<span class="number">6</span>), <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">232</span>, <span class="number">237</span>, <span class="number">250</span>, .<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post-copyright</span></span><br><span class="line">      &amp;-meta</span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">font-weight</span>: bold</span><br><span class="line"></span><br><span class="line">      &amp;-info</span><br><span class="line">        <span class="attribute">padding-left</span>: <span class="number">6px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">a</span></span><br><span class="line">          <span class="attribute">text-decoration</span>: none</span><br><span class="line">          <span class="attribute">word-break</span>: break-word</span><br><span class="line"></span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="attribute">text-decoration</span>: none</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-copyright-cc-info</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$theme</span>-color;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-outdate-notice</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1.2em</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="variable">$noticeOutdate</span>-bg</span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$noticeOutdate</span>-color</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;noticeOutdate.style&#x27;</span>) == <span class="string">&#x27;flat&#x27;</span></span><br><span class="line">      <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1em</span> .<span class="number">5em</span> <span class="number">2.6em</span></span><br><span class="line">      <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="variable">$noticeOutdate</span>-border</span><br><span class="line"></span><br><span class="line">      <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">        <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line">        <span class="attribute">position</span>: absolute</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">50%</span></span><br><span class="line">        <span class="attribute">left</span>: .<span class="number">9em</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$noticeOutdate</span>-border</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;\f071&#x27;</span></span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.ads-wrap</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">40px</span> <span class="number">0</span></span><br><span class="line"><span class="selector-class">.post-copyright-m-info</span></span><br><span class="line">  <span class="selector-class">.post-copyright-a</span>,</span><br><span class="line">  <span class="selector-class">.post-copyright-c</span>,</span><br><span class="line">  <span class="selector-class">.post-copyright-u</span></span><br><span class="line">    <span class="attribute">display</span> inline-block</span><br><span class="line">    <span class="attribute">width</span> fit-content</span><br><span class="line">    <span class="attribute">padding</span> <span class="number">2px</span> <span class="number">5px</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-id">#post</span></span><br><span class="line">    <span class="selector-class">.post-copyright</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#07080a</span></span><br><span class="line">      <span class="attribute">text-shadow</span> <span class="number">#bfbeb8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2px</span></span><br><span class="line">      <span class="attribute">border</span> <span class="number">1px</span> solid <span class="built_in">rgb</span>(<span class="number">19</span> <span class="number">18</span> <span class="number">18</span> / <span class="number">35%</span>)</span><br><span class="line">      <span class="attribute">box-shadow</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">var</span>(--theme-color)</span><br><span class="line">      <span class="attribute">animation</span> flashlight <span class="number">1s</span> linear infinite alternate</span><br><span class="line">  <span class="selector-class">.post-copyright-info</span></span><br><span class="line">    <span class="attribute">color</span> <span class="number">#e0e0e4</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#post</span></span><br><span class="line">  <span class="selector-class">.post-copyright__title</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">22px</span></span><br><span class="line">  <span class="selector-class">.post-copyright__notice</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">15px</span></span><br><span class="line">  <span class="selector-class">.post-copyright</span></span><br><span class="line">    <span class="attribute">box-shadow</span> <span class="number">2px</span> <span class="number">2px</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure></li><li><p>默认项的配置</p><ul><li><p>作者：<code>[BlogRoot]\_config.yml</code>中的<code>author</code>配置项</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Koco-co&#x27;s</span> <span class="string">Space</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">Koco-co.github.io</span></span><br><span class="line"><span class="attr">description:</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Koco-co</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span></span><br></pre></td></tr></table></figure></li><li><p>许可协议：<code>[BlogRoot]\_config.butterfly.yml</code>中的<code>license</code>和<code>license_url</code>配置项</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_copyright:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">decode:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">CC</span> <span class="string">BY-NC-SA</span> <span class="number">4.0</span></span><br><span class="line">  <span class="attr">license_url:</span> <span class="string">https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>页面覆写配置项，修改对应文章的<code>front-matter</code></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Butterfly 主题魔改美化# 文章名称</span><br><span class="line">date: 2026-01-10 17:02:30# 文章发布日期</span><br><span class="line">tags: [ Butterfly ]# 标签</span><br><span class="line">categories: [ Blog ]# 分类</span><br><span class="line">cover:# 文章封面图片</span><br><span class="line">updated:# 文章更新日期</span><br><span class="line">copyright<span class="emphasis">_author:# 作者覆写</span></span><br><span class="line"><span class="emphasis">copyright_</span>url:# 原文链接覆写</span><br><span class="line">license:# 许可协议名称覆写</span><br><span class="line"><span class="section">license<span class="emphasis">_url: # 许可协议链接覆写</span></span></span><br><span class="line"><span class="emphasis"><span class="section">---</span></span></span><br></pre></td></tr></table></figure></li></ol><h3 id="公告栏自定义"><a href="#公告栏自定义" class="headerlink" title="公告栏自定义"></a>公告栏自定义</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%25E5%2585%25AC%25E5%2591%258A%25E6%25A0%258F%25E7%25BE%258E%25E5%258C%2596.png" alt="image-20260111124938802"></p><blockquote><p>在主题配置文件<code>_config.butterfly.yml</code>中写入如下配置：</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">&lt;center&gt;&lt;b&gt;---</span> <span class="string">主域名</span> <span class="string">---&lt;br&gt;&lt;a</span> <span class="string">href=&quot;https://koco-co.github.io&quot;</span> <span class="string">title=&quot;此线路为主域名&quot;</span> <span class="string">class=&quot;anno_content&quot;&gt;&lt;font</span> <span class="string">color=&quot;#5ea6e5&quot;&gt;koco-co.github.io&lt;/font&gt;&lt;/a&gt;&amp;nbsp;</span> <span class="string">&amp;nbsp;&lt;br&gt;---</span> <span class="string">备用域名</span> <span class="string">---&lt;br&gt;&lt;a</span> <span class="string">href=&quot;https://koco-co.github.io&quot;</span> <span class="string">title=&quot;此线路属于博客二级域名&quot;</span> <span class="string">class=&quot;anno_content&quot;&gt;&lt;font</span> <span class="string">color=&quot;#5ea6e5&quot;&gt;koco-co.github.io&lt;/font&gt;&lt;/a&gt;&lt;br&gt;---</span> <span class="string">自建服务地址</span> <span class="string">---&lt;br&gt;</span>  <span class="string">&lt;a</span> <span class="string">href=&quot;https://koco-co.github.io&quot;</span> <span class="string">title=&quot;发布ChemGPT</span> <span class="number">1.0</span><span class="string">&quot; class=&quot;</span><span class="string">anno_content&quot;&gt;&lt;font</span> <span class="string">color=&quot;#5ea6e5&quot;&gt;koco-co.github.io&lt;/font&gt;&lt;/a&gt;</span> <span class="string">&lt;br&gt;</span> <span class="string">&lt;a</span> <span class="string">href=&quot;https://koco-co.github.io&quot;</span> <span class="string">title=&quot;分子逆合成单步预测模型&quot;</span> <span class="string">class=&quot;anno_content&quot;&gt;&lt;font</span> <span class="string">color=&quot;#5ea6e5&quot;&gt;koco-co.github.io&lt;/font&gt;&lt;/a&gt;</span> <span class="string">&lt;br&gt;</span> <span class="string">&lt;a</span> <span class="string">href=&quot;https://koco-co.github.io&quot;</span> <span class="string">title=&quot;文件共享平台，如需使用，请联系博主&quot;</span> <span class="string">class=&quot;anno_content&quot;&gt;&lt;font</span> <span class="string">color=&quot;#5ea6e5&quot;&gt;koco-co.github.io&lt;/font&gt;&lt;/a&gt;&lt;/b&gt;&lt;/center&gt;</span></span><br></pre></td></tr></table></figure><h3 id="IP自适应欢迎语"><a href="#IP自适应欢迎语" class="headerlink" title="IP自适应欢迎语"></a>IP自适应欢迎语</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%25E6%25AC%25A2%25E8%25BF%258E%25E4%25BF%25A1%25E6%2581%25AF.png" alt="image-20260111131922360"></p><ol><li><p>获取<code>API Key</code>：进入<a href="https://lbs.qq.com/dev/console/application/mine">腾讯位置服务</a>应用管理界面，点击创建应用，应用名称和类型随便填。在新创建的应用中点击添加<code>key</code>，产品选择<code>WebServiceAPI</code>，域名白名单填自己的域名或不填。把得到的key记下。如果开启白名单记得把localhost也加上</p><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/ip%25E5%25AE%259A%25E4%25BD%258D%25E6%259C%258D%25E5%258A%25A1.png" alt="image-20260110212123787"></p></li><li><p>新建<code>[BlogRoot]\source\js\txmap.js</code>，并写入如下代码，记住替换key的内容：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* =====================================================</span></span><br><span class="line"><span class="comment"> * txmap.js - Tencent Map IP Welcome Script</span></span><br><span class="line"><span class="comment"> * ===================================================== */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== 可配置项（只需改这里） ========== */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">TXMAP_CONFIG</span> = &#123;</span><br><span class="line">    <span class="comment">// 腾讯位置服务 Key, Ref. https://lbs.qq.com/dev/console/application/mine</span></span><br><span class="line">    <span class="attr">TX_KEY</span>: <span class="string">&#x27;你的Key&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 站长坐标（经度, 纬度）, 高德平台获取, Ref. https://lbs.amap.com/tools/picker</span></span><br><span class="line">    <span class="attr">OWNER_LNG</span>: <span class="number">119.99</span>,</span><br><span class="line">    <span class="attr">OWNER_LAT</span>: <span class="number">30.30</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 站点昵称</span></span><br><span class="line">    <span class="attr">BLOG_NAME</span>: <span class="string">&#x27;Koco-co&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DOM 容器 ID</span></span><br><span class="line">    <span class="attr">CONTAINER_ID</span>: <span class="string">&#x27;welcome-info&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== 页面初始：先显示基础欢迎信息 ========== */</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">CONTAINER_ID</span>)) &#123;</span><br><span class="line">        <span class="title function_">showWelcome</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== IP 定位请求（JSONP） ========== */</span></span><br><span class="line"><span class="keyword">let</span> ipLoacation;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> $ === <span class="string">&#x27;undefined&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;https://apis.map.qq.com/ws/location/v1/ip&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">key</span>: <span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">TX_KEY</span>,</span><br><span class="line">                <span class="attr">output</span>: <span class="string">&#x27;jsonp&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span><br><span class="line">            <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">                ipLoacation = res;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">CONTAINER_ID</span>)) &#123;</span><br><span class="line">                    <span class="title function_">showWelcome</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// JSONP 失败时静默处理</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== 计算球面距离（公里） ========== */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDistance</span>(<span class="params">e1, n1, e2, n2</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> R = <span class="number">6371</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123;sin, cos, asin, <span class="variable constant_">PI</span>, hypot&#125; = <span class="title class_">Math</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="title function_">getPoint</span> = (<span class="params">e, n</span>) =&gt; &#123;</span><br><span class="line">        e *= <span class="variable constant_">PI</span> / <span class="number">180</span>;</span><br><span class="line">        n *= <span class="variable constant_">PI</span> / <span class="number">180</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">x</span>: <span class="title function_">cos</span>(n) * <span class="title function_">cos</span>(e),</span><br><span class="line">            <span class="attr">y</span>: <span class="title function_">cos</span>(n) * <span class="title function_">sin</span>(e),</span><br><span class="line">            <span class="attr">z</span>: <span class="title function_">sin</span>(n)</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> a = <span class="title function_">getPoint</span>(e1, n1);</span><br><span class="line">    <span class="keyword">let</span> b = <span class="title function_">getPoint</span>(e2, n2);</span><br><span class="line">    <span class="keyword">let</span> c = <span class="title function_">hypot</span>(a.<span class="property">x</span> - b.<span class="property">x</span>, a.<span class="property">y</span> - b.<span class="property">y</span>, a.<span class="property">z</span> - b.<span class="property">z</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="title function_">asin</span>(<span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="number">1</span>, c / <span class="number">2</span>)) * <span class="number">2</span> * R);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== 欢迎信息主函数（可重复安全调用） ========== */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showWelcome</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">CONTAINER_ID</span>);</span><br><span class="line">    <span class="keyword">if</span> (!el) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ===== 时间问候 ===== */</span></span><br><span class="line">    <span class="keyword">const</span> hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>();</span><br><span class="line">    <span class="keyword">let</span> timeChange =</span><br><span class="line">        hour &gt;= <span class="number">5</span> &amp;&amp; hour &lt; <span class="number">11</span> ? <span class="string">&#x27;&lt;span&gt;上午好&lt;/span&gt;，愿你今天一切顺利~~~&#x27;</span> :</span><br><span class="line">            hour &lt; <span class="number">13</span> ? <span class="string">&#x27;&lt;span&gt;中午好&lt;/span&gt;，记得按时吃饭哦~~~&#x27;</span> :</span><br><span class="line">                hour &lt; <span class="number">15</span> ? <span class="string">&#x27;&lt;span&gt;下午好&lt;/span&gt;，不妨小憩片刻~~~&#x27;</span> :</span><br><span class="line">                    hour &lt; <span class="number">16</span> ? <span class="string">&#x27;&lt;span&gt;三点多啦&lt;/span&gt;，喝点下午茶吧~~~&#x27;</span> :</span><br><span class="line">                        hour &lt; <span class="number">19</span> ? <span class="string">&#x27;&lt;span&gt;傍晚好&lt;/span&gt;，愿你收获满满~~~&#x27;</span> :</span><br><span class="line">                            hour &lt; <span class="number">24</span> ? <span class="string">&#x27;&lt;span&gt;晚上好&lt;/span&gt;，放松一下吧~~~&#x27;</span> :</span><br><span class="line">                                <span class="string">&#x27;夜深了，记得早点休息~~~&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">/* ===== 有 IP 信息（增强展示） ===== */</span></span><br><span class="line">        <span class="keyword">if</span> (ipLoacation &amp;&amp; ipLoacation.<span class="property">status</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> info = ipLoacation.<span class="property">result</span>;</span><br><span class="line">            <span class="keyword">const</span> ad = info.<span class="property">ad_info</span> || &#123;&#125;;</span><br><span class="line">            <span class="keyword">const</span> loc = info.<span class="property">location</span> || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> dist = <span class="title function_">getDistance</span>(</span><br><span class="line">                <span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">OWNER_LNG</span>,</span><br><span class="line">                <span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">OWNER_LAT</span>,</span><br><span class="line">                loc.<span class="property">lng</span>,</span><br><span class="line">                loc.<span class="property">lat</span></span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> pos = ad.<span class="property">nation</span> || <span class="string">&#x27;未知地区&#x27;</span>;</span><br><span class="line">            <span class="keyword">let</span> ip = info.<span class="property">ip</span> || <span class="string">&#x27;未知 IP&#x27;</span>;</span><br><span class="line">            <span class="keyword">let</span> posdesc = <span class="string">&#x27;感谢你的到来，愿你有所收获。&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* ===== 国家 / 地区文案 ===== */</span></span><br><span class="line">            <span class="keyword">switch</span> (ad.<span class="property">nation</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;日本&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;よろしく，一起去看樱花吗？&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;美国&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;May peace be with you.&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;英国&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;想与你夜乘伦敦眼。&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;俄罗斯&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;干了这杯伏特加！&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;法国&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;C&#x27;est la vie.&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;德国&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;Die Zeit verging im Fluge.&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;澳大利亚&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;一起去大堡礁看看吧！&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;加拿大&#x27;</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;拾一片枫叶赠予你。&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;中国&#x27;</span>:</span><br><span class="line">                    pos = [ad.<span class="property">province</span>, ad.<span class="property">city</span>, ad.<span class="property">district</span>].<span class="title function_">filter</span>(<span class="title class_">Boolean</span>).<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                    posdesc = <span class="title function_">getChinaDesc</span>(ad);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="attr">default</span>:</span><br><span class="line">                    posdesc = <span class="string">&#x27;世界很大，感谢你的到来。&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            el.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">                &lt;b&gt;</span></span><br><span class="line"><span class="string">                    &lt;center&gt;🎉 欢迎信息 🎉&lt;/center&gt;</span></span><br><span class="line"><span class="string">                    欢迎来自</span></span><br><span class="line"><span class="string">                    &lt;span style=&quot;color:var(--theme-color)&quot;&gt;<span class="subst">$&#123;pos&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    的朋友，<span class="subst">$&#123;timeChange&#125;</span></span></span><br><span class="line"><span class="string">                    &lt;br&gt;</span></span><br><span class="line"><span class="string">                    你当前距离</span></span><br><span class="line"><span class="string">                    &lt;span style=&quot;color:var(--theme-color)&quot;&gt;<span class="subst">$&#123;TXMAP_CONFIG.BLOG_NAME&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    约</span></span><br><span class="line"><span class="string">                    &lt;span style=&quot;color:var(--theme-color)&quot;&gt;<span class="subst">$&#123;dist&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    公里，</span></span><br><span class="line"><span class="string">                    IP 地址：</span></span><br><span class="line"><span class="string">                    &lt;span style=&quot;color:var(--theme-color)&quot;&gt;<span class="subst">$&#123;ip&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;br&gt;</span></span><br><span class="line"><span class="string">                    <span class="subst">$&#123;posdesc&#125;</span></span></span><br><span class="line"><span class="string">                &lt;/b&gt;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* ===== 无 IP 信息（基础展示） ===== */</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            el.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">                &lt;b&gt;</span></span><br><span class="line"><span class="string">                    &lt;center&gt;🎉 欢迎信息 🎉&lt;/center&gt;</span></span><br><span class="line"><span class="string">                    欢迎来到</span></span><br><span class="line"><span class="string">                    &lt;span style=&quot;color:var(--theme-color)&quot;&gt;<span class="subst">$&#123;TXMAP_CONFIG.BLOG_NAME&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    的小窝，<span class="subst">$&#123;timeChange&#125;</span></span></span><br><span class="line"><span class="string">                &lt;/b&gt;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        el.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">            &lt;b&gt;</span></span><br><span class="line"><span class="string">                &lt;center&gt;🎉 欢迎信息 🎉&lt;/center&gt;</span></span><br><span class="line"><span class="string">                欢迎来到</span></span><br><span class="line"><span class="string">                &lt;span style=&quot;color:var(--theme-color)&quot;&gt;<span class="subst">$&#123;TXMAP_CONFIG.BLOG_NAME&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                的小窝，<span class="subst">$&#123;timeChange&#125;</span></span></span><br><span class="line"><span class="string">            &lt;/b&gt;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== 中国地区文案拆分（便于维护） ========== */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getChinaDesc</span>(<span class="params">ad</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> map = &#123;</span><br><span class="line">        <span class="string">&#x27;北京市&#x27;</span>: <span class="string">&#x27;北——京——欢迎你。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;天津市&#x27;</span>: <span class="string">&#x27;来段相声助助兴。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;河北省&#x27;</span>: <span class="string">&#x27;山河壮丽，天下雄关。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;山西省&#x27;</span>: <span class="string">&#x27;表里山河，晋善晋美。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;内蒙古自治区&#x27;</span>: <span class="string">&#x27;天苍苍，野茫茫。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;辽宁省&#x27;</span>: <span class="string">&#x27;安排一顿地道烧烤吧。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;吉林省&#x27;</span>: <span class="string">&#x27;白山黑水，热情豪爽。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;黑龙江省&#x27;</span>: <span class="string">&#x27;冰城的冬天很浪漫。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;上海市&#x27;</span>: <span class="string">&#x27;欢迎来到魔都。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;浙江省&#x27;</span>: <span class="string">&#x27;诗画江南，山水如梦。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;江苏省&#x27;</span>: <span class="string">&#x27;上有天堂，下有苏杭。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;安徽省&#x27;</span>: <span class="string">&#x27;蚌埠住了，芜湖起飞。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;福建省&#x27;</span>: <span class="string">&#x27;山海相逢，风景正好。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;江西省&#x27;</span>: <span class="string">&#x27;落霞与孤鹜齐飞。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;山东省&#x27;</span>: <span class="string">&#x27;齐鲁大地，礼仪之邦。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;湖北省&#x27;</span>: <span class="string">&#x27;来碗热干面吧。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;湖南省&#x27;</span>: <span class="string">&#x27;辣得过瘾，吃得开心。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;广东省&#x27;</span>: <span class="string">&#x27;饮茶先啦。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;广西壮族自治区&#x27;</span>: <span class="string">&#x27;桂林山水甲天下。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;海南省&#x27;</span>: <span class="string">&#x27;面朝大海，春暖花开。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;四川省&#x27;</span>: <span class="string">&#x27;巴适得板。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;贵州省&#x27;</span>: <span class="string">&#x27;山水秘境，醇香四溢。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;云南省&#x27;</span>: <span class="string">&#x27;彩云之南，风景如画。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;陕西省&#x27;</span>: <span class="string">&#x27;来碗臊子面。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;甘肃省&#x27;</span>: <span class="string">&#x27;大漠孤烟直。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;青海省&#x27;</span>: <span class="string">&#x27;天地辽阔，心亦澄明。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;宁夏回族自治区&#x27;</span>: <span class="string">&#x27;塞上江南。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;新疆维吾尔自治区&#x27;</span>: <span class="string">&#x27;丝路古道，热情豪迈。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;台湾省&#x27;</span>: <span class="string">&#x27;海峡两岸，血脉相连。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;香港特别行政区&#x27;</span>: <span class="string">&#x27;东方之珠。&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;澳门特别行政区&#x27;</span>: <span class="string">&#x27;风情万种的小城。&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> map[ad.<span class="property">province</span>] || <span class="string">&#x27;欢迎来自这片热土的朋友。&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ========== PJAX 支持 ========== */</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="variable constant_">TXMAP_CONFIG</span>.<span class="property">CONTAINER_ID</span>)) &#123;</span><br><span class="line">            <span class="title function_">showWelcome</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>[BlogRoot]\_config.butterfly.yml</code>中引入jQuery依赖和刚刚的js文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span> </span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># jQuery</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/txmap.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># 腾讯位置API</span></span><br></pre></td></tr></table></figure></li><li><p>在需要展示文本的容器上添加相应id（welcome-info）就可以了，例如我想添加在网站公告栏信息的下方，于是就在<code>[BlogRoot]\themes\butterfly\layout\includes\widget\card_announcement.pug</code>的最后一行加上这个，缩进与上一行相同即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if theme.aside.card_announcement.enable</span><br><span class="line">    .card-widget.card-announcement</span><br><span class="line">        .item-headline</span><br><span class="line">            i.fas.fa-bullhorn.fa-shake</span><br><span class="line">            span= _p(&#x27;aside.card_announcement&#x27;)</span><br><span class="line">        .announcement_content!= theme.aside.card_announcement.content</span><br><span class="line">        // 添加欢迎访客的信息</span><br><span class="line">        #welcome-info</span><br></pre></td></tr></table></figure></li><li><p>在<code>custom.css</code>自定义样式里添加如下代码，可以根据你自己的喜好去改</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 欢迎信息 */</span></span><br><span class="line"><span class="selector-id">#welcome-info</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, <span class="number">#b9f4f3</span>, <span class="number">#e3fbf9</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#welcome-info</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#212121</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>hexo二连即可看到效果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol><h3 id="页脚自定义"><a href="#页脚自定义" class="headerlink" title="页脚自定义"></a>页脚自定义</h3><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-%E9%A1%B5%E8%84%9A%E7%BE%8E%E5%8C%96.png" alt="image-20260111122345536"></p><blockquote><p>添加各种小徽标, 找到<code>_config.butterfly.yml</code> 文件的 <code>footer</code> 部分，更改 <code>custom_text</code></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">footer:</span>  </span><br><span class="line">  <span class="attr">copyright:</span></span><br><span class="line">    <span class="comment"># 是否显示版权信息</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># 是否显示版本号</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="string">|-</span></span><br><span class="line"><span class="string">    &lt;div style=&quot;font-size: 14px; line-height: 1.6; color: #666; margin-bottom: 20px;&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;&lt;strong&gt;免责声明&lt;/strong&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;本站发布的内容仅供学习和研究使用，禁止用于商业或非法用途。若因违规使用导致任何后果，均由用户自行承担。&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;请在下载后24小时内彻底删除相关文件。访问即表示您同意本声明条款。&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;部分资源来自互联网，如有侵权或不妥之处，请联系站长处理。&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="string">&lt;div</span> <span class="string">style=&quot;text-align:</span> <span class="string">center;</span> <span class="attr">font-size:</span> <span class="string">13px;</span> <span class="attr">color:</span> <span class="comment">#888; margin-top: 15px;&quot;&gt;</span></span><br><span class="line">      <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">href=&quot;https://hexo.io/&quot;&gt;&lt;img</span> <span class="string">src=&quot;https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo&quot;</span> <span class="string">title=&quot;博客框架为Hexo&quot;&gt;&lt;/a&gt;&amp;nbsp;</span></span><br><span class="line">      <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">href=&quot;https://butterfly.js.org/&quot;&gt;&lt;img</span> <span class="string">src=&quot;https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender&quot;</span> <span class="string">title=&quot;主题采用Butterfly&quot;&gt;&lt;/a&gt;&amp;nbsp;</span></span><br><span class="line">      <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">href=&quot;https://www.jsdelivr.com/&quot;&gt;&lt;img</span> <span class="string">src=&quot;https://img.shields.io/badge/CDN-jsDelivr-5a46a4?style=flat&amp;logo=jsdelivr&quot;</span> <span class="string">title=&quot;本站使用jsDelivr为静态资源提供CDN加速&quot;&gt;&lt;/a&gt;&amp;nbsp;</span></span><br><span class="line">      <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">href=&quot;https://github.com/&quot;&gt;&lt;img</span> <span class="string">src=&quot;https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub&quot;</span> <span class="string">title=&quot;本站项目由GitHub托管&quot;&gt;&lt;/a&gt;&amp;nbsp;</span></span><br><span class="line">      <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">href=&quot;http://creativecommons.org/licenses/by-nc-sa/4.0/&quot;&gt;&lt;img</span> <span class="string">src=&quot;https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris&quot;</span> <span class="string">title=&quot;本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可&quot;&gt;&lt;/a&gt;</span></span><br><span class="line">    <span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><h3 id="FPS信息"><a href="#FPS信息" class="headerlink" title="FPS信息"></a>FPS信息</h3><ol><li><p>新建文件<code>[BlogRoot]\source\js\fps.js</code>并写入如下代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;fpson&quot;</span>) == <span class="literal">undefined</span> || <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;fpson&quot;</span>) == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> rAF = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span> ||</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span> ||</span><br><span class="line">            <span class="keyword">function</span> (<span class="params">callback</span>) &#123;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(callback, <span class="number">1000</span> / <span class="number">60</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;();</span><br><span class="line">    <span class="keyword">var</span> frame = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> allFrameCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> lastTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">var</span> lastFameTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">var</span> loop = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        <span class="keyword">var</span> fs = (now - lastFameTime);</span><br><span class="line">        <span class="keyword">var</span> fps = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="number">1000</span> / fs);</span><br><span class="line"></span><br><span class="line">        lastFameTime = now;</span><br><span class="line">        <span class="comment">// 不置 0，在动画的开头及结尾记录此值的差值算出 FPS</span></span><br><span class="line">        allFrameCount++;</span><br><span class="line">        frame++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (now &gt; <span class="number">1000</span> + lastTime) &#123;</span><br><span class="line">            <span class="keyword">var</span> fps = <span class="title class_">Math</span>.<span class="title function_">round</span>((frame * <span class="number">1000</span>) / (now - lastTime));</span><br><span class="line">            <span class="keyword">if</span> (fps &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#bd0000&quot;&gt;卡成ppt🤢&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt;= <span class="number">15</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:red&quot;&gt;电竞级帧率😖&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt;= <span class="number">25</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:orange&quot;&gt;有点难受😨&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt; <span class="number">35</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#9338e6&quot;&gt;不太流畅🙄&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt;= <span class="number">45</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#08b7e4&quot;&gt;还不错哦😁&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#39c5bb&quot;&gt;十分流畅🤣&lt;/span&gt;`</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;fps&quot;</span>).<span class="property">innerHTML</span> = <span class="string">`FPS:<span class="subst">$&#123;fps&#125;</span> <span class="subst">$&#123;kd&#125;</span>`</span>;</span><br><span class="line">            frame = <span class="number">0</span>;</span><br><span class="line">            lastTime = now;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">rAF</span>(loop);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">loop</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;fps&quot;</span>).<span class="property">style</span> = <span class="string">&quot;display:none!important&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在自定义样式文件<code>custom.css</code>中加入如下代码，我这里让这块东西在左下角，你可以自己指定位置，其中<code>backdrop-filter</code>过滤器也可以自己指定，也可以不要：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 帧率检测 */</span></span><br><span class="line"><span class="selector-id">#fps</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="comment">/* 指定位置 */</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1919810</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#fps</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.85</span>);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#fps</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.72</span>);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在主题配置文件<code>_config.butterfly.yml</code>文件中加入以下代码：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span> </span><br><span class="line">  <span class="attr">head:</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">&lt;span</span> <span class="string">id=&quot;fps&quot;&gt;&lt;/span&gt;</span> <span class="comment"># 帧率检测</span></span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line"><span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/fps.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># 帧率检测</span></span><br></pre></td></tr></table></figure></li><li><p>重启项目看看角落有没有出现帧率块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Butterfly Docs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
            <tag> Theme </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github文档(二) 博客搭建</title>
      <link href="/posts/beec4250/"/>
      <url>/posts/beec4250/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Hexo 是一个快速、简洁且高效的静态博客框架, 基于 Node.js 构建. 它支持 Markdown 语法, 可以通过插件快速扩展功能, 并能一键部署到 GitHub Pages、Vercel、Netlify 等平台.</p><div class="note success flat"><p>本指南将详细介绍如何使用 Hexo 搭建个人博客，配置 Butterfly 主题，并通过 GitHub Actions 实现自动部署.</p></div><a class="btn-beautify outline blue" href="https://hexo.io/zh-cn/docs/" title="Hexo 官方文档"><i class="fas fa-book"></i><span>Hexo 官方文档</span></a><a class="btn-beautify outline purple" href="https://butterfly.js.org/" title="Butterfly 主题文档"><i class="fas fa-palette"></i><span>Butterfly 主题文档</span></a><div class="note info flat"><p><strong>选择 Hexo 的原因</strong>: 生成速度快(100+ 文章只需几秒)、插件生态丰富、部署简单、主题支持多</p></div><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>在开始之前，请确保你的电脑已经安装以下工具:</p><h3 id="安装-Node-js"><a href="#安装-Node-js" class="headerlink" title="安装 Node.js"></a>安装 Node.js</h3><p>Hexo 基于 Node.js 运行，需要先安装 Node.js 环境.</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fab fa-linux"></i>Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 Homebrew 安装</span></span><br><span class="line">brew install node</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 winget 安装</span></span><br><span class="line">winget install OpenJS.NodeJS.LTS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或访问官网下载安装包</span></span><br><span class="line"><span class="comment"># https://nodejs.org/</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install nodejs npm</span><br><span class="line"></span><br><span class="line"><span class="comment"># CentOS/RHEL</span></span><br><span class="line"><span class="built_in">sudo</span> yum install nodejs npm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><div class="note warning flat"><p>推荐 Node.js 版本 &gt;= 16.x，npm 版本 &gt;= 8.x 以确保兼容性</p></div><h3 id="安装-Git"><a href="#安装-Git" class="headerlink" title="安装 Git"></a>安装 Git</h3><p>Git 用于版本管理和代码部署.</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fab fa-linux"></i>Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># macOS 通常自带 Git, 或使用 Homebrew 安装</span></span><br><span class="line">brew install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">git --version</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 winget 安装</span></span><br><span class="line">winget install Git.Git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或访问官网下载安装包</span></span><br><span class="line"><span class="comment"># https://git-scm.com/download/win</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian</span></span><br><span class="line"><span class="built_in">sudo</span> apt install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># CentOS/RHEL</span></span><br><span class="line"><span class="built_in">sudo</span> yum install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">git --version</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="配置-Git-首次使用"><a href="#配置-Git-首次使用" class="headerlink" title="配置 Git (首次使用)"></a>配置 Git (首次使用)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置用户名和邮箱</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;your.email@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看配置</span></span><br><span class="line">git config --list</span><br></pre></td></tr></table></figure><a class="btn-beautify outline green" href="https://git-scm.com/doc" title="Git 官方文档"><i class="fas fa-external-link-alt"></i><span>Git 官方文档</span></a><h2 id="安装-Hexo-框架"><a href="#安装-Hexo-框架" class="headerlink" title="安装 Hexo 框架"></a>安装 Hexo 框架</h2><h3 id="全局安装-Hexo-CLI"><a href="#全局安装-Hexo-CLI" class="headerlink" title="全局安装 Hexo-CLI"></a>全局安装 Hexo-CLI</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局安装 Hexo 命令行工具</span></span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">hexo version</span><br></pre></td></tr></table></figure><h3 id="创建博客项目"><a href="#创建博客项目" class="headerlink" title="创建博客项目"></a>创建博客项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建项目目录</span></span><br><span class="line">hexo init hexo-blog</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 进入项目目录</span></span><br><span class="line"><span class="built_in">cd</span> hexo-blog</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 安装项目依赖</span></span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 安装核心插件</span></span><br><span class="line"><span class="comment"># Git 部署插件 - 用于部署到 GitHub Pages</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># 渲染器插件 - Butterfly 主题必需</span></span><br><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 本地运行预览</span></span><br><span class="line">hexo server</span><br><span class="line"><span class="comment"># 或简写为</span></span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>访问 <code>http://localhost:4000</code> 即可查看默认的 Hexo 博客.</p><details class="folding-tag" cyan><summary> 📁 项目目录结构 </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hexo-blog/</span><br><span class="line">├── _config.yml                 # Hexo 主配置文件</span><br><span class="line">├── _config.butterfly.yml       # Butterfly 主题配置文件(需手动创建)</span><br><span class="line">├── package.json                # 依赖管理</span><br><span class="line">├── source/                     # 源文件目录</span><br><span class="line">│   ├── _posts/                # Markdown 文章存放处</span><br><span class="line">│   └── img/                   # 图片资源</span><br><span class="line">├── themes/                     # 主题目录</span><br><span class="line">│   └── butterfly/             # Butterfly 主题</span><br><span class="line">├── public/                     # 生成的静态文件(执行 hexo g 后生成)</span><br><span class="line">└── node_modules/               # npm 依赖</span><br></pre></td></tr></table></figure>              </div>            </details><a class="btn-beautify outline blue" href="https://hexo.io/zh-cn/docs/setup" title="Hexo 安装文档"><i class="fas fa-book"></i><span>Hexo 安装文档</span></a><h2 id="创建-GitHub-Pages-仓库"><a href="#创建-GitHub-Pages-仓库" class="headerlink" title="创建 GitHub Pages 仓库"></a>创建 GitHub Pages 仓库</h2><h3 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h3><ol><li>访问 <a href="https://github.com">GitHub</a> 并登录</li><li>点击右上角 <code>+</code> → <code>New repository</code></li><li>设置仓库信息:</li></ol><div class="table-container"><table><thead><tr><th>配置项</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>Repository name</td><td><code>$&#123;用户名&#125;.github.io</code></td><td>必须使用此格式</td></tr><tr><td>Description</td><td>Personal Blog</td><td>可选</td></tr><tr><td>Public/Private</td><td>Public</td><td>Public 才能使用免费 GitHub Pages</td></tr><tr><td>Initialize</td><td>添加 README/ .gitignore</td><td>可选</td></tr></tbody></table></div><ol><li>点击 <code>Create repository</code></li></ol><h3 id="配置分支"><a href="#配置分支" class="headerlink" title="配置分支"></a>配置分支</h3><p>GitHub Pages 默认支持以下分支:</p><div class="table-container"><table><thead><tr><th>分支名</th><th>目录</th><th>说明</th></tr></thead><tbody><tr><td><code>main</code></td><td><code>/ (root)</code></td><td>推荐使用</td></tr><tr><td><code>gh-pages</code></td><td><code>/ (root)</code></td><td>传统方式</td></tr><tr><td><code>main</code></td><td><code>/docs</code></td><td>文档项目使用</td></tr></tbody></table></div><div class="note info flat"><p>新建仓库默认分支为 <code>main</code>，无需额外配置</p></div><a class="btn-beautify outline gray" href="https://docs.github.com/en/pages" title="GitHub Pages 官方文档"><i class="fab fa-github"></i><span>GitHub Pages 官方文档</span></a><h2 id="配置-Hexo-框架"><a href="#配置-Hexo-框架" class="headerlink" title="配置 Hexo 框架"></a>配置 Hexo 框架</h2><p>编辑根目录下的 <code>_config.yml</code> 文件:</p><details class="folding-tag" green><summary> ⚙️ Hexo 配置文件 </summary>              <div class='content'>              <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Site 网站信息</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">My</span> <span class="string">Blog</span>              <span class="comment"># 网站标题</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">技术成长记录</span>      <span class="comment"># 网站副标题</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">分享技术心得</span>   <span class="comment"># 网站描述</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">Hexo,</span> <span class="string">Butterfly</span>   <span class="comment"># 关键词</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Your</span> <span class="string">Name</span>           <span class="comment"># 作者名</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span>             <span class="comment"># 语言</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span>     <span class="comment"># 时区</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># URL 网站地址</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://$&#123;用户名&#125;.github.io</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Directory 目录设置</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Writing 写作设置</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">external_link:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span>  <span class="comment"># 设为 true 可为每篇文章创建资源文件夹</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">syntax_highlighter:</span> <span class="string">highlight.js</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Category &amp; Directory 分类 &amp; 标签</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Date / Time format 日期格式</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Pagination 分页</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Extensions 扩展</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Deployment 部署配置</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/$&#123;用户名&#125;/$&#123;用户名&#125;.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line">  <span class="attr">message: Site updated:</span> &#123;&#123; <span class="string">now(&#x27;YYYY-MM-DD</span> <span class="string">HH:mm:ss&#x27;)</span> &#125;&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><div class="note warning flat"><p>配置文件使用 YAML 格式，注意冒号后要有空格，缩进使用空格而非 Tab</p></div><h2 id="安装配置-Butterfly-主题"><a href="#安装配置-Butterfly-主题" class="headerlink" title="安装配置 Butterfly 主题"></a>安装配置 Butterfly 主题</h2><p>Butterfly 是一款美观、功能丰富的 Hexo 主题，支持响应式设计、暗黑模式、代码高亮、多种评论系统等.</p><a class="btn-beautify outline purple" href="https://butterfly.js.org/posts/21cfbf15/" title="Butterfly 主题文档"><i class="fas fa-palette"></i><span>Butterfly 主题文档</span></a><h3 id="安装主题"><a href="#安装主题" class="headerlink" title="安装主题"></a>安装主题</h3><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">Git 克隆 (推荐)</button><button type="button" class="tab">NPM 安装</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在博客根目录执行</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-theme-butterfly</span><br></pre></td></tr></table></figure><div class="note info flat"><p>适用于 Hexo &gt;= 5.0</p></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="启用主题"><a href="#启用主题" class="headerlink" title="启用主题"></a>启用主题</h3><p>编辑 <code>_config.yml</code>，修改主题设置:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br></pre></td></tr></table></figure><h3 id="创建主题配置文件"><a href="#创建主题配置文件" class="headerlink" title="创建主题配置文件"></a>创建主题配置文件</h3><p>复制主题默认配置到博客根目录:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> themes/butterfly/_config.yml _config.butterfly.yml</span><br></pre></td></tr></table></figure><div class="note success flat"><p>后续修改主题配置都在 <code>_config.butterfly.yml</code> 中进行，主题更新时不会覆盖此文件</p></div><h3 id="基础配置示例"><a href="#基础配置示例" class="headerlink" title="基础配置示例"></a>基础配置示例</h3><details class="folding-tag" blue><summary> 🎨 Butterfly 主题配置 </summary>              <div class='content'>              <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Image 图片设置</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br><span class="line"></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/avatar.png</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Top_img 顶部图</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">index_img:</span></span><br><span class="line">  <span class="comment"># 可设置默认首页顶部图</span></span><br><span class="line">  <span class="comment"># 或在文章 Front Matter 中单独设置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Navigation 导航栏</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">nav:</span></span><br><span class="line">  <span class="attr">logo:</span> <span class="comment"># /img/logo.png</span></span><br><span class="line">  <span class="attr">display_title:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">fixed:</span> <span class="literal">false</span>  <span class="comment"># 固定导航栏</span></span><br><span class="line"></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">首页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="string">关于:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-user</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Code Blocks 代码块</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">code_blocks:</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">darker</span>  <span class="comment"># darker/pale night/light/ocean/false</span></span><br><span class="line">  <span class="attr">macStyle:</span> <span class="literal">true</span>  <span class="comment"># macOS 风格窗口控件</span></span><br><span class="line">  <span class="attr">height_limit:</span> <span class="number">300</span>  <span class="comment"># 高度限制, 超出折叠</span></span><br><span class="line">  <span class="attr">word_wrap:</span> <span class="literal">false</span>  <span class="comment"># 代码换行</span></span><br><span class="line">  <span class="attr">copy:</span> <span class="literal">true</span>  <span class="comment"># 复制按钮</span></span><br><span class="line">  <span class="attr">language:</span> <span class="literal">true</span>  <span class="comment"># 显示语言</span></span><br><span class="line">  <span class="attr">shrink:</span> <span class="literal">false</span>  <span class="comment"># 代码块折叠</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span>  <span class="comment"># 全屏按钮</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Social Settings 社交设置</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">fab fa-github:</span> <span class="string">https://github.com/$&#123;用户名&#125;</span> <span class="string">||</span> <span class="string">Github</span></span><br><span class="line">  <span class="attr">fas fa-envelope:</span> <span class="string">mailto:your.email@example.com</span> <span class="string">||</span> <span class="string">Email</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Footer 页脚</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">owner:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">since:</span> <span class="number">2024</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="string">Hi,</span> <span class="string">welcome</span> <span class="string">to</span> <span class="string">my</span> <span class="string">blog!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Comments 评论区</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">Waline</span>  <span class="comment"># 可选: Waline, Disqus, Gitalk, Twikoo 等</span></span><br><span class="line">  <span class="attr">text:</span> <span class="literal">true</span>  <span class="comment"># 显示评论按钮文案</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">count:</span> <span class="literal">true</span>  <span class="comment"># 评论数统计</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="主题更新"><a href="#主题更新" class="headerlink" title="主题更新"></a>主题更新</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/butterfly</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><div class="note info flat"><p>如使用 npm 安装，执行 <code>npm update hexo-theme-butterfly</code> 更新</p></div><h2 id="Hexo-常用命令"><a href="#Hexo-常用命令" class="headerlink" title="Hexo 常用命令"></a>Hexo 常用命令</h2><h3 id="核心命令"><a href="#核心命令" class="headerlink" title="核心命令"></a>核心命令</h3><details class="folding-tag" default><summary> 📝 Hexo 命令参考 </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># 创建文章</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line">hexo new <span class="string">&quot;<span class="variable">$&#123;文章标题&#125;</span>&quot;</span></span><br><span class="line"><span class="comment"># 生成文件到 source/_posts/$&#123;文章标题&#125;.md</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建草稿</span></span><br><span class="line">hexo new draft <span class="string">&quot;<span class="variable">$&#123;草稿标题&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># 本地预览</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line">hexo clean     <span class="comment"># 清除缓存和静态文件</span></span><br><span class="line">hexo generate  <span class="comment"># 生成静态文件(可简写为 hexo g)</span></span><br><span class="line">hexo server    <span class="comment"># 启动本地服务器(可简写为 hexo s)</span></span><br><span class="line"><span class="comment"># 组合命令:</span></span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># 部署到 GitHub</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line">hexo clean        <span class="comment"># 清理缓存</span></span><br><span class="line">hexo generate     <span class="comment"># 生成静态文件</span></span><br><span class="line">hexo deploy       <span class="comment"># 部署到 GitHub(可简写为 hexo d)</span></span><br><span class="line"><span class="comment"># 组合命令:</span></span><br><span class="line">hexo clean &amp;&amp; hexo g -d  <span class="comment"># g -d 等价于 generate &amp;&amp; deploy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># 其他命令</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line">hexo list          <span class="comment"># 列出所有文章/页面/路由</span></span><br><span class="line">hexo version       <span class="comment"># 查看 Hexo 版本信息</span></span><br><span class="line">hexo --<span class="built_in">help</span>        <span class="comment"># 查看帮助</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="命令对比"><a href="#命令对比" class="headerlink" title="命令对比"></a>命令对比</h3><div class="table-container"><table><thead><tr><th>命令</th><th>简写</th><th>说明</th><th>使用场景</th></tr></thead><tbody><tr><td><code>hexo generate</code></td><td><code>hexo g</code></td><td>生成静态文件到 <code>public/</code></td><td>每次修改后执行</td></tr><tr><td><code>hexo server</code></td><td><code>hexo s</code></td><td>启动本地服务器</td><td>本地预览</td></tr><tr><td><code>hexo deploy</code></td><td><code>hexo d</code></td><td>部署到配置的 Git 仓库</td><td>发布文章</td></tr><tr><td><code>hexo clean</code></td><td>无</td><td>删除缓存和静态文件</td><td>遇到奇怪问题时</td></tr></tbody></table></div><div class="note success flat"><p><strong>推荐工作流</strong>:</p><ol><li>写文章 → <code>hexo new &quot;文章标题&quot;</code></li><li>编辑 Markdown → <code>source/_posts/文章标题.md</code></li><li>本地预览 → <code>hexo clean &amp;&amp; hexo s</code></li><li>部署发布 → <code>hexo clean &amp;&amp; hexo g -d</code></li></ol></div><a class="btn-beautify outline blue" href="https://hexo.io/zh-cn/docs/commands" title="Hexo 命令文档"><i class="fas fa-terminal"></i><span>Hexo 命令文档</span></a><h2 id="自动部署-GitHub-Actions"><a href="#自动部署-GitHub-Actions" class="headerlink" title="自动部署: GitHub Actions"></a>自动部署: GitHub Actions</h2><h3 id="为什么使用-GitHub-Actions"><a href="#为什么使用-GitHub-Actions" class="headerlink" title="为什么使用 GitHub Actions"></a>为什么使用 GitHub Actions</h3><div class="table-container"><table><thead><tr><th>对比项</th><th><code>hexo deploy</code></th><th>GitHub Actions</th></tr></thead><tbody><tr><td>部署位置</td><td><code>public/</code> → 仓库 A</td><td>源码仓库 B → Pages 仓库 A</td></tr><tr><td>源码备份</td><td>需手动备份</td><td>自动备份</td></tr><tr><td>多机器协作</td><td>困难</td><td>简单</td></tr><tr><td>自动化程度</td><td>手动执行</td><td>自动触发</td></tr></tbody></table></div><div class="note primary flat"><p><strong>推荐方案</strong>: 使用两个仓库</p><ul><li><code>${用户名}.github.io</code> - 静态博客(只读)</li><li><code>hexo-blog-source</code> - 源码仓库(主仓库)</li></ul></div><h3 id="配置-GitHub-Actions"><a href="#配置-GitHub-Actions" class="headerlink" title="配置 GitHub Actions"></a>配置 GitHub Actions</h3><h4 id="1-创建源码仓库"><a href="#1-创建源码仓库" class="headerlink" title="1. 创建源码仓库"></a>1. 创建源码仓库</h4><p>创建 <code>hexo-blog-source</code> 仓库，推送当前项目:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化 Git 仓库</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加 .gitignore</span></span><br><span class="line"><span class="built_in">cat</span> &gt; .gitignore &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">node_modules/</span></span><br><span class="line"><span class="string">public/</span></span><br><span class="line"><span class="string">.deploy_git/</span></span><br><span class="line"><span class="string">db.json</span></span><br><span class="line"><span class="string">*.log</span></span><br><span class="line"><span class="string">.DS_Store</span></span><br><span class="line"><span class="string">Thumbs.db</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交初始代码</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加远程仓库</span></span><br><span class="line">git remote add origin https://github.com/<span class="variable">$&#123;用户名&#125;</span>/hexo-blog-source.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送到 GitHub</span></span><br><span class="line">git branch -M main</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><h4 id="2-创建-Actions-工作流"><a href="#2-创建-Actions-工作流" class="headerlink" title="2. 创建 Actions 工作流"></a>2. 创建 Actions 工作流</h4><p>创建 <code>.github/workflows/deploy.yml</code>:</p><details class="folding-tag" purple><summary> 🚀 GitHub Actions 配置 </summary>              <div class='content'>              <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span>  <span class="comment"># 当推送到 main 分支时触发</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span>  <span class="comment"># 支持手动触发</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># 1. 检出代码</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">fetch-depth:</span> <span class="number">0</span>  <span class="comment"># 获取完整历史记录</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 2. 设置 Node.js 环境</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node.js</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;20&#x27;</span>  <span class="comment"># 使用 LTS 版本</span></span><br><span class="line">          <span class="attr">cache:</span> <span class="string">&#x27;npm&#x27;</span>  <span class="comment"># 缓存 npm 依赖</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 3. 安装依赖</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm ci  # 比 npm install 更快更可靠</span></span><br><span class="line"><span class="string">          npm install -g hexo-cli</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="comment"># 4. 生成静态文件</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">static</span> <span class="string">files</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="comment"># 5. 部署到 GitHub Pages</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">publish_dir:</span> <span class="string">./public</span>  <span class="comment"># 部署 public 目录</span></span><br><span class="line">          <span class="attr">publish_branch:</span> <span class="string">main</span>  <span class="comment"># 部署到目标仓库的 main 分支</span></span><br><span class="line">          <span class="comment"># 以下配置用于部署到不同仓库</span></span><br><span class="line">          <span class="comment"># repository_name: $&#123;用户名&#125;/$&#123;用户名&#125;.github.io</span></span><br><span class="line">          <span class="comment"># user_name: github-actions[bot]</span></span><br><span class="line">          <span class="comment"># user_email: github-actions[bot]@users.noreply.github.com</span></span><br><span class="line">          <span class="comment"># commit_message: $&#123;&#123; github.event.head_commit.message &#125;&#125;</span></span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="3-配置-GitHub-Pages"><a href="#3-配置-GitHub-Pages" class="headerlink" title="3. 配置 GitHub Pages"></a>3. 配置 GitHub Pages</h4><p>在 <code>$&#123;用户名&#125;.github.io</code> 仓库中:</p><ol><li>进入 <code>Settings</code> → <code>Pages</code></li><li>Source 选择 <code>GitHub Actions</code></li></ol><h4 id="4-配置-Secrets-跨仓库部署"><a href="#4-配置-Secrets-跨仓库部署" class="headerlink" title="4. 配置 Secrets(跨仓库部署)"></a>4. 配置 Secrets(跨仓库部署)</h4><p>如果源码和 Pages 在不同仓库，需要配置部署密钥:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在本地生成 SSH 密钥</span></span><br><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;<span class="variable">$&#123;用户名&#125;</span>@github.com&quot;</span> -f github-pages-deploy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将公钥添加到 Pages 仓库的 Deploy Keys</span></span><br><span class="line"><span class="comment"># Settings → Deploy keys → Add deploy key</span></span><br><span class="line"><span class="comment"># 复制 github-pages-deploy.pub 内容, 勾选 Allow write access</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将私钥添加到源码仓库的 Secrets</span></span><br><span class="line"><span class="comment"># Settings → Secrets and variables → Actions → New repository secret</span></span><br><span class="line"><span class="comment"># Name: DEPLOY_PRIVATE_KEY</span></span><br><span class="line"><span class="comment"># Value: 复制 github-pages-deploy 内容</span></span><br></pre></td></tr></table></figure><p>修改 <code>.github/workflows/deploy.yml</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">    <span class="attr">deploy_key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.DEPLOY_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span>  <span class="comment"># 使用私钥</span></span><br><span class="line">    <span class="attr">external_repository:</span> <span class="string">$&#123;用户名&#125;/$&#123;用户名&#125;.github.io</span>  <span class="comment"># 外部仓库</span></span><br><span class="line">    <span class="attr">publish_dir:</span> <span class="string">./public</span></span><br><span class="line">    <span class="attr">publish_branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure><h3 id="GitHub-Actions-工作流程"><a href="#GitHub-Actions-工作流程" class="headerlink" title="GitHub Actions 工作流程"></a>GitHub Actions 工作流程</h3><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart LR    A[推送文章到源码仓库] --&gt; B{GitHub Actions}    B --&gt; C[安装依赖]    C --&gt; D[生成静态文件]    D --&gt; E[部署到 Pages 仓库]    E --&gt; F[自动发布博客]  </pre></div><a class="btn-beautify outline gray" href="https://docs.github.com/en/actions" title="GitHub Actions 官方文档"><i class="fab fa-github"></i><span>GitHub Actions 官方文档</span></a><a class="btn-beautify outline blue" href="https://github.com/peaceiris/actions-gh-pages" title="peaceiris/actions-gh-pages"><i class="fas fa-rocket"></i><span>peaceiris/actions-gh-pages</span></a><h2 id="Butterfly-主题进阶配置"><a href="#Butterfly-主题进阶配置" class="headerlink" title="Butterfly 主题进阶配置"></a>Butterfly 主题进阶配置</h2><h3 id="自定义头像与图标"><a href="#自定义头像与图标" class="headerlink" title="自定义头像与图标"></a>自定义头像与图标</h3><h4 id="1-创建资源目录"><a href="#1-创建资源目录" class="headerlink" title="1. 创建资源目录"></a>1. 创建资源目录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p <span class="built_in">source</span>/img</span><br></pre></td></tr></table></figure><h4 id="2-放置资源文件"><a href="#2-放置资源文件" class="headerlink" title="2. 放置资源文件"></a>2. 放置资源文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source/img/</span><br><span class="line">├── avatar.png       # 头像</span><br><span class="line">├── favicon.png      # 网站图标</span><br><span class="line">└── logo.png         # Logo</span><br></pre></td></tr></table></figure><h4 id="3-配置路径"><a href="#3-配置路径" class="headerlink" title="3. 配置路径"></a>3. 配置路径</h4><p>编辑 <code>_config.butterfly.yml</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Image Settings</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br><span class="line"></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/avatar.png</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span>  <span class="comment"># 头像旋转效果</span></span><br></pre></td></tr></table></figure><div class="note info flat"><p>推荐头像尺寸: 200x200px，favicon: 32x32px</p></div><h3 id="图片管理方案"><a href="#图片管理方案" class="headerlink" title="图片管理方案"></a>图片管理方案</h3><h4 id="方案对比"><a href="#方案对比" class="headerlink" title="方案对比"></a>方案对比</h4><div class="table-container"><table><thead><tr><th>方案</th><th>优点</th><th>缺点</th><th>推荐度</th></tr></thead><tbody><tr><td>本地存储 <code>source/img/</code></td><td>简单直接</td><td>部署慢、仓库大</td><td>⭐⭐</td></tr><tr><td>图床 CDN</td><td>加载快、省空间</td><td>需额外配置</td><td>⭐⭐⭐⭐⭐</td></tr><tr><td>GitHub CDN</td><td>免费、稳定</td><td>国内访问慢</td><td>⭐⭐⭐⭐</td></tr></tbody></table></div><h4 id="推荐方案-jsDelivr-GitHub"><a href="#推荐方案-jsDelivr-GitHub" class="headerlink" title="推荐方案: jsDelivr + GitHub"></a>推荐方案: jsDelivr + GitHub</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 图片链接格式 --&gt;</span><br><span class="line">https://cdn.jsdelivr.net/gh/$&#123;用户名&#125;/$&#123;仓库名&#125;@$&#123;分支名&#125;/$&#123;图片路径&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 示例 --&gt;</span><br><span class="line">![<span class="string">示例图片</span>](<span class="link">https://cdn.jsdelivr.net/gh/koco-co/picgo-images@main/img/example.png</span>)</span><br></pre></td></tr></table></figure><div class="note danger flat"><p>本地图片过多会导致 <code>hexo g</code> 生成时间过长，强烈建议使用图床</p></div><h3 id="配置自定义域名"><a href="#配置自定义域名" class="headerlink" title="配置自定义域名"></a>配置自定义域名</h3><h4 id="1-添加-DNS-解析"><a href="#1-添加-DNS-解析" class="headerlink" title="1. 添加 DNS 解析"></a>1. 添加 DNS 解析</h4><p>在域名服务商处添加记录:</p><div class="table-container"><table><thead><tr><th>类型</th><th>主机记录</th><th>记录值</th><th>TTL</th></tr></thead><tbody><tr><td>CNAME</td><td>www</td><td>${用户名}.github.io</td><td>600</td></tr><tr><td>CNAME</td><td>@</td><td>${用户名}.github.io</td><td>600</td></tr></tbody></table></div><details class="folding-tag" gray><summary> 🌐 使用 Cloudflare 配置 </summary>              <div class='content'>              <ol><li>添加站点 → 输入域名</li><li>添加 DNS 记录 → CNAME → ${用户名}.github.io</li><li>等待 DNS 生效(通常 10-30 分钟)</li></ol>              </div>            </details><h4 id="2-配置-CNAME-文件"><a href="#2-配置-CNAME-文件" class="headerlink" title="2. 配置 CNAME 文件"></a>2. 配置 CNAME 文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;yourdomain.com&quot;</span> &gt; <span class="built_in">source</span>/CNAME</span><br></pre></td></tr></table></figure><div class="note info flat"><p>CNAME 文件会随 <code>hexo g</code> 生成到 public/ 根目录，GitHub Pages 会自动识别</p></div><h4 id="3-在-GitHub-仓库配置"><a href="#3-在-GitHub-仓库配置" class="headerlink" title="3. 在 GitHub 仓库配置"></a>3. 在 GitHub 仓库配置</h4><p>在 <code>$&#123;用户名&#125;.github.io</code> 仓库:</p><ol><li><code>Settings</code> → <code>Pages</code></li><li>Custom domain → 输入域名</li><li>勾选 <code>Enforce HTTPS</code></li></ol><a class="btn-beautify outline green" href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site" title="GitHub Pages 自定义域名文档"><i class="fas fa-globe"></i><span>GitHub Pages 自定义域名文档</span></a><h3 id="评论系统配置"><a href="#评论系统配置" class="headerlink" title="评论系统配置"></a>评论系统配置</h3><p>Butterfly 支持多种评论系统，推荐使用 Waline.</p><h4 id="Waline-配置"><a href="#Waline-配置" class="headerlink" title="Waline 配置"></a>Waline 配置</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.butterfly.yml</span></span><br><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">Waline</span></span><br><span class="line">  <span class="attr">text:</span> <span class="literal">true</span>  <span class="comment"># 在文章底部显示评论按钮</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">count:</span> <span class="literal">true</span>  <span class="comment"># 评论数统计</span></span><br><span class="line"></span><br><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">serverURL:</span> <span class="string">https://$&#123;你的Waline域名&#125;.vercel.app/</span>  <span class="comment"># Waline 服务地址</span></span><br><span class="line">  <span class="attr">lang:</span> <span class="string">zh-CN</span></span><br><span class="line">  <span class="attr">emoji:</span> [<span class="string">&#x27;https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili&#x27;</span>]</span><br><span class="line">  <span class="attr">requiredMeta:</span> [<span class="string">&#x27;nick&#x27;</span>, <span class="string">&#x27;mail&#x27;</span>]  <span class="comment"># 必填项</span></span><br><span class="line">  <span class="attr">login:</span> <span class="string">enable</span>  <span class="comment"># 登录模式</span></span><br></pre></td></tr></table></figure><details class="folding-tag" blue><summary> 🚀 Waline 部署到 Vercel </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Fork Waline 仓库</span></span><br><span class="line"><span class="comment"># https://github.com/walinejs/waline</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 在 Vercel 导入项目</span></span><br><span class="line"><span class="comment"># 3. 配置环境变量</span></span><br><span class="line"><span class="comment"># MYSQL_DB=&lt;数据库名&gt;</span></span><br><span class="line"><span class="comment"># MYSQL_USER=&lt;用户名&gt;</span></span><br><span class="line"><span class="comment"># MYSQL_PASSWORD=&lt;密码&gt;</span></span><br><span class="line"><span class="comment"># MYSQL_HOST=&lt;主机地址&gt;</span></span><br><span class="line"><span class="comment"># MYSQL_PORT=3306</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 部署完成，获取域名</span></span><br></pre></td></tr></table></figure>              </div>            </details><a class="btn-beautify outline blue" href="https://waline.js.org/" title="Waline 官方文档"><i class="fas fa-comments"></i><span>Waline 官方文档</span></a><h3 id="搜索功能"><a href="#搜索功能" class="headerlink" title="搜索功能"></a>搜索功能</h3><h4 id="Algolia-搜索-推荐"><a href="#Algolia-搜索-推荐" class="headerlink" title="Algolia 搜索(推荐)"></a>Algolia 搜索(推荐)</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.butterfly.yml</span></span><br><span class="line"><span class="attr">algolia_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hits:</span></span><br><span class="line">    <span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">input_placeholder:</span> <span class="string">搜索文章</span></span><br><span class="line">    <span class="attr">hits_empty:</span> <span class="string">没有找到相关文章</span></span><br><span class="line">    <span class="attr">hits_stats:</span> <span class="string">找到</span> <span class="string">$&#123;hits&#125;</span> <span class="string">篇文章</span></span><br></pre></td></tr></table></figure><p>配置步骤:</p><ol><li>注册 <a href="https://www.algolia.com/">Algolia</a></li><li>创建 Index → <code>hexo-blog</code></li><li>生成 API Key</li><li>安装插件:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-algolia --save</span><br></pre></td></tr></table></figure><ol><li>配置 <code>_config.yml</code>:</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">algolia:</span></span><br><span class="line">  <span class="attr">applicationID:</span> <span class="string">$&#123;你的ApplicationID&#125;</span></span><br><span class="line">  <span class="attr">apiKey:</span> <span class="string">$&#123;你的Admin</span> <span class="string">API</span> <span class="string">Key&#125;</span></span><br><span class="line">  <span class="attr">indexName:</span> <span class="string">hexo-blog</span></span><br></pre></td></tr></table></figure><ol><li>索引文章:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo algolia</span><br></pre></td></tr></table></figure><div class="note warning flat"><p>每次发布新文章后需要重新索引</p></div><a class="btn-beautify outline purple" href="https://docsearch.algolia.com/" title="Algolia DocSearch"><i class="fas fa-search"></i><span>Algolia DocSearch</span></a><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="文章写作规范"><a href="#文章写作规范" class="headerlink" title="文章写作规范"></a>文章写作规范</h3><h4 id="Front-Matter-模板"><a href="#Front-Matter-模板" class="headerlink" title="Front Matter 模板"></a>Front Matter 模板</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章标题</span><br><span class="line">date: 2026-01-06 14:00:00</span><br><span class="line">tags:</span><br><span class="line"><span class="bullet">  -</span> Hexo</span><br><span class="line"><span class="bullet">  -</span> GitHub</span><br><span class="line">categories:</span><br><span class="line"><span class="bullet">  -</span> 技术教程</span><br><span class="line">cover: https://example.com/cover.jpg  # 封面图</span><br><span class="line">top<span class="emphasis">_img: https://example.com/top.jpg  # 顶部图(可选)</span></span><br><span class="line"><span class="emphasis">toc: true  # 显示目录</span></span><br><span class="line"><span class="emphasis">password: 123456  # 文章加密(可选)</span></span><br><span class="line"><span class="emphasis">---</span></span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>字段</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>title</code></td><td>文章标题</td><td>必填</td></tr><tr><td><code>date</code></td><td>发布日期</td><td>自动生成</td></tr><tr><td><code>tags</code></td><td>标签列表</td><td>数组格式</td></tr><tr><td><code>categories</code></td><td>分类</td><td>支持层级</td></tr><tr><td><code>cover</code></td><td>封面图</td><td>URL</td></tr><tr><td><code>toc</code></td><td>目录</td><td>true/false</td></tr><tr><td><code>password</code></td><td>访问密码</td><td>加密文章</td></tr></tbody></table></div><h4 id="内容规范"><a href="#内容规范" class="headerlink" title="内容规范"></a>内容规范</h4><ul><li>使用 Markdown 语法</li><li>代码块指定语言: ```javascript</li><li>图片使用图床链接</li><li>文件名使用英文或拼音</li><li>标题层级不超过 4 级</li></ul><h3 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h3><h4 id="1-启用压缩"><a href="#1-启用压缩" class="headerlink" title="1. 启用压缩"></a>1. 启用压缩</h4><p>安装插件:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-offline --save</span><br><span class="line">npm install hexo-filter-nofollow --save</span><br></pre></td></tr></table></figure><p>配置 <code>_config.yml</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自动压缩</span></span><br><span class="line"><span class="attr">nofollow:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;排除的域名&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="2-图片优化"><a href="#2-图片优化" class="headerlink" title="2. 图片优化"></a>2. 图片优化</h4><ul><li>使用 WebP 格式</li><li>压缩图片(tinypng.com)</li><li>CDN 加速</li><li>懒加载(Butterfly 已内置)</li></ul><h4 id="3-缓存配置"><a href="#3-缓存配置" class="headerlink" title="3. 缓存配置"></a>3. 缓存配置</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.yml</span></span><br><span class="line"><span class="attr">marked:</span></span><br><span class="line">  <span class="attr">gfm:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">breaks:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="SEO-优化"><a href="#SEO-优化" class="headerlink" title="SEO 优化"></a>SEO 优化</h3><h4 id="1-站点地图"><a href="#1-站点地图" class="headerlink" title="1. 站点地图"></a>1. 站点地图</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.yml</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br><span class="line">  <span class="attr">rel:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br></pre></td></tr></table></figure><h4 id="2-robots-txt"><a href="#2-robots-txt" class="headerlink" title="2. robots.txt"></a>2. robots.txt</h4><p>创建 <code>source/robots.txt</code>:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Allow: /</span><br><span class="line">Allow: /archives/</span><br><span class="line">Disallow: /js/</span><br><span class="line">Disallow: /css/</span><br><span class="line"></span><br><span class="line">Sitemap: https://你的域名/sitemap.xml</span><br></pre></td></tr></table></figure><h4 id="3-提交搜索引擎"><a href="#3-提交搜索引擎" class="headerlink" title="3. 提交搜索引擎"></a>3. 提交搜索引擎</h4><ul><li>Google Search Console</li><li>Bing Webmaster Tools</li><li>百度搜索资源平台</li></ul><h4 id="SEO-提交流程"><a href="#SEO-提交流程" class="headerlink" title="SEO 提交流程"></a>SEO 提交流程</h4><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    flowchart TD    A[生成 sitemap.xml] --&gt; B[验证网站所有权]    B --&gt; C[提交 sitemap]    C --&gt; D[等待爬虫抓取]    D --&gt; E[文章收录]  </pre></div><h3 id="备份策略"><a href="#备份策略" class="headerlink" title="备份策略"></a>备份策略</h3><h4 id="方案一-单仓库方案"><a href="#方案一-单仓库方案" class="headerlink" title="方案一: 单仓库方案"></a>方案一: 单仓库方案</h4><p>所有代码和源文件在一个仓库，使用分支管理:</p><div class="table-container"><table><thead><tr><th>分支</th><th>用途</th></tr></thead><tbody><tr><td><code>main</code></td><td>静态博客</td></tr><tr><td><code>source</code></td><td>源码备份</td></tr></tbody></table></div><h4 id="方案二-双仓库方案-推荐"><a href="#方案二-双仓库方案-推荐" class="headerlink" title="方案二: 双仓库方案(推荐)"></a>方案二: 双仓库方案(推荐)</h4><div class="table-container"><table><thead><tr><th>仓库</th><th>内容</th><th>分支</th></tr></thead><tbody><tr><td><code>$&#123;用户名&#125;.github.io</code></td><td>静态博客</td><td><code>main</code></td></tr><tr><td><code>hexo-blog-source</code></td><td>源码</td><td><code>main</code></td></tr></tbody></table></div><div class="note success flat"><p>双仓库方案更安全，避免源码泄露</p></div><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="Q1-hexo-g-生成失败"><a href="#Q1-hexo-g-生成失败" class="headerlink" title="Q1: hexo g 生成失败"></a>Q1: <code>hexo g</code> 生成失败</h3><p><strong>症状</strong>: 执行 <code>hexo generate</code> 报错</p><p><strong>解决方案</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 清除缓存</span></span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 删除 node_modules</span></span><br><span class="line"><span class="built_in">rm</span> -rf node_modules</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 重新安装依赖</span></span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 重新生成</span></span><br><span class="line">hexo generate</span><br></pre></td></tr></table></figure><h3 id="Q2-部署后样式错乱"><a href="#Q2-部署后样式错乱" class="headerlink" title="Q2: 部署后样式错乱"></a>Q2: 部署后样式错乱</h3><p><strong>症状</strong>: 本地正常，部署后样式丢失</p><p><strong>解决方案</strong>:</p><ol><li>检查 <code>_config.yml</code> 中的 <code>url</code> 配置</li><li>检查主题是否正确安装</li><li>清除浏览器缓存</li><li>检查 CDN 资源是否可访问</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.yml</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://你的域名</span>  <span class="comment"># 确保正确</span></span><br></pre></td></tr></table></figure><h3 id="Q3-图片无法显示"><a href="#Q3-图片无法显示" class="headerlink" title="Q3: 图片无法显示"></a>Q3: 图片无法显示</h3><p><strong>症状</strong>: 文章中图片显示为裂图</p><p><strong>解决方案</strong>:</p><div class="table-container"><table><thead><tr><th>原因</th><th>解决方案</th></tr></thead><tbody><tr><td>路径错误</td><td>使用 <code>/img/</code> 或完整 URL</td></tr><tr><td>大小写问题</td><td>Linux 区分大小写，检查文件名</td></tr><tr><td>图床失效</td><td>更换图床链接</td></tr><tr><td>CDN 缓存</td><td>添加版本号 <code>?v=1.0</code></td></tr></tbody></table></div><h3 id="Q4-GitHub-Actions-部署失败"><a href="#Q4-GitHub-Actions-部署失败" class="headerlink" title="Q4: GitHub Actions 部署失败"></a>Q4: GitHub Actions 部署失败</h3><p><strong>症状</strong>: Actions 工作流执行失败</p><p><strong>解决方案</strong>:</p><ol><li>检查 <code>.github/workflows/deploy.yml</code> 语法</li><li>查看 Actions 运行日志</li><li>验证 GitHub Token 权限</li><li>检查 Node.js 版本兼容性</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查 Node 版本</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node.js</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">actions/setup-node@v4</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">    <span class="attr">node-version:</span> <span class="string">&#x27;20&#x27;</span>  <span class="comment"># 与本地版本一致</span></span><br></pre></td></tr></table></figure><h3 id="Q5-评论系统不显示"><a href="#Q5-评论系统不显示" class="headerlink" title="Q5: 评论系统不显示"></a>Q5: 评论系统不显示</h3><p><strong>症状</strong>: 评论框不显示</p><p><strong>解决方案</strong>:</p><ol><li>检查 <code>_config.butterfly.yml</code> 中评论系统配置</li><li>验证服务地址是否正确</li><li>检查浏览器控制台错误信息</li><li>确认评论服务是否正常运行</li></ol><h3 id="Q6-搜索功能不工作"><a href="#Q6-搜索功能不工作" class="headerlink" title="Q6: 搜索功能不工作"></a>Q6: 搜索功能不工作</h3><p><strong>症状</strong>: 搜索框无结果</p><p><strong>解决方案</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 重新索引</span></span><br><span class="line">hexo algolia</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 检查 API Key 权限</span></span><br><span class="line"><span class="comment"># Admin API Key vs Search API Key</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 验证 Index 名称</span></span><br></pre></td></tr></table></figure><h3 id="Q7-如何迁移博客"><a href="#Q7-如何迁移博客" class="headerlink" title="Q7: 如何迁移博客"></a>Q7: 如何迁移博客</h3><p><strong>从其他平台迁移到 Hexo</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 导出文章为 Markdown</span></span><br><span class="line"><span class="comment"># WordPress/Jekyll 等支持导出</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 放到 source/_posts/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 调整图片路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 生成并部署</span></span><br><span class="line">hexo clean &amp;&amp; hexo g -d</span><br></pre></td></tr></table></figure><h3 id="Q8-如何备份到新电脑"><a href="#Q8-如何备份到新电脑" class="headerlink" title="Q8: 如何备份到新电脑"></a>Q8: 如何备份到新电脑</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 克隆源码仓库</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/<span class="variable">$&#123;用户名&#125;</span>/hexo-blog-source.git</span><br><span class="line"><span class="built_in">cd</span> hexo-blog-source</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 安装依赖</span></span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 安装 Hexo CLI</span></span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 测试运行</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><h2 id="进阶主题"><a href="#进阶主题" class="headerlink" title="进阶主题"></a>进阶主题</h2><h3 id="多环境部署"><a href="#多环境部署" class="headerlink" title="多环境部署"></a>多环境部署</h3><p>同时部署到多个平台:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.yml</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">https://github.com/$&#123;用户名&#125;/$&#123;用户名&#125;.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@gitee.com:$&#123;用户名&#125;/$&#123;用户名&#125;.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>平台</th><th>说明</th><th>速度</th></tr></thead><tbody><tr><td>GitHub Pages</td><td>全球通用</td><td>国内一般</td></tr><tr><td>Gitee Pages</td><td>国内访问快</td><td>需实名认证</td></tr><tr><td>Vercel</td><td>CDN 加速</td><td>快</td></tr><tr><td>Netlify</td><td>预览功能</td><td>快</td></tr></tbody></table></div><h3 id="自定义页面"><a href="#自定义页面" class="headerlink" title="自定义页面"></a>自定义页面</h3><p>创建独立页面:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建关于页面</span></span><br><span class="line">hexo new page about</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建分类页面</span></span><br><span class="line">hexo new page categories</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建标签页面</span></span><br><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>编辑页面内容:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 关于</span><br><span class="line">date: 2026-01-06 14:00:00</span><br><span class="line"><span class="section">type: about</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section"># 关于我</span></span><br><span class="line"></span><br><span class="line">这里是关于页面内容</span><br></pre></td></tr></table></figure><h3 id="数据文件"><a href="#数据文件" class="headerlink" title="数据文件"></a>数据文件</h3><p>使用外部数据源:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># source/_data/menu.yml</span></span><br><span class="line"><span class="attr">Home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line"><span class="attr">Archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br><span class="line"><span class="attr">Tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br></pre></td></tr></table></figure><p>配置主题使用:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.butterfly.yml</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">from_data:</span> <span class="literal">true</span>  <span class="comment"># 从 menu.yml 读取</span></span><br></pre></td></tr></table></figure><h3 id="插件开发"><a href="#插件开发" class="headerlink" title="插件开发"></a>插件开发</h3><p>自定义 Hexo 插件:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// scripts/custom_plugin.js</span></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">helper</span>.<span class="title function_">register</span>(<span class="string">&#x27;my_helper&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;p&gt;My Custom Helper&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&#x27;my_tag&#x27;</span>, <span class="keyword">function</span>(<span class="params">args, content</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;div class=&quot;my-tag&quot;&gt;&#x27;</span> + content + <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">&#125;, &#123;<span class="attr">ends</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure><p>在模板中使用:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- my_helper() %&gt;</span><br><span class="line"></span><br><span class="line">&lt;% my_tag %&gt;</span><br><span class="line">  内容</span><br><span class="line">&lt;% endmy_tag %&gt;</span><br></pre></td></tr></table></figure><a class="btn-beautify outline blue" href="https://hexo.io/zh-cn/api/" title="Hexo 插件开发文档"><i class="fas fa-code"></i><span>Hexo 插件开发文档</span></a><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文档详细介绍了 Hexo 博客的搭建流程，从环境准备到自动部署，再到主题定制和性能优化. 核心要点:</p><ol><li><strong>环境准备</strong>: Node.js + Git 是基础</li><li><strong>Hexo 安装</strong>: <code>hexo init</code> + <code>npm install</code></li><li><strong>主题配置</strong>: Butterfly 推荐用于美观博客</li><li><strong>自动部署</strong>: GitHub Actions 实现持续集成</li><li><strong>内容管理</strong>: Markdown + Front Matter 规范</li><li><strong>性能优化</strong>: 图片 CDN + 缓存 + 压缩</li><li><strong>SEO 优化</strong>: 站点地图 + robots.txt</li></ol><h3 id="快速参考卡片"><a href="#快速参考卡片" class="headerlink" title="快速参考卡片"></a>快速参考卡片</h3><details class="folding-tag" green><summary> ⚡ 快速命令参考 </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化</span></span><br><span class="line">hexo init blog &amp;&amp; <span class="built_in">cd</span> blog &amp;&amp; npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写文章</span></span><br><span class="line">hexo new <span class="string">&quot;标题&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地预览</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署</span></span><br><span class="line">hexo clean &amp;&amp; hexo g -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新主题</span></span><br><span class="line"><span class="built_in">cd</span> themes/butterfly &amp;&amp; git pull</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="推荐文章结构"><a href="#推荐文章结构" class="headerlink" title="推荐文章结构"></a>推荐文章结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">source/_posts/</span><br><span class="line">├── 2026-01-06-hexo-tutorial.md</span><br><span class="line">├── 2026-01-07-javascript-guide.md</span><br><span class="line">└── img/</span><br><span class="line">    ├── cover.jpg</span><br><span class="line">    └── screenshot.png</span><br></pre></td></tr></table></figure><a class="btn-beautify outline blue" href="https://hexo.io/zh-cn/docs/" title="Hexo 官方文档"><i class="fas fa-book"></i><span>Hexo 官方文档</span></a><a class="btn-beautify outline purple" href="https://butterfly.js.org/" title="Butterfly 主题文档"><i class="fas fa-palette"></i><span>Butterfly 主题文档</span></a><a class="btn-beautify outline gray" href="https://docs.github.com/en/pages" title="GitHub Pages 文档"><i class="fab fa-github"></i><span>GitHub Pages 文档</span></a>]]></content>
      
      
      <categories>
          
          <category> 工具配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
            <tag> GitHub </tag>
            
            <tag> GitHub-Actions </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitHub文档(一) 图床搭建</title>
      <link href="/posts/b50471d5/"/>
      <url>/posts/b50471d5/</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>图床是用于存储和托管图片的云服务, 通过 URL 访问实现图片的在线展示. GitHub 仓库配合 jsDelivr CDN 可以搭建一个稳定、免费、高速的图床服务, 适合个人博客、文档编写等场景.</p><p>本文介绍如何使用 GitHub + PicGo + Typora 搭建完整的图床解决方案.</p><h3 id="核心组件"><a href="#核心组件" class="headerlink" title="核心组件"></a>核心组件</h3><div class="table-container"><table><thead><tr><th>组件</th><th>作用</th><th>优势</th></tr></thead><tbody><tr><td>GitHub 仓库</td><td>图片存储</td><td>免费无限空间, 版本控制</td></tr><tr><td>PicGo</td><td>上传工具</td><td>支持多平台, 自动上传</td></tr><tr><td>Typora</td><td>Markdown 编辑器</td><td>所见即所得, 无缝集成</td></tr><tr><td>jsDelivr CDN</td><td>内容分发</td><td>全球加速, HTTP/2 支持</td></tr></tbody></table></div><div class="note info flat"><p>💡 <strong>推荐</strong>: 这套方案完全免费, 适合个人博客和技术文档使用.</p></div><hr><h2 id="GitHub-设置"><a href="#GitHub-设置" class="headerlink" title="GitHub 设置"></a>GitHub 设置</h2><h3 id="1-创建图片仓库"><a href="#1-创建图片仓库" class="headerlink" title="1. 创建图片仓库"></a>1. 创建图片仓库</h3><p>创建一个 Public 仓库作为图床存储空间.</p><div class="note success flat"><p>✅ <strong>仓库设置</strong></p><ul><li>仓库名: <code>picgo-images</code> (可自定义)</li><li>可见性: <strong>Public</strong> (必须公开)</li><li>初始化: 可选添加 README</li></ul></div><div class="note warning flat"><p>⚠️ <strong>重要</strong>: 仓库必须设置为公开, 否则 jsDelivr CDN 无法访问.</p></div><h3 id="2-生成-Personal-Access-Token"><a href="#2-生成-Personal-Access-Token" class="headerlink" title="2. 生成 Personal Access Token"></a>2. 生成 Personal Access Token</h3><p>GitHub 已于 2021年8月停止支持密码认证, 需要使用 Personal Access Token (PAT) 进行 API 认证.</p><h4 id="创建步骤"><a href="#创建步骤" class="headerlink" title="创建步骤"></a>创建步骤</h4><ol><li>进入 GitHub <strong>Settings</strong></li><li>点击 <strong>Developer settings</strong></li><li>选择 <strong>Personal access tokens</strong> → <strong>Tokens classic</strong></li><li>点击 <strong>Generate new token (classic)</strong></li></ol><h4 id="Token-权限配置"><a href="#Token-权限配置" class="headerlink" title="Token 权限配置"></a>Token 权限配置</h4><div class="table-container"><table><thead><tr><th>权限类别</th><th>权限名称</th><th>用途</th></tr></thead><tbody><tr><td>repo</td><td>repo:status</td><td>读取提交状态</td></tr><tr><td>repo</td><td>repo_deployment</td><td>部署状态</td></tr><tr><td>repo</td><td>public_repo</td><td>访问公开仓库</td></tr><tr><td>repo</td><td>repo:invite</td><td>仓库邀请</td></tr><tr><td>workflow</td><td>workflow: GitHub Actions</td><td>可选, 如需自动化</td></tr></tbody></table></div><div class="note primary flat"><p>📌 <strong>推荐</strong>: 选择 <code>repo</code> 完整权限即可满足图床上传需求.</p></div><h4 id="保存-Token"><a href="#保存-Token" class="headerlink" title="保存 Token"></a>保存 Token</h4><p>生成后立即复制 Token, 离开页面后将无法再次查看完整内容.</p><div class="note danger flat"><p>🚫 <strong>警告</strong>: 建议将 Token 保存在密码管理器中, 并设置过期时间提醒.</p></div><a class="btn-beautify blue" href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens" title="查看官方文档"><i class="fa-solid fa-book"></i><span>查看官方文档</span></a><hr><h2 id="PicGo-配置"><a href="#PicGo-配置" class="headerlink" title="PicGo 配置"></a>PicGo 配置</h2><h3 id="安装-PicGo"><a href="#安装-PicGo" class="headerlink" title="安装 PicGo"></a>安装 PicGo</h3><p>PicGo 是一款开源、跨平台的图床上传工具, 支持多种图床服务.</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active"><i class="fab fa-apple"></i>macOS</button><button type="button" class="tab"><i class="fab fa-windows"></i>Windows</button><button type="button" class="tab"><i class="fab fa-linux"></i>Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install --cask picgo</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winget install PicGo.PicGo</span><br></pre></td></tr></table></figure><p>或从官网下载安装包: <a href="https://github.com/Molunerfinn/PicGo/releases">GitHub Releases</a></p></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 AppImage</span></span><br><span class="line">wget https://github.com/Molunerfinn/PicGo/releases/download/v0.9.9/PicGo-0.9.9-x86_64.AppImage</span><br><span class="line"><span class="built_in">chmod</span> +x PicGo-0.9.9-x86_64_64.AppImage</span><br><span class="line">./PicGo-0.9.9-x86_64_64.AppImage</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="GitHub-图床配置"><a href="#GitHub-图床配置" class="headerlink" title="GitHub 图床配置"></a>GitHub 图床配置</h3><h4 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h4><p>在 PicGo 设置中选择 GitHub 图床, 填写以下信息:</p><div class="table-container"><table><thead><tr><th>配置项</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>图床配置名</td><td>标识名称</td><td>Default</td></tr><tr><td>设定仓库名</td><td><code>$&#123;用户名&#125;/$&#123;仓库名&#125;</code></td><td><code>koco-co/picgo-images</code></td></tr><tr><td>设定分支名</td><td>默认 main</td><td><code>main</code></td></tr><tr><td>设定 Token</td><td>生成的 PAT</td><td><code>ghp_xxxxxxxxxxxx</code></td></tr><tr><td>设定存储路径</td><td>仓库下的子目录</td><td><code>picgo-images/</code></td></tr><tr><td>设定自定义域名</td><td>jsDelivr CDN 地址</td><td><code>https://cdn.jsdelivr.net/gh/koco-co/picgo-images@main</code></td></tr></tbody></table></div><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-20260109212509866.png" alt="github-picgo图床映射关系"></p><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-20260109211402829.png" alt="picgo-github配置项设置"></p><h4 id="配置示例"><a href="#配置示例" class="headerlink" title="配置示例"></a>配置示例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">仓库名: koco-co/picgo-images</span><br><span class="line">分支: main</span><br><span class="line">路径: picgo-images/</span><br><span class="line">CDN: https://cdn.jsdelivr.net/gh/koco-co/picgo-images@main</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 <strong>提示</strong>: 自定义域名中添加 <code>@main</code> 可以锁定版本, 避免分支更新导致的问题.</p></div><h3 id="PicGo-高级设置"><a href="#PicGo-高级设置" class="headerlink" title="PicGo 高级设置"></a>PicGo 高级设置</h3><h4 id="代理设置"><a href="#代理设置" class="headerlink" title="代理设置"></a>代理设置</h4><p>如果网络环境需要代理, 可在设置中配置:</p><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-20260109211932335.png" alt="代理镜像设置"></p><p>e.g.</p><ul><li>HTTP 代理: <code>http://127.0.0.1:7890</code></li><li>SOCKS5 代理: <code>socks5://127.0.0.1:1080</code></li></ul><h4 id="链接格式"><a href="#链接格式" class="headerlink" title="链接格式"></a>链接格式</h4><p>PicGo 支持多种图片链接格式:</p><div class="table-container"><table><thead><tr><th>格式</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>Markdown</td><td>标准格式</td><td><code>![alt](url)</code></td></tr><tr><td>HTML</td><td>HTML 标签</td><td><code>&lt;img src=&quot;url&quot;&gt;</code></td></tr><tr><td>URL</td><td>纯链接</td><td><code>https://...</code></td></tr><tr><td>UBB</td><td>论坛格式</td><td><code>[img]url[/img]</code></td></tr></tbody></table></div><div class="note success flat"><p>✅ <strong>推荐</strong>: 使用 Markdown 格式, 直接适配 Typora.</p></div><a class="btn-beautify purple" href="https://picgo.github.io/PicGo-Doc/zh/guide/config.html" title="PicGo 官方文档"><i class="fa-solid fa-book"></i><span>PicGo 官方文档</span></a><hr><h2 id="Typora-集成"><a href="#Typora-集成" class="headerlink" title="Typora 集成"></a>Typora 集成</h2><h3 id="配置自动上传"><a href="#配置自动上传" class="headerlink" title="配置自动上传"></a>配置自动上传</h3><p>Typora 支持 PicGo.app 集成, 实现粘贴图片即上传.</p><h4 id="配置步骤"><a href="#配置步骤" class="headerlink" title="配置步骤"></a>配置步骤</h4><ol><li>打开 Typora 偏好设置</li><li>选择 <strong>图像</strong> 选项</li><li>设置 <strong>插入图片时</strong>: <strong>上传图片</strong></li><li><strong>上传服务设定</strong>: <strong>PicGo.app</strong></li></ol><h4 id="配置路径"><a href="#配置路径" class="headerlink" title="配置路径"></a>配置路径</h4><ul><li><strong>macOS</strong>: <code>Typora &gt; 偏好设置 &gt; 图像</code></li><li><strong>Windows</strong>: <code>文件 &gt; 偏好设置 &gt; 图像</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-20260109212708776.png" alt="typora图像设置"></p><h3 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h3><p>配置完成后, 使用方式非常简单:</p><div class="mermaid-wrap"><pre class="mermaid-src" data-config="{}" hidden>    graph LR  A[复制&#x2F;截图] --&gt; B[粘贴到Typora]  B --&gt; C[自动调用PicGo]  C --&gt; D[上传到GitHub]  D --&gt; E[返回CDN链接]  E --&gt; F[替换本地图片]  </pre></div><div class="note success flat"><p>✅ <strong>示例</strong>: 截图后直接在 Typora 中按 <code>Cmd+V</code> (macOS) 或 <code>Ctrl+V</code> (Windows), 图片自动上传并替换为 CDN 链接.</p></div><p><img src="https://cdn.jsdelivr.net/gh/koco-co/picgo-images/picgo-images/image-20260109212959444.png" alt="github图床仓库"></p><hr><h2 id="jsDelivr-CDN-加速"><a href="#jsDelivr-CDN-加速" class="headerlink" title="jsDelivr CDN 加速"></a>jsDelivr CDN 加速</h2><h3 id="CDN-配置"><a href="#CDN-配置" class="headerlink" title="CDN 配置"></a>CDN 配置</h3><p>jsDelivr 是一款免费的公共 CDN 服务, 支持 GitHub 仓库加速.</p><h4 id="URL-格式"><a href="#URL-格式" class="headerlink" title="URL 格式"></a>URL 格式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.jsdelivr.net/gh/[用户名]/[仓库名]@[分支]/[文件路径]</span><br></pre></td></tr></table></figure><p>e.g.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">原始: https://github.com/koco-co/picgo-images/raw/main/picgo-images/image.png</span><br><span class="line">CDN:  https://cdn.jsdelivr.net/gh/koco-co/picgo-images@main/picgo-images/image.png</span><br></pre></td></tr></table></figure></p><h3 id="CDN-优势"><a href="#CDN-优势" class="headerlink" title="CDN 优势"></a>CDN 优势</h3><div class="table-container"><table><thead><tr><th>特性</th><th>说明</th></tr></thead><tbody><tr><td>全球节点</td><td>中国大陆、美国、欧洲等多节点</td></tr><tr><td>HTTP/2</td><td>多路复用, 提升加载速度</td></tr><tr><td>Gzip 压缩</td><td>自动压缩文本资源</td></tr><tr><td>版本锁定</td><td>支持 tag/commit/SHA 锁定</td></tr><tr><td>缓存策略</td><td>智能缓存失效机制</td></tr></tbody></table></div><h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><ol><li><p><strong>版本锁定</strong>: 生产环境使用 tag 或 commit SHA</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.jsdelivr.net/gh/koco-co/picgo-images@v1.0.0/image.png</span><br></pre></td></tr></table></figure></li><li><p><strong>目录规划</strong>: 按日期或类型组织图片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">picgo-images/2026/02/</span><br><span class="line">picgo-images/screenshots/</span><br></pre></td></tr></table></figure></li><li><p><strong>文件命名</strong>: 使用有意义的前缀</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">20260210-typora-setting.png</span><br><span class="line">github-pat-create.png</span><br></pre></td></tr></table></figure></li></ol><div class="note warning flat"><p>⚠️ <strong>注意</strong>: jsDelivr 对 GitHub 仓库有请求频率限制, 建议避免短时间内大量请求.</p></div><a class="btn-beautify blue" href="https://www.jsdelivr.com/" title="jsDelivr官方文档"><i class="fa-solid fa-globe"></i><span>jsDelivr官方文档</span></a><a class="btn-beautify purple" href="https://blog.csdn.net/qq_51335325/article/details/149783808" title="jsDelivr CDN 完全指南"><i class="fa-solid fa-book"></i><span>jsDelivr CDN 完全指南</span></a><hr><h2 id="进阶用法"><a href="#进阶用法" class="headerlink" title="进阶用法"></a>进阶用法</h2><h3 id="多图床配置"><a href="#多图床配置" class="headerlink" title="多图床配置"></a>多图床配置</h3><p>PicGo 支持配置多个图床, 实现负载均衡或备份.</p><p>e.g.</p><ul><li>主图床: GitHub + jsDelivr</li><li>备份图床: 阿里云 OSS</li><li>测试图床: 七牛云</li></ul><h3 id="快捷键配置"><a href="#快捷键配置" class="headerlink" title="快捷键配置"></a>快捷键配置</h3><p>在 PicGo 中设置全局快捷键:</p><div class="table-container"><table><thead><tr><th>功能</th><th>macOS</th><th>Windows</th></tr></thead><tbody><tr><td>上传剪贴板</td><td><code>Cmd+Shift+U</code></td><td><code>Ctrl+Shift+U</code></td></tr><tr><td>打开主窗口</td><td><code>Cmd+Shift+O</code></td><td><code>Ctrl+Shift+O</code></td></tr></tbody></table></div><h3 id="命令行上传"><a href="#命令行上传" class="headerlink" title="命令行上传"></a>命令行上传</h3><p>PicGo 提供命令行接口, 支持脚本自动化.</p><p>e.g.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上传单个文件</span></span><br><span class="line">picgo upload /path/to/image.png</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上传多个文件</span></span><br><span class="line">picgo upload /path/to/images/*.png</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从剪贴板上传</span></span><br><span class="line">picgo upload</span><br></pre></td></tr></table></figure></p><a class="btn-beautify purple" href="https://picgo.github.io/PicGo-Doc/zh/guide/advance.html" title="PicGo CLI 文档"><i class="fa-solid fa-terminal"></i><span>PicGo CLI 文档</span></a><hr><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="1-Token-验证失败"><a href="#1-Token-验证失败" class="headerlink" title="1. Token 验证失败"></a>1. Token 验证失败</h3><p><strong>症状</strong>: PicGo 提示 Token 无效</p><p><strong>解决方案</strong>:</p><ul><li>检查 Token 是否过期</li><li>确认 Token 包含 <code>repo</code> 权限</li><li>重新生成 Token 并更新配置</li></ul><h3 id="2-图片上传失败"><a href="#2-图片上传失败" class="headerlink" title="2. 图片上传失败"></a>2. 图片上传失败</h3><p><strong>症状</strong>: 上传卡住或返回错误</p><p><strong>可能原因</strong>:</p><ul><li>网络连接问题</li><li>GitHub API 限流</li><li>Token 权限不足</li></ul><p><strong>解决方案</strong>:</p><ul><li>配置代理服务器</li><li>检查 GitHub API 剩余配额</li><li>验证 Token 权限</li></ul><h3 id="3-CDN-访问慢"><a href="#3-CDN-访问慢" class="headerlink" title="3. CDN 访问慢"></a>3. CDN 访问慢</h3><p><strong>症状</strong>: 图片加载缓慢</p><p><strong>优化方案</strong>:</p><ul><li>等待 CDN 缓存生效 (首次访问较慢)</li><li>使用国内 CDN 替代方案 (如 Cloudflare)</li><li>检查图片文件大小, 考虑压缩</li></ul><h3 id="4-仓库大小限制"><a href="#4-仓库大小限制" class="headerlink" title="4. 仓库大小限制"></a>4. 仓库大小限制</h3><p><strong>症状</strong>: 单个文件超过 100MB 无法上传</p><p><strong>解决方案</strong>:</p><ul><li>GitHub 单文件限制 100MB</li><li>使用图片压缩工具 (TinyPNG, ImageOptim)</li><li>考虑使用其他图床服务</li></ul><div class="note info flat"><p>💡 <strong>提示</strong>: GitHub 仓库总大小建议不超过 1GB, 超过会影响克隆速度.</p></div><hr><h2 id="最佳实践-1"><a href="#最佳实践-1" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h3><ul><li>❌ 不要将 Token 写入公开文档</li><li>✅ 使用环境变量存储敏感信息</li><li>✅ 定期轮换 Token (建议 90 天)</li><li>✅ 为 Token 设置最小权限原则</li></ul><h3 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h3><div class="table-container"><table><thead><tr><th>优化项</th><th>说明</th><th>效果</th></tr></thead><tbody><tr><td>图片压缩</td><td>使用 TinyPNG 压缩</td><td>减少 50-70% 体积</td></tr><tr><td>WebP 格式</td><td>现代浏览器支持</td><td>比 PNG 小 30%</td></tr><tr><td>渐进式 JPEG</td><td>逐步加载</td><td>提升感知速度</td></tr><tr><td>懒加载</td><td>滚动时加载</td><td>减少初始请求数</td></tr></tbody></table></div><h3 id="工作流建议"><a href="#工作流建议" class="headerlink" title="工作流建议"></a>工作流建议</h3><ol><li><strong>写作前</strong>: 创建专用文件夹</li><li><strong>写作中</strong>: 截图后直接粘贴上传</li><li><strong>完成后</strong>: 验证图片链接有效性</li><li><strong>发布前</strong>: 备份仓库到本地</li></ol><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><a class="btn-beautify purple" href="https://github.com/Molunerfinn/PicGo" title="PicGo GitHub"><i class="fa-brands fa-github"></i><span>PicGo GitHub</span></a><a class="btn-beautify blue" href="https://picgo.github.io/PicGo-Doc/" title="PicGo 官方文档"><i class="fa-solid fa-book"></i><span>PicGo 官方文档</span></a><a class="btn-beautify purple" href="https://support.typora.io/" title="Typora 官方文档"><i class="fa-solid fa-book"></i><span>Typora 官方文档</span></a><a class="btn-beautify green" href="https://www.testerhome.com/topics/41952" title="PicGo 配置教程"><i class="fa-solid fa-globe"></i><span>PicGo 配置教程</span></a><a class="btn-beautify orange" href="https://penry.asia/article/Tools-1/" title="PicGo + GitHub 图床教程"><i class="fa-solid fa-link"></i><span>PicGo + GitHub 图床教程</span></a>]]></content>
      
      
      <categories>
          
          <category> 工具配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitHub </tag>
            
            <tag> PicGo </tag>
            
            <tag> Typora </tag>
            
            <tag> 图床 </tag>
            
            <tag> jsDelivr </tag>
            
            <tag> CDN </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
